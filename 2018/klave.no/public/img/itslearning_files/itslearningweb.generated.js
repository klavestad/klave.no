var __extends=this&&this.__extends||function(f,e){function k(){this.constructor=f}for(var d in e)e.hasOwnProperty(d)&&(f[d]=e[d]);f.prototype=null===e?Object.create(e):(k.prototype=e.prototype,new k)},ItslearningWeb;
(function(f){(function(e){var f=function(){return function(d){var a=this;this.settings=this.settings=d;$(function(){function b(){g.is(":checked")?(h.removeProp("readonly"),h.off("click",c)):(h.prop("readonly","readonly"),h.on("click",c))}function c(){return!1}var g=$("#"+a.settings.PlannerCheckboxClientId),h=$("#"+a.settings.TopicsInPlannerCheckboxClientId);b();g.on("change",function(){b()})})}}();e.EditDefaultCourseSettings=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){(function(e){var d=function(){return function(a){var b=this;this.controls={checkbox:null,radioButtons:null,textArea:null,confirmButton:null};this.sections={actions:null,reason:null,confirmation:null};this.initialize=function(a){b.initializeSections(a);b.initializeControls(a);setTimeout(b.revealSections,0)};this.initializeSections=function(a){b.sections.actions=$("#"+a.ActionSectionId);b.sections.reason=$("#"+a.ReasonSectionId);b.sections.confirmation=$("#"+a.ConfirmationSectionId)};this.initializeControls=
function(a){b.controls.checkbox=window[a.CheckboxId];b.controls.radioButtons=$("#"+a.ActionSectionId+" input");b.controls.textArea=$("#"+a.TextAreaId);b.controls.confirmButton=$("#"+a.ConfirmButtonId);b.controls.checkbox.setOnChangeCallback(b.onCheckboxClick);b.controls.radioButtons.on("change",b.onRadioButtonClick);CCL.TextAreaExtensions.setMaxLength(b.controls.textArea,a.ReasonMaxLength);b.controls.textArea.on("input change",b.onTextAreaUpdate)};this.revealSections=function(){b.showActionsIfPossible();
b.showReasonAndConfirmationIfPossible();b.enableConfirmButtonIfPossible()};this.onCheckboxClick=function(){b.showActionsIfPossible();b.enableConfirmButtonIfPossible()};this.onRadioButtonClick=function(){b.showReasonAndConfirmationIfPossible();b.enableConfirmButtonIfPossible()};this.onTextAreaUpdate=function(){b.enableConfirmButtonIfPossible()};this.showActionsIfPossible=function(){b.isUserConfirmed()&&b.sections.actions.show()};this.showReasonAndConfirmationIfPossible=function(){b.isActionSelected()&&
(b.sections.reason.show(),b.sections.confirmation.show())};this.enableConfirmButtonIfPossible=function(){b.isUserConfirmed()&&b.isActionSelected()&&b.isReasonProvided()?b.controls.confirmButton.prop("disabled",!1):b.controls.confirmButton.prop("disabled",!0)};this.isUserConfirmed=function(){return b.controls.checkbox.isChecked()};this.isActionSelected=function(){return b.controls.radioButtons.is(":checked")};this.isReasonProvided=function(){return""!=b.controls.textArea.val().trim()};$(function(){return b.initialize(a)})}}();
e.Default=d})(e.Gdpr||(e.Gdpr={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){var b=this;this.context=a;this.onDialogAddButtonClick=function(a){var c=[];a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.Saved&&a!==f.CheckboxStateMachine.State.AttachedByUser||c.push(b)});b.selectedHierarchyIds.val(c.join());b.isHierarchySelectionChanged=!0};this.onDialogClosed=function(){b.isHierarchySelectionChanged&&b.context.Scripts.SelectHierarchyScript()};this.setupHierarchyLinkClickHandler()}Object.defineProperty(a.prototype,
"selectedHierarchyIds",{get:function(){return $("#"+this.context.Controls.SelectedHierarchyIds)},enumerable:!0,configurable:!0});a.prototype.setupHierarchyLinkClickHandler=function(){var a=this,c=e.hierarchyDialogManagerInstance,g=this.selectedHierarchyIds.val()?this.selectedHierarchyIds.val().split(","):[];if(c)$("#"+this.context.Controls.AddHierarchyLinkId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){a.isHierarchySelectionChanged=!1;var b=new Map;g.forEach(function(a){b.set(parseInt(a),
f.CheckboxStateMachine.State.Saved)});c.openDialog({itemStates:b,disabledItemIds:[],header:a.context.Resources.HierarchyDialogHeader,afterOkClickCallback:a.onDialogAddButtonClick,afterCloseDialogCallback:a.onDialogClosed,allowFolderSelection:!0},{})})};return a}();e.AddEditModuleApps=d})(e.ManageApps||(e.ManageApps={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.modalDialog=window[this.getDialogId()];this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){var a=window[b.settings.TreeViewSelectorContainerId];a.init({allowFolderSelection:!0,itemStates:b.currentParams.itemStates,disabledItemIds:b.currentParams.disabledItemIds});var c=0<a.countCheckedItems();b.controls.OkButton.prop("disabled",
!c);b.controls.Container.on(a.settings.StateChangedEventName,function(a,c){b.controls.OkButton.prop("disabled",0===c)});a.onFolderContentLoaded();c=b.controls.Container.find(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.ItemId)).first();a.expandFolder(c)},afterCloseDialog:function(){void 0!==b.currentParams.afterCloseDialogCallback&&b.currentParams.afterCloseDialogCallback()}})}a.prototype.openDialog=function(a,c){this.currentParams=a;$.extend(c,{treeViewContainerId:this.settings.TreeViewSelectorContainerId});
this.ajaxParams=c;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,c,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1)};a.prototype.closeDialog=function(){CssModal.closeDialog()};a.prototype.getDialogId=function(){return this.controls.Container.prop("id")};a.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.on("click",function(b){a.currentParams.afterOkClickCallback(a.currentParams.itemStates);a.closeDialog();b.preventDefault()})};
return a}();e.HierarchyDialogManager=d})(e.ManageApps||(e.ManageApps={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.context=a;e.finalAssessmentInstance=this}d.prototype.toggleView=function(a){$(a).closest(this.context.Controls.ItemRootCssSelector).find("> li").toggle()};d.prototype.alertAjaxError=function(a){CCL.CommonFunctions.alertAjaxError(a,null,null)};d.prototype.updateViewScore=function(a){var b=a.val();b==this.context.Settings.NotAssessmentStringPattern&&(b=this.context.Settings.NotAssessmentReplaceValue);$(a).closest(this.context.Controls.ItemRootCssSelector).find(this.context.Controls.ScoreCssSelector).text(b)};
d.prototype.assessPerson=function(a,b,c,g,h){a={personId:a,assessmentId:c,assessmentItemId:b.getValue(),courseId:g,gradeBookItemId:h};$.post(this.context.WebMethods.AssessWithScaleUrl,a).fail(this.alertAjaxError).done(this.updateViewScore(b))};return d}();e.FinalAssessment=f})(f.AssessmentRecord||(f.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){e.termAssessmentOverviewInstance=this;this.context=a}a.prototype.init=function(){var a=this;$("#"+this.context.Controls.CompleteCourseButtonId).click(function(){return a.completeSelectedCourses()});$("#"+this.context.Controls.RevertCourseButtonId).click(function(){return a.revertSelectedCourses()})};a.prototype.getSelectedCourses=function(){for(var a=[],c=0,g=$("#"+this.context.Controls.GridId).find("tbody > tr.selected").toArray();c<
g.length;c++){var h=$("span["+this.context.Settings.DataSerializedInfoAttribute+"]",g[c]).first();h=$.parseJSON(h.attr(this.context.Settings.DataSerializedInfoAttribute));a.push(h)}return a};a.prototype.getRevertConfirmationMessage=function(a){var b="";switch(a.length){case 0:break;case 1:b=this.context.Settings.RevertConfirmOneCourseMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title);break;case 2:b=this.context.Settings.RevertConfirmTwoCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,
a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title);break;case 3:b=this.context.Settings.RevertConfirmThreeCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title).replace(this.context.Settings.CourseCPattern,a[2].Title);break;default:b=this.context.Settings.RevertConfirmFourOrMoreCoursesMessagesPattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,
a[1].Title).replace(this.context.Settings.NumberOfCoursesPattern,(a.length-2).toString())}return b};a.prototype.checkSelectionExists=function(a){return 0==a.length?(jAlert(this.context.Settings.PleaseMakeSelectionMessage),!1):!0};a.prototype.completeSelectedCourses=function(){var a=this,c=this.getSelectedCourses();this.checkSelectionExists(c)&&jConfirm(this.context.Settings.CompleteConfirmMessage,this.context.Settings.ConfirmDialogTitle,function(b){b&&a.context.Scripts.PostbackComplete()})};a.prototype.revertSelectedCourses=
function(){var a=this,c=this.getSelectedCourses();this.checkSelectionExists(c)&&(c=this.getRevertConfirmationMessage(c),jConfirm(c,this.context.Settings.ConfirmDialogTitle,function(b){b&&a.context.Scripts.PostbackRevert()}))};return a}();e.TermAssessmentOverview=d})(e.Headteacher||(e.Headteacher={}))})(f.Assessment||(f.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c,g){void 0===g&&(g=3);this.targetContainer=a;this.dotContainerCssClass=b;this.dotsCssClass=c;this.dotsCount=g;b=$("<div>").addClass(this.dotContainerCssClass);for(c=0;c<g;c++)b.append($("<div>").addClass(this.dotsCssClass));a.append(b)}d.prototype.removeDotContainer=function(){this.targetContainer.find("."+this.dotContainerCssClass).remove()};return d}();e.CalendarBouncingDots=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb=
{}));(function(f){f=f.Calendar||(f.Calendar={});f=f.CalendarClientConstants||(f.CalendarClientConstants={});f.maxCountOfAddedElements=50;f.animationSpeedMilliseconds=500;f.dataAttributeNames={addResourceMenuParameters:"add-resource-menu-parameters"};f.cssClasses={expandableSection:"itsl-calendar-event-expandable-section"}})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){this.utility=a;this.cssClassesCache={expandableSection:this.utility.cssClasses.ExpandableContainer+" "+e.CalendarClientConstants.cssClasses.expandableSection,expandableHeaderArrow:this.utility.cssClasses.Icon+" "+this.utility.cssClasses.IconArrowForward+" "+this.utility.cssClasses.IconColorDefault}}d.prototype.buildElementListMarkup=function(a,b,c,g,h,d,e,k){if(null!=d&&0<d.length||k)b=$("<div>").attr(h,"").append(k&&b.enableElementLinkManagement&&
c!==f.ElementLinkDialog.ContentElementType.Homework?this.buildAddResourceButtonContainer({CourseId:b.courseId,ContentElementType:c}):$()).append(d),this.buildExpandableContainer(a,this.buildHeader(g,e),b)};d.prototype.buildExpandableContainer=function(a,b,c){var g=this;b=$("<section>").addClass(this.cssClassesCache.expandableSection).append($("<div>").addClass(this.utility.cssClasses.ExpandableContainerHeader).append($("<i>").addClass(this.cssClassesCache.expandableHeaderArrow)).append($("<span>").append(b))).append($("<div>").addClass(this.utility.cssClasses.ExpandableContainerContent).append(c));
a.append(b);return new ExpandableContainer(b,{expander:void 0,target:void 0,onToggleCallback:function(a,b){return b.find(g.utility.selectors.expandableContainerHeaderIcon).toggleClass(g.utility.cssClasses.IconArrowForward,!a).toggleClass(g.utility.cssClasses.IconArrowDown,a)}})};d.prototype.buildHeader=function(a,b){return $("<span>").text(a).append(" (").append($("<span>").attr(this.utility.dataAttributes.elementListCount,"").text(b)).append(")")};d.prototype.buildAddResourceButtonContainer=function(a){return $("<div>").addClass(this.utility.cssClasses.AddElementButton).append($("<a>").prop("href",
"javascript:void(0);").data(e.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters,a).text(this.utility.terms.addElement))};d.prototype.removeElementAndUpdateCounter=function(a,b){var c=this,g=b.closest("."+this.utility.cssClasses.ExpandableContainer);b.slideUp(e.CalendarClientConstants.animationSpeedMilliseconds,function(){b.remove();c.updateHeaderCounter(g,g.find(c.utility.selectors.elementListItem).length)})};d.prototype.rebuildElementListMarkup=function(a,b){this.rebuildListMarkup(a.find(this.utility.selectors.elementListContainer),
b.Resources,b.ResourceCount);this.rebuildListMarkup(a.find(this.utility.selectors.elementListContainerHomework),b.Homework,b.HomeworkCount)};d.prototype.rebuildListMarkup=function(a,b,c){a.find("."+this.utility.cssClasses.ElementList).remove();a.append(b);this.updateHeaderCounter(a.closest("."+this.utility.cssClasses.ExpandableContainer),c)};d.prototype.updateHeaderCounter=function(a,b){a.find(this.utility.selectors.elementListCount).text(b)};return d}();e.CalendarElementListMarkupBuilder=k})(f.Calendar||
(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){return function(e,d,a){var b=this;void 0===a&&(a=function(){});this.checkSessionUrl=e;this.anErrorOccurredTerm=d;this.onBeforeRedirect=a;this.handleAjaxError=function(a){var c=function(){b.onBeforeRedirect();window.top.location.href=b.checkSessionUrl},h=function(){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(CCL.CommonFunctions.htmlDecode(b.anErrorOccurredTerm))};a.status===CCL.CommonConstants.httpStatusCodes.badRequest||a.status===CCL.CommonConstants.httpStatusCodes.unauthorized||
a.status===CCL.CommonConstants.httpStatusCodes.methodNotAllowed?$.ajax({type:"GET",url:b.checkSessionUrl}).done(function(a){return(a?c:h)()}).fail(c):h()}}}();f.CommonAjaxClient=e})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.onAssessmentChanged=function(a){var b=c.$assessmentItemDropDown.find("option:selected").val(),g=b===c.settings.Constants.UseScoreItemValue;c.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(c.settings.EventNames.ToggleCriteriaWeightVisibility,{show:b!==c.settings.Constants.DoNotUseAssessmentItemValue});0===c.$assessmentItemDropDown.length&&(g=c.settings.Permissions.IsScoreUsed);c.$maxScoreFloatingSection.toggle(g);
c.onMaxScoreStateChanged();c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel();if(void 0!==c.onChangeHandler&&void 0!==a)c.onChangeHandler(a)};window[a]=this;this.settings=b;$(function(){c.$addToGradeBookCheck=$("#"+c.settings.Controls.AddToGradeBookCheckbox);c.$assessmentItemDropDown=$("#"+c.settings.Controls.AssessmentItemDropDown);c.$maxScoreFloatingSection=$("#"+c.settings.Controls.MaxScoreFloatingSection);c.$assessmentSection=$("#"+c.settings.Controls.AssessmentSection);c.$maxScoreTextBox=
$("#"+c.settings.Controls.MaxScoreTextBox);c.$addToGradeBookCheckWithLabel=c.$addToGradeBookCheck.add(c.$addToGradeBookCheck.next());c.$categoryDropDown=$("#"+c.settings.Controls.CategoryDropDown);c.$termDropDown=$("#"+c.settings.Controls.TermDropDown);c.onAssessmentChanged(void 0);c.$assessmentItemDropDown.change(c.onAssessmentChanged);c.$maxScoreTextBox&&(c.$maxScoreTextBox.on("blur input",function(){return c.onMaxScoreStateChanged()}),c.$maxScoreTextBox.keydown(function(a){-1!==$.inArray(a.which,
[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter,CCL.CommonConstants.keyCodes.decimalPoint,CCL.CommonConstants.keyCodes.comma,CCL.CommonConstants.keyCodes.period])||a.which===CCL.CommonConstants.keyCodes.keyA&&(a.ctrlKey||a.metaKey)||a.which>=CCL.CommonConstants.keyCodes.end&&a.which<=CCL.CommonConstants.keyCodes.arrowDown||(a.shiftKey||a.which<CCL.CommonConstants.keyCodes.key0||
a.which>CCL.CommonConstants.keyCodes.key9)&&(a.which<CCL.CommonConstants.keyCodes.numpad0||a.which>CCL.CommonConstants.keyCodes.numpad9)&&a.preventDefault()}));c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel()})}d.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};d.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};d.prototype.isValid=
function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};d.prototype.validateScore=function(a){if(""===a)return!1;a=parseFloat(a.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(a)||a<this.settings.MaxScoreMinValue||a>this.settings.MaxScoreMaxValue?!1:!0};d.prototype.onChange=function(a){this.onChangeHandler=a};d.prototype.onMaxScoreStateChanged=
function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};d.prototype.getState=function(){var a={};a.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val());a.IsScore=a.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,10);a.MaxScore=parseInt(this.$maxScoreTextBox.val());a.AddToGradeBook=this.$addToGradeBookCheck.is(":checked");this.$categoryDropDown&&(a.CategoryId=
parseInt(this.$categoryDropDown.val()));this.$termDropDown&&(a.TermId=parseInt(this.$termDropDown.val()));return a};d.prototype.toggleTermAndCategoryPanel=function(){var a=this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue;a&&this.$addToGradeBookCheck.is(":visible")||(this.$addToGradeBookCheckWithLabel.toggle(a),this.$addToGradeBookCheck.prop("checked",a),eval(this.settings.ToggleTermAndCategoryPanelClientFunctionName+"("+a+")"))};return d}();
e.AssessmentScaleControl=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c,g){var b=this;this.settings=a;this.collaborationWindows={};this.open=function(a){b.isCollaborationWindowOpened(a)&&b.collaborationWindows[a].close();b.shouldOpenWindowImmediately()&&(b.collaborationWindows[a]=window.open("","_blank"));$.getJSON(b.settings.Endpoints.GetCollaborationLink,{collaborationId:a}).then(function(c,g,h){return b.handleSuccessResponse(a,c,h)}).fail(function(c){return b.handleFailureResponse(a,c)})};this.shouldOpenWindowImmediately=
function(){return!b.settings.IsAndroidWebView};this.isCollaborationWindowOpened=function(a){return b.collaborationWindows[a]&&!b.collaborationWindows[a].closed};this.handleSuccessResponse=function(a,c,g){if(c.IsSuccess)b.openWindowWithUrl(a,c);else b.onGetCollaborationLinkError(a,c,g)};this.openWindowWithUrl=function(a,c){b.isCollaborationWindowOpened(a)?b.collaborationWindows[a].location.href=c.CollaborationUrl:b.collaborationWindows[a]=window.open(c.CollaborationUrl,"_blank")};this.handleFailureResponse=
function(a,c){b.onGetCollaborationLinkError(a,null,c)};this.callbacks={onGetCollaborationLinkError:g.getFunctionByName(c?c.OnGetCollaborationLinkError:void 0)};$("#"+a.InstanceId+" ."+a.LinkListItemCssClass+" a").on("click",function(c){c=$(c.target).closest("."+a.LinkListItemCssClass).attr(a.CollaborationIdAttributeName);b.open(c)})}a.prototype.onGetCollaborationLinkError=function(a,c,g){this.isCollaborationWindowOpened(a)&&this.collaborationWindows[a].close();if(this.callbacks.onGetCollaborationLinkError)this.callbacks.onGetCollaborationLinkError(c,
g)};return a}();e.CollaborationLinkList=d})(e.Collaboration||(e.Collaboration={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;window[d.clientInstanceName]=this;this.dialog=window[a.CssModalClientInstanceName];this.settings=a;$(function(){$("."+b.settings.HybridEditorSettings.ItemContainer).on(b.settings.HybridEditorSettings.AjaxErrorClientEvent,b.onSetFeedbackColumnValueError).on(b.settings.HybridEditorSettings.SaveErrorClientEvent,b.onSetFeedbackColumnValueError)})}d.getInstance=function(){return window[d.clientInstanceName]};d.openCopyElementDialog=function(){d.getInstance().dialog.openDialog(!1)};
d.closeCopyElementDialog=function(){CssModal.closeDialog()};d.setCopyElementDialogHeight=function(a){d.getInstance().dialog.setPreferredSize(0,a)};d.prototype.onSetFeedbackColumnValueError=function(a,b){CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.AlertProblemStoringLastEdit,this.settings.Terms.AlertDialogTitle,this.settings.Terms.Ok,!1);a.stopPropagation()};d.clientInstanceName="CopyElementDialogClientInstanceName";return d}();e.CopyElementDialog=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){this.webMethods=a;this.widgetSettings=b}a.prototype.createGetAgendaDayListContainerAjaxRequest=function(a,b,h){var c=this;return function(){return $.ajax({type:"POST",url:c.webMethods.GetAgendaDayListContainer,data:{fromDateTime:a,toDateTime:b,datePeriod:h,widgetSettings:c.widgetSettings}})}};a.prototype.createHideTaskAjaxRequest=function(a,b,h,d){var c=this;return function(){return $.ajax({type:"POST",url:c.webMethods.HideTask,
data:{taskId:a,fromDateTime:b,toDateTime:h,datePeriod:d,widgetSettings:c.widgetSettings}})}};return a}();d.AgendaAjaxClient=a})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){this.settings=a;this.controls=b}a.prototype.getEventDescription=function(a){return a.data(this.settings.DataAttributes.EventDescription)};a.prototype.getEventTitle=function(a){return a.data(this.settings.DataAttributes.EventTitle)};a.prototype.getTaskHideId=function(a){return a.data(this.settings.DataAttributes.TaskHideId)};a.prototype.getExpectedDatePeriod=function(a){if(a===this.controls.WeekViewLink.get(0))return f.Controls.DatePeriod.Week;
if(a===this.controls.DayViewLink.get(0))return f.Controls.DatePeriod.Day;throw Error("Unexpected control: "+a);};return a}();d.AgendaUtility=a})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.settings=c;window[a]=this;this.allowEveryoneCheckbox=window[c.AllowEveryoneCheckboxClientName];this.disableCommentsCheckbox=window[c.DisableCommentsCheckboxClientName];this.editBulletinSettingsDialog=window[this.settings.EditBulletinsSettingsDialogClientId]}a.prototype.showEditBulletinSettings=function(){var a=this;this.editBulletinSettingsDialog.show().then(function(b){b===CCL.ConfirmDialogResult.Confirm?(b={AllowEveryoneSetting:a.allowEveryoneCheckbox.isChecked()},
a.disableCommentsCheckbox&&(b.DisableCommentsSetting=a.disableCommentsCheckbox.isChecked()),$.ajax({type:"POST",url:a.settings.UpdateCourseBulletinSettingsUrl,contentType:"application/json; charset=utf-8",data:JSON.stringify({courseId:a.settings.CourseId,settings:b})}).fail(function(){jAlert(a.settings.ErrorMessage)}).done(function(){window.location.reload()})):(a.allowEveryoneCheckbox.toggle(a.settings.AllowAllUsersPostBulletinsCourseSetting),a.disableCommentsCheckbox&&a.disableCommentsCheckbox.toggle(a.settings.DisableLightBulletinCommentsCourseSetting))});
$("#"+this.settings.EditBulletinsSettingsDialogClientId).find(":focusable").first().focus()};return a}();e.Bulletins=d})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function a(a,c,g,h,d,e){var b=this;this.$itemSelector=a;this.$filterMenu=c;this.idDataAttribute=g;this.selectAllItemId=h;this.optionCheckboxPrefix=d;this.languageTerms=e;this.handleItemSelection=function(a,c){a=a.closest("[data-"+b.idDataAttribute+"]").data(b.idDataAttribute);var g=c.Checked;c=a===b.selectAllItemId;var h=b.$filterMenu.find("[data-"+b.idDataAttribute+"]");if(c)h.each(function(a,c){a=$(c).data(b.idDataAttribute);b.getOptionCheckBox(a).toggleWithSuppressEvents(g)});
else{b.getOptionCheckBox(a).toggleWithSuppressEvents(g);var d=null,l=!0;h.each(function(a,c){a=$(c).data(b.idDataAttribute);return a!==b.selectAllItemId&&(a=b.getOptionCheckBox(a).getState().Checked,null==d&&(d=a),a!==d)?l=!1:!0});b.toggleAllOptionCheckBox(l,!1,d)}b.setDefaultItemText()};this.hasItems=function(){return 0<b.$filterMenu.find("[data-"+b.idDataAttribute+"]").length};this.getSelectedItems=function(){var a=[];b.$filterMenu.find("[data-"+b.idDataAttribute+"]").each(function(c,g){c=$(g).data(b.idDataAttribute);
b.getOptionCheckBox(c).getState().Checked&&c!==b.selectAllItemId&&a.push(c)});return a};this.areAllItemsSelected=function(){return null!=b.allOptionCheckBox?b.allOptionCheckBox.getState().Checked:!1};this.areNoneItemsSelected=function(){return 0===b.getSelectedItems().length};this.setDefaultItemText=function(){if(b.areAllItemsSelected())var a=b.languageTerms.All+" "+b.languageTerms.Items.toLowerCase();else b.areNoneItemsSelected()?a=b.languageTerms.SelectItem:(a=b.getSelectedItems(),a=1<a.length?
b.getSelectedItems().length+" "+b.languageTerms.Items.toLowerCase():b.$filterMenu.find("[data-"+b.idDataAttribute+'="'+a[0]+'"]').find("label").text());b.$itemSelector.text(CCL.CommonFunctions.htmlEncode(a))};this.getOptionCheckBox=function(a){return window[""+b.optionCheckboxPrefix+a]};this.toggleAllOptionCheckBox=function(a,c,g){a?c||b.allOptionCheckBox.toggleWithSuppressEvents(g):b.allOptionCheckBox.toggleWithSuppressEvents(!1)};this.setDefaultItemText()}Object.defineProperty(a.prototype,"allOptionCheckBox",
{get:function(){return this.getOptionCheckBox(this.selectAllItemId)},enumerable:!0,configurable:!0});return a}(),d=function(){function a(b,c,g){var h=this;this.settings=c;this.controls=g;this.selectedItemIds=[];this.onItemClickHandler=function(b,c){h.itemMultiSelectorManager.handleItemSelection($(b.target),c);h.selectedItemIds=h.itemMultiSelectorManager.areAllItemsSelected()||h.itemMultiSelectorManager.areNoneItemsSelected()?[]:h.itemMultiSelectorManager.getSelectedItems();h.controls.ItemMultiSelector.trigger(a.itemMultiSelectorOnChangeEventName,
h)};this.initPerfectScrollbar=function(){h.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});var a=new CCL.CallbackDebouncer(function(){h.controls.MenuContainer.perfectScrollbar("update")});$(window).on("resize",function(){a.invokeCallback(null,100)})};window[b]=this;this.itemMultiSelectorManager=new f(this.controls.ItemMultiSelector,this.controls.MenuContainer,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.OptionCheckboxPrefix,this.settings.LanguageTerms);
this.initPerfectScrollbar();this.controls.ItemMultiSelector.parent().on("focusin",function(){h.controls.ItemMultiSelector.addClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.parent().on("focusout",function(){h.controls.ItemMultiSelector.removeClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&h.controls.ItemMultiSelector.trigger("click")});this.controls.MenuContainer.on(this.settings.OptionCheckboxStateChangedEventName,
this.onItemClickHandler)}Object.defineProperty(a.prototype,"hasItems",{get:function(){return this.itemMultiSelectorManager.hasItems()},enumerable:!0,configurable:!0});a.itemMultiSelectorOnChangeEventName="itemMultiSelector:onchange";return a}();e.ItemMultiSelector=d})(f.ItemMultiSelector||(f.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var a=this;this.settings=d;this.onItemClickHandler=function(b){var c=window[a.settings.OptionCheckboxClientInstanceName];c.toggle(!c.getState().Checked);b.stopPropagation()};d=$("#"+d.ClientId);d.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);d.on("keyup",function(b){if(b.which===CCL.CommonConstants.keyCodes.enter)a.onItemClickHandler(b)})}}();e.Item=f})(f.ItemMultiSelector||(f.ItemMultiSelector={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){var e=function(){return function(){this.registerSafeImgBinding=function(){ko.bindingHandlers.safeImg={init:function(e,d){var a=ko.utils.unwrapObservable(d());d=ko.utils.unwrapObservable(a.src);a=ko.utils.unwrapObservable(a.fallback);$(e).prop("src",d||a)},update:function(e,d){var a=ko.utils.unwrapObservable(d());d=ko.utils.unwrapObservable(a.src);a=ko.utils.unwrapObservable(a.fallback);$(e).prop("src",d||a)}}};this.registerPerfectScrollBarBinding=function(){ko.bindingHandlers.perfectlyScrollable={init:function(e,
d,a,b,c){d=ko.unwrap(d())||{minScrollbarLength:10};var g=$(e);g.perfectScrollbar(d);var h=new CCL.CallbackDebouncer(function(){g.perfectScrollbar("update")}),l=function(){h.invokeCallback(null,100)};$(window).on("resize",l);ko.utils.domNodeDisposal.addDisposeCallback(e,function(){g.perfectScrollbar("destroy");$(window).off("resize",l)})}}}}}();f.KnockoutCustomBindingsManager=e})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.clientFunctions={};window[a]=this;this.settings=b;this.terms=b.Terms;this.cssClasses=b.CssClasses;this.clientFunctions.DeleteCurrentPostback=new Function(b.ClientFunctions.DeleteCurrentPostback);this.clientFunctions.DeleteSelectedPostback=new Function(b.ClientFunctions.DeleteSelectedPostback);this.clientFunctions.PublishAllPostback=new Function(b.ClientFunctions.PublishAllPostback);this.clientFunctions.UnpublishAllPostback=new Function(b.ClientFunctions.UnpublishAllPostback);
this.clientFunctions.UnpublishCurrentPostback=new Function(b.ClientFunctions.UnpublishCurrentPostback);this.clientFunctions.UnpublishSelectedPostback=new Function(b.ClientFunctions.UnpublishSelectedPostback);this.grid=window[b.Controls.GridClientInstanceName]}d.prototype.publishAll=function(){var a=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.PublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(b){b&&a.clientFunctions.PublishAllPostback()})};d.prototype.unpublishAll=
function(){var a=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.UnpublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(b){b&&a.clientFunctions.UnpublishAllPostback()})};d.prototype.deleteCurrentLearningObjective=function(){this.deleteConfirmation(this.settings.IsCurrentSubjectPublished,this.clientFunctions.DeleteCurrentPostback,this.clientFunctions.UnpublishCurrentPostback)};d.prototype.deleteSelectedLearningObjectives=function(){var a=this.grid.getSelectedValues();
if(0===a.length)CCL.CommonFunctions.jAlertAjaxError(this.terms.PleaseMakeSelection,this.terms.Alert,this.terms.Ok,!1);else{for(var b=!1,c=0;c<a.length;c++)if(0<this.grid.getRow(a[c]).find("."+this.cssClasses.Published).length){b=!0;break}this.deleteConfirmation(b,this.clientFunctions.DeleteSelectedPostback,this.clientFunctions.UnpublishSelectedPostback)}};d.prototype.deleteConfirmation=function(a,b,c){var g=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.FirstDeleteConfirmation,this.terms.PleaseConfirm,
this.terms.Ok,this.terms.Cancel,function(h){h&&(a?g.deleteConfirmationFromPublishedSubject(b,c):b())})};d.prototype.deleteConfirmationFromPublishedSubject=function(a,b){var c=[];c.push(new CCL.ConfirmButtonMetaData(this.terms.Unpublish,"","confirm_unpublish"));c.push(new CCL.ConfirmButtonMetaData(this.terms.Delete,this.cssClasses.DeleteButton,"confirm_delete"));c.push(new CCL.ConfirmButtonMetaData(this.terms.Cancel,"","confirm_cancel"));CCL.CommonFunctions.jAjaxMultiButtonConfirm("<p>"+this.terms.DeleteConfirmationFromPublishedSubjectBody+
"</p><p>"+this.terms.DeleteConfirmationFromPublishedSubjectFooter+"</p>",this.terms.AreYouSure,c,function(c){c&&c.customId&&"confirm_cancel"!==c.customId&&("confirm_delete"===c.customId?a():"confirm_unpublish"===c.customId&&b())})};return d}();e.LearningObjectiveOverview=f})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function b(c,g){var h=this;this.settings=g;window[c]=this;this.$container=$("."+this.settings.CssClasses.Container+CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.StepId,this.settings.StepId));this.$removeStepLink=this.$container.find("."+this.settings.CssClasses.RemoveStepLink);this.$addElementLink=this.$container.find("."+this.settings.CssClasses.AddElementLink);this.$removeElementLinks=this.$container.find("."+this.settings.CssClasses.RemoveElementLink);
this.$conditionDropDown=this.$container.find("."+this.settings.CssClasses.ConditionDropDown);this.$ifStepDropDown=this.$container.find("."+this.settings.CssClasses.IfStepDropDown);this.$scoreDropDown=this.$container.find("."+this.settings.CssClasses.ScoreDropDown);this.$elseContainer=this.$container.find("."+this.settings.CssClasses.ElseContainer);this.$elseStepDropDown=this.$container.find("."+this.settings.CssClasses.ElseStepDropDown);this.ifStepDropDownOptionCount=this.$ifStepDropDown.find("option").length;
this.$removeElementLinks.click(function(c){c=$(c.currentTarget).closest("."+h.settings.CssClasses.ElementContainer);c=parseInt(c.data(h.settings.DataAttributes.ElementId),10);$(window).trigger(b.removeElementEventName,new a(h.settings.StepId,c))});this.$conditionDropDown.change(function(){var a=h.$conditionDropDown.val()===e.TriggerCondition.Score.toString();h.$scoreDropDown.toggle(a);h.$elseContainer.toggle(a);h.$ifStepDropDown.prop("selectedIndex",a&&1<h.ifStepDropDownOptionCount?1:0);h.triggerStepStateChangedEvent()});
this.$removeStepLink.click(function(){$(window).trigger(b.removeStepEventName,h.settings.StepId)});this.$scoreDropDown.add(this.$ifStepDropDown).add(this.$elseStepDropDown).change(function(){return h.triggerStepStateChangedEvent()});this.$addElementLink.click(function(a){$(window).trigger(b.addElementEventName,new d(h.settings.StepId,$(a.currentTarget)))})}b.getInstance=function(a){return window[a]};b.prototype.getState=function(){var a={};a.StepOrder=this.settings.StepOrder;a.StepId=this.settings.StepId;
a.Triggers=[];var b={NumberOfSatisfiedConditions:1};b.StepResult=this.getStepResult(this.$ifStepDropDown);b.Conditions=[];var h={};h.ElementId=parseInt(this.$container.find("."+this.settings.CssClasses.ElementContainer).data(this.settings.DataAttributes.ElementId),10);h.TriggerCondition=parseInt(this.$conditionDropDown.val(),10).toString();h.TriggerCondition===e.TriggerCondition.Score.toString()&&(h.MinScore=this.$scoreDropDown.val(),h.MaxScore="101");b.Conditions.push(h);a.Triggers.push(b);if(h.TriggerCondition===
e.TriggerCondition.Score.toString()){var d={};d.NumberOfSatisfiedConditions=b.NumberOfSatisfiedConditions;d.StepResult=this.getStepResult(this.$elseStepDropDown);d.Conditions=[];b={};b.ElementId=h.ElementId;b.TriggerCondition=e.TriggerCondition.Score.toString();b.MinScore="0";b.MaxScore=h.MinScore;d.Conditions.push(b);a.Triggers.push(d)}return a};b.prototype.getStepResult=function(a){a=parseInt(a.val(),10);var b={};a===e.TriggerResult.NoNewSteps?b.TriggerResult=e.TriggerResult.NoNewSteps:a===e.TriggerResult.Finish?
b.TriggerResult=e.TriggerResult.Finish:(b.TriggerResult=e.TriggerResult.NextStep,b.NextStepId=a.toString());return b};b.prototype.triggerStepStateChangedEvent=function(){$(window).trigger(b.stepStateChangedEventName,this.getState())};b.stepStateChangedEventName="LearningPathBuilderStep:StepStateChanged";b.removeStepEventName="LearningPathBuilderStep:StepRemoved";b.addElementEventName="LearningPathBuilderStep:addElement";b.removeElementEventName="LearningPathBuilderStep:RemoveElement";return b}();
e.LearningPathBuilderStep=f;var d=function(){return function(a,c){this.stepId=a;this.$triggerLink=c}}();e.AddElementEventParameters=d;var a=function(){return function(a,c){this.stepId=a;this.elementId=c}}();e.RemoveElementFromStepParams=a})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function a(b){var c=this;this.settings=b;this.signalRRetryConnection=0;window[a.clientInstanceName]=this;$(function(){c.jQueryAny=jQuery;c.jQueryAny.connection.hub.url=c.settings.Endpoint;var b=c.jQueryAny.connection.learningPathHub;"undefined"!==typeof b&&null!==b&&(b.client.alertNewElementAccessGranted=function(b,c,g){$(window).trigger(a.newElementAccessGrantedEvent,new d(b,c,g))});c.startSignalRHub();c.jQueryAny.connection.hub.connectionSlow(function(){return console.log("We are currently experiencing difficulties with the connection.")});
c.jQueryAny.connection.hub.reconnecting(function(){c.setSignalROnlineStatus(!1);console.log("SignalR reconnecting.")});c.jQueryAny.connection.hub.disconnected(function(){c.setSignalROnlineStatus(!1);console.log("SignalR disconnected.");c.reconnectToSignalRHub(!0)});c.jQueryAny.connection.hub.reconnected(function(){c.setSignalROnlineStatus(!0);console.log("SignalR reconnected.");c.reconnectToSignalRHub(!1)})})}a.prototype.setSignalROnlineStatus=function(a){$(window).trigger("SignalRConnectionStatus",
a)};a.prototype.startSignalRHub=function(){var a=this;this.jQueryAny.connection.hub.start().done(function(){var b="";localStorage.getItem("learningpath-channelid")&&(b=localStorage.getItem("learningpath-channelid"));5>=b.length&&(b="");$.post(a.settings.CommunicationChannelEndPoint,{channelId:a.jQueryAny.connection.hub.id,unregister:b}).done(function(b){a.setSignalROnlineStatus(!0);a.reconnectToSignalRHub(!1);console.log("SignalR connection registered. ChannelId: "+a.jQueryAny.connection.hub.id)});
localStorage.setItem("learningpath-channelid",a.jQueryAny.connection.hub.id)}).fail(function(b){a.setSignalROnlineStatus(!1);a.reconnectToSignalRHub(!0);console.log("Error starting SignalR connection: "+b)})};a.prototype.reconnectToSignalRHub=function(a){var b=this;a?this.signalRRetryConnection<=this.settings.RetryConnectionMax&&(this.signalRRetryConnection+=1,window.clearInterval(this.signalRRetryInterval),this.signalRRetryInterval=window.setInterval(function(){return b.startSignalRHub()},3E3)):
(window.clearInterval(this.signalRRetryInterval),this.signalRRetryConnection=0)};a.clientInstanceName="LearningPathSignalRListenerClientInstanceName";a.newElementAccessGrantedEvent="LearningPathSignalRListener:NewElementAccessGranted";return a}();e.LearningPathSignalRListener=f;var d=function(){return function(a,b,c){this.learningPathId=a;this.stepId=b;this.elementId=c}}();e.ElementAccessGrantedEventData=d})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.settings=a;window[d.clientInstanceName]=this;$(function(){b.$elementListContainer=$("#"+b.settings.Controls.ElementListContainerId);b.$frame=$("#"+b.settings.Controls.Frame);b.$loadingIndicator=$("#"+b.settings.Controls.LoadingIndicator);b.$elementListContainer.on("click","."+b.settings.Css.ElementTitle,function(a){a=$(a.currentTarget);var c=a.closest("."+b.settings.Css.ElementContainer);c=parseInt(c.data(b.settings.DataAttributes.ElementId),
10);c!==b.currentElementId&&(a=a.prop("href"),b.currentElementId=c,b.setFrameUrl(a));return!1});var a=b.$elementListContainer.find(""+CCL.CommonFunctions.getDataSelector(b.settings.DataAttributes.ElementId,b.settings.ElementIdToSelect)).find("."+b.settings.Css.ElementTitle);0<a.length?a.first().click():b.$elementListContainer.find("."+b.settings.Css.ElementTitle).first().click();IframeResizer.reportSetIframeDefaultHeight()})}d.getInstance=function(){return window[d.clientInstanceName]};d.reloadElementList=
function(){d.getInstance().reloadElementList()};d.prototype.setFrameUrl=function(a){a?(this.$frame.prop("src",a),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};d.prototype.reloadElementList=function(){var a=this;$.get(this.settings.Urls.StudentViewElementList).done(function(b){a.$elementListContainer.html(b)})};d.clientInstanceName="StudentViewLearningPathInstance";return d}();e.TakeLearningPathDialogContent=f})(f.LearningPath||(f.LearningPath=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;window[d.clientInstanceName]=this;this.settings=a;$(function(){$("."+b.settings.Css.DeleteLink).click(function(){return b.onLearningPathDeleteClick()});$("."+b.settings.Css.ConvertToFolderLink).click(function(){return b.onConvertToFolderClick()});b.activationCheckBox=window[b.settings.ActivationCheckBoxClientInstanceName];b.activationCheckBox.setOnChangeCallback(function(a,g){return b.onLearningPathActivateCheckBoxClick(g)})})}d.getInstance=
function(){return window[d.clientInstanceName]};d.prototype.showErrors=function(a,b){void 0===b&&(b=!1);this.showError(a.join("<br />"),b)};d.prototype.showError=function(a,b){void 0===b&&(b=!1);CCL.CommonFunctions.jAlertAjaxError(a,this.settings.Terms.ErrorOccured,this.settings.Terms.Ok,b)};d.prototype.onLearningPathDeleteClick=function(){var a=this;CCL.CommonFunctions.jAjaxConfirm(this.settings.Terms.ElementAreYouSureDeleteThisElement,this.settings.Terms.PleaseConfirm,this.settings.Terms.Delete,
this.settings.Terms.Cancel,function(b){b&&a.deleteLearningPath()})};d.prototype.onLearningPathActivateCheckBoxClick=function(a){var b=this,c=a.Checked;$.post(this.settings.Urls.ActivateLearningPath,{learningPathId:this.settings.LearningPathId,activate:c}).done(function(a){a.Success?((a=top)&&a.reloadFolder&&a.reloadFolder("item"+b.settings.ParentFolderId,"item"+b.settings.LearningPathId),window.location.href=b.settings.Urls.ViewLearningPath):(b.activationCheckBox.toggleWithSuppressEvents(!c),b.showErrors(a.ErrorMessages))}).fail(function(){return b.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};
d.prototype.onConvertToFolderClick=function(){var a=this;CCL.CommonFunctions.jAjaxConfirm(this.settings.Terms.AreYouSure,this.settings.Terms.PleaseConfirm,this.settings.Terms.Ok,this.settings.Terms.Cancel,function(b){b&&a.convertLearningPathToFolder()})};d.prototype.convertLearningPathToFolder=function(){var a=this;$.post(this.settings.Urls.ConvertToFolder.Action).done(function(b){b.Success?window.location.href=a.settings.Urls.ConvertToFolder.RedirectAfterSucceed:a.showErrors(b.ErrorMessages)}).fail(function(){return a.showError(a.settings.Terms.LearningPathGeneralErrorMessage)})};
d.prototype.deleteLearningPath=function(){var a=this;$.ajax({url:this.settings.Urls.Delete.Action,type:"DELETE",dataType:"JSON"}).done(function(b){b.Success?window.location.href=a.settings.Urls.Delete.RedirectAfterSucceed:a.showErrors(b.ErrorMessages)}).fail(function(){return a.showError(a.settings.Terms.LearningPathGeneralErrorMessage)})};d.clientInstanceName="LearningPathCommonEditActionsInstance";return d}();e.LearningPathCommonEditActions=f})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){var b=this;window[d.clientInstanceName]=this;this.settings=a;this.learningPathCommonEditActions=e.LearningPathCommonEditActions.getInstance();$(function(){$("."+b.settings.Css.AddStepLink).click(function(a){return b.onAddStepClick($(a.currentTarget))});$("."+b.settings.Css.AddElementMenuItem).click(function(a){a=$(a.currentTarget);switch(parseInt(a.attr("data-"+b.settings.DataAttributes.ElementExternalSource),10)){case f.AddResourceMenu.ElementExternalSourceType.Course:b.addFromCourse()}(a=CCL.AlternativeChoiceManager.getOpenedDialog())&&
a.closeDialog()});$(window).on(e.LearningPathBuilderStep.stepStateChangedEventName,function(a,g){return b.onStepStateChanged(g)}).on(e.LearningPathBuilderStep.removeStepEventName,function(a,g){return b.onRemoveStepClick(g)}).on(e.LearningPathBuilderStep.addElementEventName,function(a,g){return b.onAddElementClick(g)}).on(e.LearningPathBuilderStep.removeElementEventName,function(a,g){return b.onRemoveElementClick(g.stepId,g.elementId)})})}d.prototype.onStepStateChanged=function(a){var b=this;$.ajax({url:this.settings.Urls.UpdateStep,
type:"PUT",dataType:"JSON",data:{learningPathId:this.settings.LearningPathId,stepState:a}}).done(function(a){a.Success?window.location.href=b.settings.Urls.ViewLearningPath:b.learningPathCommonEditActions.showErrors(a.ErrorMessages,!0)}).fail(function(){return b.learningPathCommonEditActions.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};d.prototype.onAddStepClick=function(a){var b=this;a=parseInt(a.data(this.settings.DataAttributes.StepOrder),10);$.post(this.settings.Urls.AddStep,
{learningPathId:this.settings.LearningPathId,stepOrderToInsertAfter:a}).done(function(a){a.Success?window.location.href=b.settings.Urls.ViewLearningPath:b.learningPathCommonEditActions.showErrors(a.ErrorMessages)}).fail(function(){return b.learningPathCommonEditActions.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};d.prototype.onAddElementClick=function(a){this.stepIdToAddElement=a.stepId;window[this.settings.AddMenuClientInstanceName].openDialog(a.$triggerLink,0)};d.prototype.addFromCourse=
function(){var a=this,b={locationId:this.settings.CourseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course},c={disallowMultipleSelection:!0,elementStates:new Map,elementType:f.ElementLinkDialog.ContentElementType.All,showAll:!1,header:this.settings.Terms.AddResourceModalTitle,afterOkClickCallback:function(b){if(b){var c=[];b.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||c.push(b)});1===c.length&&(a.addElementToStep(a.stepIdToAddElement,
c[0]),(b=top)&&b.reloadFolder&&b.reloadFolder())}},allowFolderSelection:!1,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,b)};d.prototype.addElementToStep=function(a,b){var c=this;$.post(this.settings.Urls.AddElementToStep,{learningPathId:this.settings.LearningPathId,stepId:a,elementId:b}).done(function(a){a.Success?window.location.href=c.settings.Urls.ViewLearningPath:c.learningPathCommonEditActions.showErrors(a.ErrorMessages)}).fail(function(){return c.learningPathCommonEditActions.showError(c.settings.Terms.LearningPathGeneralErrorMessage)})};
d.prototype.onRemoveStepClick=function(a){var b=this;CCL.CommonFunctions.jAjaxConfirm(this.settings.Terms.AreYouSure,this.settings.Terms.PleaseConfirm,this.settings.Terms.Delete,this.settings.Terms.Cancel,function(c){c&&b.removeStep(a)})};d.prototype.removeStep=function(a){var b=this;$.ajax({url:this.settings.Urls.RemoveStep,type:"DELETE",dataType:"JSON",data:{learningPathId:this.settings.LearningPathId,stepId:a}}).done(function(a){a.Success?window.location.href=b.settings.Urls.ViewLearningPath:b.learningPathCommonEditActions.showErrors(a.ErrorMessages,
!0)}).fail(function(){return b.learningPathCommonEditActions.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};d.prototype.onRemoveElementClick=function(a,b){var c=this;$.ajax({url:this.settings.Urls.RemoveElementFromStep,type:"DELETE",dataType:"JSON",data:{learningPathId:this.settings.LearningPathId,stepId:a,elementId:b}}).done(function(a){a.Success?window.location.href=c.settings.Urls.ViewLearningPath:c.learningPathCommonEditActions.showErrors(a.ErrorMessages)}).fail(function(){return c.learningPathCommonEditActions.showError(c.settings.Terms.LearningPathGeneralErrorMessage)})};
d.clientInstanceName="LearningPathBuilderInstance";return d}();e.LearningPathBuilder=k})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;window[d.clientInstanceName]=this;this.settings=a;$(function(){$("."+b.settings.Css.ElementTitle).click(function(a){a=$(a.currentTarget).prop("href");b.dialog.openDialog(a);return!1});b.dialog=CCL.FullScreenDialog.getInstance();$(b.dialog).on(CCL.FullScreenDialog.onCloseEvent,function(){clearTimeout(b.timer);window.location.href=b.settings.Urls.ViewLearningPath});$(window).on(e.LearningPathSignalRListener.newElementAccessGrantedEvent,
function(a,g){b.settings.LearningPathId===g.learningPathId&&(b.timer=setTimeout(function(){b.reloadElementList()},b.settings.ReloadElementListTimeoutInMs))})})}d.prototype.reloadElementList=function(){this.dialog.isOpened()?e.TakeLearningPathDialogContent.reloadElementList():window.location.href=this.settings.Urls.ViewLearningPath};d.clientInstanceName="TakeLearningPathDialogLauncherInstance";return d}();e.TakeLearningPathDialogLauncher=f})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var k=function(){function a(b,c){var g=this;this.dataUrl=b;this.model=c;this.page=0;this.run=function(b){b&&(g.page=b);g.model.lettersLoading(!0);b={supervisorType:g.model.settings.SupervisorType,termId:g.model.termId(),hierarchyIds:g.model.hierarchyIds(),paging:{pageIndex:g.page,pageSize:a.pageSize},sorting:{sort:g.model.sorting.term,sortDescending:g.model.sorting.descending},search:g.model.lettersSearch()};return $.post(g.dataUrl,b,function(a){g.model.addLetters(a);g.page++;
g.model.lettersLoading(!1)},"json")}}a.pageSize=50;return a}(),d=function(){return function(){this.term="FullName";this.descending=!1}}(),a=function(){function a(a,b){var c=this;this.settings=a;this.controls=b;this.addLetters=function(a){[].push.apply(c.allLetters(),a);c.allLetters.valueHasMutated();c.lettersLoading(!1);c.lettersCount(c.allLetters().length);c.areAllLettersRetreived(!a||0===a.length||a.length<k.pageSize)};this.showCard=function(a){return c.showStudentProfile(a)};this.showLetters=function(a){return c.showStudentProfile(a,
"letters")};this.setSorting=function(a,b){a=$(b.currentTarget).data(c.settings.DataAttributes.SortValue);c.allLetters([]);c.lettersLoading(!0);c.lettersCount(0);a===c.sorting.term?c.sorting.descending=!c.sorting.descending:(c.sorting.term=a,c.sorting.descending=!0);c.fetcher.page=0;c.fetcher.run()};this.showMoreLetters=function(a){$(a.currentTarget).blur();c.fetchNextLettersPage()};this.getParentLettersOverview=function(a){return 0<a.parentLettersTotalNumber?a.lettersOpenedByParentsTotalNumber+"/"+
a.parentLettersTotalNumber:"-"};this.getStudentLettersOverview=function(a){return 0<a.studentLettersTotalNumber?a.lettersOpenedByStudentTotalNumber+"/"+a.studentLettersTotalNumber:"-"};this.fetchData=function(){c.allLetters([]);c.lettersCount(c.allLetters().length);c.lettersLoading(!0);c.fetcher.page=0;null!=c.fetchDataPromise&&c.fetchDataPromise.readyState!==c.fetchDataPromise.DONE&&c.fetchDataPromise.abort();c.fetchDataCallbackDebouncer.invokeCallback({},200)};this.onSearchChangeHandler=function(a){var b=
$(a.currentTarget).val();b=(a.which===CCL.CommonConstants.keyCodes.del||a.which===CCL.CommonConstants.keyCodes.backspace)&&b&&""===$.trim(b);if(a.which===CCL.CommonConstants.keyCodes.enter||b)c.lettersSearch($(a.currentTarget).val()),c.fetchData(),c.$searchFilter.val(c.lettersSearch()),a.stopPropagation();CCL.CommonFunctions.isMobileDevice()&&a.which===CCL.CommonConstants.keyCodes.enter&&$(a.currentTarget).blur();0===$(a.currentTarget).val().length?c.$searchFilterClear.hide():c.$searchFilterClear.show()};
this.onSearchClearHandler=function(){c.lettersSearch("");c.$searchFilter.val(c.lettersSearch());c.$searchFilterClear.hide();c.fetchData()};this.fetchNextLettersPage=function(){c.areAllLettersRetreived()||(null!=c.lettersScrollingPromise&&c.lettersScrollingPromise.readyState!==c.lettersScrollingPromise.DONE&&c.lettersScrollingPromise.abort(),c.lettersScrollingTimeout&&clearTimeout(c.lettersScrollingTimeout),c.lettersScrollingTimeout=setTimeout(function(){c.allLetters.valueHasMutated();c.lettersScrollingPromise=
c.fetcher.run()},50))};this.onFetchLettersHandler=function(a){a=$(a.target).scrollTop();if(a>c.lettersLastScrollTop){var b=$("."+c.settings.CssClasses.StudentsList).children("li");b=b.eq(b.length-k.pageSize/2);CCL.CommonFunctions.isOnScreen(b,.5,.5)&&c.fetchNextLettersPage()}c.lettersLastScrollTop=a};this.showStudentProfile=function(a,b){document.showProfileCard?b?document.showProfileCard(a.personId,b):document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};
this.configTermFilter=function(){c.controls.TermFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,c.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,b){c.measureLettersOverviewPageFilterUsageKpi();c.termId(b.selectedItemId);c.fetchData()};this.configHierarchyFilter=function(){c.controls.HierarchyFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,c.onHierarchyFilterItemClickHandler)};this.onHierarchyFilterItemClickHandler=
function(a,b){c.measureLettersOverviewPageFilterUsageKpi();c.hierarchyIds(b.selectedItemIds);c.fetchData()};this.measureLettersOverviewPageFilterUsageKpi=function(){CCL.CommonFunctions.measureKpi(c.settings.WebMethods.MeasureKpi,c.settings.SupervisorKpiSection,c.settings.LettersOverviewPageFilterUsageKpiMeasurement,c.settings.RegularKpiContext)};this.fetchDataCallbackDebouncer=new CCL.CallbackDebouncer(function(){c.fetchDataPromise=c.fetcher.run()});this.allLetters=ko.observableArray([]);this.lettersInitiated=
ko.observable(!1);this.lettersLoading=ko.observable(!0);this.letters=ko.pureComputed(function(){return c.allLetters()});this.lettersCount=ko.observable(0);this.areAllLettersRetreived=ko.observable(!1);this.lettersSearch=ko.observable("");this.$searchFilter.keyup(this.onSearchChangeHandler);this.$searchFilterClear.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onSearchClearHandler);this.sorting=new d;this.lettersLastScrollTop=$(window).scrollTop();$(window).on("scroll touchmove",
this.onFetchLettersHandler);this.configTermFilter();this.configHierarchyFilter();this.termId=ko.observable(null);this.hierarchyIds=ko.observableArray([]);this.isSearchOrFilteringApplied=ko.pureComputed(function(){return 0<c.lettersSearch().length||null!=c.termId()||0<c.hierarchyIds().length})}Object.defineProperty(a.prototype,"$searchFilter",{get:function(){return $("."+this.settings.CssClasses.SearchFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$searchFilterClear",{get:function(){return $("."+
this.settings.CssClasses.SearchFilterClear)},enumerable:!0,configurable:!0});return a}();e.LettersOverviewViewModel=a;var b=function(){function b(b,c){var g=this;this.settings=b;this.controls=c;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).hasClass("c-supervisor-letters__inner")&&a.stopPropagation()};(new f.KnockoutCustomBindingsManager).registerSafeImgBinding();this.model=new a(b,c);ko.applyBindings(this.model,$("."+this.settings.CssClasses.Container)[0]);this.$container.on("click",
this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){g.$container.off("click",g.preventFromDropDownMenuFromClosing)});this.model.fetcher=new k(this.settings.WebMethods.GetSupervisorLettersOverviews,this.model);this.model.fetcher.run().done(function(){g.model.lettersInitiated(!0)})}Object.defineProperty(b.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return b}();
e.SupervisorLetters=b})(f.Letter||(f.Letter={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.settings=b;this.$mainContainer=$("#"+this.settings.Controls.MainContainer);this.$courseGroupSelectorLink=$("#"+this.settings.Controls.GroupSelectorLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.settingManager=e.Settings.Manager.getInstance();$(function(){$("#"+c.settings.Controls.DropDownMenuContainer).find("."+c.settings.MenuItemCssClass).click(function(a){a=
$(a.currentTarget).data("groupid");$.post(c.settings.WebMethods.CreateCollaborationBasedOnCourseGroup,{elementId:c.settings.ElementId,groupId:a}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});c.$submitIndividuallyLink.on("click",function(){$.post(c.settings.WebMethods.UseIndividualSubmission,{elementId:c.settings.ElementId}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})})})}a.prototype.processResponse=
function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();d.CourseGroups=a})(f.Collaboration||(f.Collaboration={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a,c){d.call(this,c.checkSession,a.terms.errorMessage,function(){});this.utility=a;this.services=c}__extends(a,d);a.prototype.getAddResourceMenu=function(a){return $.ajax({type:"GET",url:this.services.getAddResourceMenu,data:a})};a.prototype.updateEventElements=function(a){return $.ajax({type:"PUT",url:this.services.updateEventElements,data:JSON.stringify(a),contentType:"application/json"})};a.prototype.removeElement=function(a){return $.ajax({type:"DELETE",
url:this.services.removeElement,data:JSON.stringify(a),contentType:"application/json"})};return a}(f.CommonAjaxClient);e.CalendarAjaxClient=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b,c){var g=this;this.utility=a;this.ajaxClient=b;this.calendarCallbacks=c;this.onElementLinkDialogOkClicked=function(a){return function(b){var c=[],h=[];b.forEach(function(a,b){switch(a){case f.CheckboxStateMachine.State.AttachedByUser:c.push(b);break;case f.CheckboxStateMachine.State.DetachedByUser:h.push(b)}});(0<c.length||0<h.length)&&g.ajaxClient.updateEventElements({EventId:a.activityId,ElementIdsToAdd:c,ElementIdsToRemove:h}).done(function(b){g.calendarCallbacks.onUpdateEventElementsComplete([a],
b)})}}}d.prototype.attachAddResourceButtonClickHandler=function(a){var b=this;a.mainContainer.on("click",this.utility.selectors.addElementButton,function(c){c.preventDefault();c=$(c.currentTarget);var g=c.parent(),h=b.utility.getAddResourceMenuParameters(c),d=function(){var c=b.getAlternativeChoice(h);c.openDialog(g);a.setToggleElement($("."+b.utility.cssClasses.ElementSelectorContainer).add($("."+b.utility.cssClasses.CssModal)).add(c.getMask()))};if(b.getAlternativeChoice(h))d();else{var f=new e.CalendarBouncingDots(c,
b.utility.cssClasses.BouncingDotContainer,b.utility.cssClasses.BouncingDot);g.toggleHyperlink(!1);b.ajaxClient.getAddResourceMenu(h).done(function(a){f.removeDotContainer();g.toggleHyperlink(!0);$("body").append(a);d()})}})};d.prototype.onAddResourceMenuItemLinkClick=function(a,b,c){this.utility.getElementExternalSourceType(a)===f.AddResourceMenu.ElementExternalSourceType.Course&&this.addFromCourse(a,b,c)};d.prototype.onRemoveElementClick=function(a,b){var c=this,g=a.closest(this.utility.selectors.elementListItem);
a=g.find("."+this.utility.cssClasses.ElementListTitle).text();confirm(CCL.CommonFunctions.formatString(this.utility.terms.removeElementConfirmation,a))&&(a=this.utility.getElementForEventData(g),this.ajaxClient.removeElement({EventId:a.EventId,ElementId:a.ElementId}).done(function(){return c.calendarCallbacks.onRemoveElementsComplete([b],g)}))};d.prototype.addFromCourse=function(a,b,c){var g=this,h={locationId:b.courseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course},d=new Map,m=
[];c.find("."+this.utility.cssClasses.ElementList).find(this.utility.selectors.elementListItem).each(function(a,b){a=g.utility.getElementForEventData($(b));a.AddedManually&&d.set(a.ElementId,f.CheckboxStateMachine.State.Saved);a.CanBeRemoved||m.push(a.ElementId)});a={elementStates:d,disabledElementIds:m,afterOkClickCallback:this.onElementLinkDialogOkClicked(b),maxCountOfAddedElements:e.CalendarClientConstants.maxCountOfAddedElements,elementType:this.utility.getContentElementType(a),showAll:!0,header:this.utility.terms.addResourceDialogTitle,
allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.CalendarEvent};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,h)};d.prototype.getAlternativeChoice=function(a){return window[CCL.CommonFunctions.formatString(this.utility.constants.AlternativeChoiceTemplate,a.ContentElementType,a.CourseId)]};return d}();e.CalendarElementLinkManager=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c,g){this.constants=a;this.cssClasses=b;this.dataAttributeNames=c;this.terms=g;this.dataAttributes={elementListContainer:"data-"+this.dataAttributeNames.ElementListContainer,elementListContainerHomework:"data-"+this.dataAttributeNames.ElementListContainerHomework,elementListCount:"data-"+this.dataAttributeNames.ElementListCount};this.selectors={addElementButton:"."+b.AddElementButton+" > a",elementListContainer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainer),
elementListContainerHomework:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainerHomework),elementListCount:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListCount),elementListItem:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListItem),expandableContainerHeaderIcon:"."+this.cssClasses.ExpandableContainerHeader+" > ."+this.cssClasses.Icon}}d.prototype.getElementForEventData=function(a){return a.data(this.dataAttributeNames.ElementListItem)};
d.prototype.getElementExternalSourceType=function(a){return a.data(this.dataAttributeNames.ElementExternalSource)};d.prototype.getContentElementType=function(a){return a.data(this.dataAttributeNames.ContentElementType)};d.prototype.getAddResourceMenuParameters=function(a){return a.data(e.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters)};return d}();e.CalendarUtility=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f;(function(a){a[a.NotLoaded=0]="NotLoaded";a[a.Loading=1]="Loading";a[a.Loaded=2]="Loaded"})(f||(f={}));var d=function(){function a(a,c,g,h){function b(a){var b=a.position().left+a.width()/2;a=a.position().top+10;r.openDialogAt(b,a,!1)}var d=this,e=f.NotLoaded,k=$("<div class='ccl-context-dialog-content-container'></div>").hide();a.after(k);var n=null,r=new ContextDialog(k,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,width:420,marginTop:c.height(),marginLeft:-210,
scrollToLastWindowOnClose:!1,cssClass:h}),v=r.closeDialog;r.setCloseFunction(function(a){v(a)});window.addEventListener("orientationchange",function(a){return r.closeDialog(a)});k.click(function(){return r.closeDialog()});c.click(function(a){if(r.isOpened())r.closeDialog();else{var c=$(a.target),h=d.getParams(c);e!==f.Loaded||d.paramsAreEqual(n,h)||(e=f.NotLoaded,k.empty());e===f.Loaded?b($(a.currentTarget)):e===f.NotLoaded&&(e=f.Loading,$.get(g,d.formatUrlParams(h),function(c){c&&(k.append(c),b($(a.currentTarget)));
e=f.Loaded;n=h}).fail(function(){return e=f.NotLoaded}))}})}a.prototype.getParams=function(a){throw Error("Abstract method should be overriden");};a.prototype.paramsAreEqual=function(a,c){throw Error("Abstract method should be overriden");};a.prototype.formatUrlParams=function(a){throw Error("Abstract method should be overriden");};return a}();e.BaseDetailedInfo=d})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){var b=$(".tablelisting"),h=$(".tablelisting > table > tbody > tr > td > a");d.call(this,b,h,a,c)}__extends(a,d);a.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").children("td").eq(1).children().html();return{Period:b,CustomerId:a}};a.prototype.paramsAreEqual=function(a,c){return null==a?!1:a.Period===c.Period&&a.CustomerId===c.CustomerId};a.prototype.formatUrlParams=function(a){return{periodid:a.Period,customerId:a.CustomerId}};
return a}(e.BaseDetailedInfo);e.ListOnlineSitesDetailedInfo=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c,g){var b=$(".tabsframe > div");d.call(this,b,a,c,g)}__extends(a,d);a.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").data("c-c");return{Period:b,CountryCode:a}};a.prototype.paramsAreEqual=function(a,c){return null==a?!1:a.Period===c.Period&&a.CountryCode===c.CountryCode};a.prototype.formatUrlParams=function(a){return{periodid:a.Period,countrycode:a.CountryCode}};return a}(e.BaseDetailedInfo);e.ListOnlineSummaryDetailedInfo=
f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b,c){var g=this,h=this;window[a.ClientInstanceName]=this;this.settings=a;this.controls=b;this.customScripts=c;this.timer=0;this.selectedLoIds=this.settings.LearningObjectiveIds;this.controls.criteriaWeightsHidden.val(JSON.stringify(this.settings.CriteriaWeights));this.$document=$(document);this.$saveButton=$("."+this.settings.ClientIds.SaveButtonCssClass);this.$titleInput=$("#"+this.settings.ClientIds.Title);this.isTitleValid=this.validateTitle();
this.isDescriptionValid=!1;this.isDescriptionToolbarExpanded=a.IsDescriptionToolbarExpanded;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.form,this.settings.Terms.BeforeUnloadWarningMessage,{$cancelButtons:this.$saveButton});this.settings.SubmitButtonLocked&&this.$saveButton.toggleHyperlink(!1);h.isSettingsValid=!0;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){a.extendedData.updateSettings||
(h.selectedLoIds=a.extendedData.loIds,h.controls.criteriaWeightsHidden.val(a.extendedData.criteriaWeights),$(document).trigger(g.settings.EventNames.RubricChanged,{loIds:g.selectedLoIds,criteriaWeights:a.extendedData.criteriaWeights}))});this.controls.manageRubricPopupTriggerLink.click(function(){h.initManageManageRubricPopup();window[h.settings.ClientIds.RubricPopup].openDialog();return!1});this.$titleInput.on("blur",function(){h.onTitleChangeHandler()});this.$titleInput.on("input",function(a){h.onInputChangeHandler(a,
h.onTitleChangeHandler)});this.$document.on(this.settings.EventNames.ValidStateChanged,function(a,b){h.isSettingsValid=b;h.updateSaveButtonState()});this.$document.on(this.settings.EventNames.LearningObjectivesChanged,function(a,b){b.isSyncContext||(h.selectedLoIds=b.ids,$(document).trigger(g.settings.EventNames.UpdateMaxScore,{loIds:h.selectedLoIds,criteriaWeights:h.controls.criteriaWeightsHidden.val()}))});this.$document.on(this.settings.EventNames.ToggleCriteriaWeightsVisibility,function(a,b){g.settings.ShowCriteriaWeights=
b.show});if(h.settings.IsDescriptionReadOnly)this.isDescriptionValid=!0;else if("undefined"!==typeof CKEDITOR)CKEDITOR.on("instanceReady",function(){var a=h.customScripts.getDescriptionEditorInput();a.on("blur",function(){g.onDescriptionChangeHandler()});a.on("change",function(a){g.onInputChangeHandler(a,g.onDescriptionChangeHandler)});a.on("contentDom",function(){a.document.on("keyup",function(a){g.onInputChangeHandler(a,g.onDescriptionChangeHandler)})});if(h.isDescriptionToolbarExpanded){var b=
a.getCommand(h.settings.DescriptionToolbarExpandedCommandName),c=b.editorFocus;b.editorFocus=!1;a.execCommand(h.settings.DescriptionToolbarExpandedCommandName);b.editorFocus=c}a.on(h.settings.EventNames.DescriptionToolbarExpanded,function(a){h.isDescriptionToolbarExpanded=a.data.expanded;h.toggleDescriptionToolbar()});g.onDescriptionChangeHandler()});else this.onDescriptionChange($(this.customScripts.getDescriptionEditorInput())),this.isDescriptionValid=this.validateDescription();this.updateSaveButtonState()}
d.prototype.closeManageRubricDialog=function(){var a=$("#"+this.settings.ClientIds.RubricPopup).find("iframe").get(0).contentWindow;CCL.CommonFunctions.makePostMessageCall(a,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe))};d.prototype.collectContent=function(){var a={};a.Title=this.$titleInput.val();a.Description=this.customScripts.getDescription();var b=CCL.FileRepoUploader.GetInstanceForElement(this.settings.ClientIds.FileUploader);void 0!==b&&(a.SerializedUploadResults=
b.GetUploadResults());a.SerializedCriteriaWeights=this.controls.criteriaWeightsHidden.val();return a};d.prototype.lockSaveButton=function(a){this.settings.SubmitButtonLocked=a};d.prototype.validateTitle=function(){var a=this.$titleInput.val();return a&&0<a.length};d.prototype.validateDescription=function(){return!this.customScripts.isDescriptionEmpty()};d.prototype.onDescriptionChange=function(a){var b=this;a.on("blur",function(){b.onDescriptionChangeHandler()});a.on("input",function(a){b.onInputChangeHandler(a,
b.onDescriptionChangeHandler)})};d.prototype.onTitleChangeHandler=function(){this.isTitleValid=this.validateTitle();this.updateSaveButtonState()};d.prototype.typeWatch=function(a,b){clearTimeout(this.timer);this.timer=setTimeout(a.bind(this),b)};d.prototype.onInputChangeHandler=function(a,b){a=a.which;a>=CCL.CommonConstants.keyCodes.arrowLeft&&a<=CCL.CommonConstants.keyCodes.arrowDown||this.typeWatch(b,500)};d.prototype.onDescriptionChangeHandler=function(){this.isDescriptionValid=this.validateDescription();
this.updateSaveButtonState()};d.prototype.initManageManageRubricPopup=function(){var a=this.settings.ManageRubricDialogUrl,b=this.getParameterByName(a,"Ids");a=b?a.replace(b[0],b[0][0]+"Ids="+encodeURIComponent(this.selectedLoIds.join(","))):a+(-1===a.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(this.selectedLoIds.join(","));if(b=this.controls.criteriaWeightsHidden.val()){var c=this.getParameterByName(a,"CriteriaWeights");a=c?a.replace(c[0],c[0][0]+"CriteriaWeights="+encodeURIComponent(b)):a+(-1===
a.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(b)}b=this.settings.ShowCriteriaWeights?"1":"0";a=(c=this.getParameterByName(a,"ShowCriteriaWeights"))?a.replace(c[0],c[0][0]+"ShowCriteriaWeights="+b):a+(-1===a.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+b;window[this.settings.ClientIds.RubricPopup].setIframeUrl(a)};d.prototype.getParameterByName=function(a,b){return RegExp("[?&]"+b+"=([^&]*)").exec(a)};d.prototype.updateSaveButtonState=function(){this.settings.SubmitButtonLocked||this.$saveButton.toggleHyperlink(this.isSettingsValid&&
this.isTitleValid&&this.isDescriptionValid)};d.prototype.toggleDescriptionToolbar=function(){$.getJSON(this.settings.WebMethods.SetPersonSetting,{key:this.settings.PersonSettingIsDescriptionToolbarExpandedKey,value:this.isDescriptionToolbarExpanded?"true":"false"})};return d}();e.AddLearningToolElement=f})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.AddResourceMenu||(f.AddResourceMenu={});f=f.ElementExternalSourceType||(f.ElementExternalSourceType={});f[f.Library=0]="Library";f[f.Course=1]="Course";f[f.CreateNew=2]="CreateNew";f[f.Computer=3]="Computer"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.Available=1]="Available";d[d.PartlyBooked=2]="PartlyBooked";d[d.Booked=3]="Booked"})(e.BookableResourceStatuses||(e.BookableResourceStatuses={}));(function(d){d[d.Monday=1]="Monday";d[d.Tuesday=2]="Tuesday";d[d.Wednesday=4]="Wednesday";d[d.Thursday=8]="Thursday";d[d.Friday=16]="Friday";d[d.Saturday=32]="Saturday";d[d.Sunday=64]="Sunday"})(e.WeekDays||(e.WeekDays={}))})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));(function(f){f=f.CheckboxStateMachine||(f.CheckboxStateMachine={});f=f.State||(f.State={});f[f.Empty=0]="Empty";f[f.Saved=1]="Saved";f[f.AttachedByUser=2]="AttachedByUser";f[f.DetachedByUser=3]="DetachedByUser"})(ItslearningWeb||(ItslearningWeb={}));(function(f){f=f.Controls||(f.Controls={});f=f.DatePeriod||(f.DatePeriod={});f[f.Day=0]="Day";f[f.Week=1]="Week"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementLinkDialog||(f.ElementLinkDialog={});f=f.ContentElementType||(f.ContentElementType={});f[f.All=0]="All";f[f.Resources=1]="Resources";f[f.Activities=2]="Activities";f[f.LearningObjectives=3]="LearningObjectives";f[f.Homework=4]="Homework"})(ItslearningWeb||(ItslearningWeb={}));(function(f){f=f.ElementParticipantPicker||(f.ElementParticipantPicker={});f=f.ItemType||(f.ItemType={});f[f.Participant=0]="Participant";f[f.Group=1]="Group"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.NextStep=0]="NextStep";e[e.NoNewSteps=-1]="NoNewSteps";e[e.Finish=-2]="Finish"})(e.TriggerResult||(e.TriggerResult={}));(function(e){e[e.Score=1]="Score";e[e.StatusViewed=2]="StatusViewed";e[e.StatusSubmitted=3]="StatusSubmitted";e[e.StatusCompleted=4]="StatusCompleted"})(e.TriggerCondition||(e.TriggerCondition={}))})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.First="First"]="First";d[d.Last="Last"]="Last";d[d.Best="Best"]="Best"})(e.WhichAttemptCounts||(e.WhichAttemptCounts={}));(function(d){d[d.Never="Never"]="Never";d[d.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";d[d.AfterDeadline="AfterDeadline"]="AfterDeadline";d[d.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";d[d.WhenTeacherDecides="WhenTeacherDecides"]="WhenTeacherDecides"})(e.WhenToShowResult||(e.WhenToShowResult={}));
(function(d){d[d.Never="Never"]="Never";d[d.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";d[d.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";d[d.WithResults="WithResults"]="WithResults";d[d.AfterDeadline="AfterDeadline"]="AfterDeadline"})(e.WhenToShowQuestionListAndAnswer||(e.WhenToShowQuestionListAndAnswer={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LearningToolElement||(f.LearningToolElement={});f=f.Settings||(f.Settings={});f=f.SettingType||(f.SettingType={});f[f.ActivationControl=1]="ActivationControl";f[f.Results=2]="Results";f[f.SubmissionStatusForStudent=3]="SubmissionStatusForStudent";f[f.CollaborationSelector=4]="CollaborationSelector";f[f.Deadline=5]="Deadline";f[f.Homework=6]="Homework";f[f.LearningObjectiveList=7]="LearningObjectiveList";f[f.AssessmentScale=8]="AssessmentScale";f[f.Attempts=9]="Attempts";f[f.ResultsAndFeedback=
10]="ResultsAndFeedback";f[f.SubmissionStatusForTeacher=11]="SubmissionStatusForTeacher";f[f.GroupSubmission=12]="GroupSubmission";f[f.AnonymousSubmission=13]="AnonymousSubmission";f[f.PlagiarismControl=14]="PlagiarismControl";f[f.Mandatory=15]="Mandatory";f[f.PeerAssessment=16]="PeerAssessment";f[f.TestMode=17]="TestMode"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.ShowCurrent=0]="ShowCurrent";e[e.ShowScheduled=1]="ShowScheduled";e[e.ShowExpired=2]="ShowExpired"})(e.BulletinsDisplayMode||(e.BulletinsDisplayMode={}));(function(e){e[e.Edit=0]="Edit";e[e.SetCommentsAvailability=1]="SetCommentsAvailability";e[e.ScheduleBulletin=2]="ScheduleBulletin";e[e.Delete=3]="Delete";e[e.ToggleSubscription=4]="ToggleSubscription"})(e.LightBulletinDropDownMenuActionType||(e.LightBulletinDropDownMenuActionType={}));(function(e){e[e.UnsubscribedManually=
0]="UnsubscribedManually";e[e.Subscribed=1]="Subscribed";e[e.WasNotSubscribed=2]="WasNotSubscribed"})(e.PersonSubscriptionStatus||(e.PersonSubscriptionStatus={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Planner||(f.Planner={});f=f.ClientColumnType||(f.ClientColumnType={});f[f.RichText=0]="RichText";f[f.TopicTitle=1]="TopicTitle";f[f.TopicDescription=2]="TopicDescription";f[f.PlanDescription=3]="PlanDescription";f[f.PlanTitle=4]="PlanTitle";f[f.ClassHours=5]="ClassHours"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.prototype.validateAndTransferElementStateAfterClick=function(a,b){this.validateElementState(a,b);return this.transferElementState(b)};d.prototype.transferElementStateAfterSave=function(a){return a===e.State.AttachedByUser?e.State.Saved:a===e.State.DetachedByUser?e.State.Empty:a};d.prototype.isElementChecked=function(a){return a===e.State.AttachedByUser||a===e.State.Saved};d.prototype.validateElementState=function(a,b){if(!(a&&!this.isElementChecked(b)||
!a&&this.isElementChecked(b)))throw Error("Incorrect element state occurred IsChecked "+a+" StateBeforeCheck "+b);};d.prototype.transferElementState=function(a){switch(a){case e.State.DetachedByUser:return e.State.Saved;case e.State.Empty:return e.State.AttachedByUser;case e.State.AttachedByUser:return e.State.Empty;case e.State.Saved:return e.State.DetachedByUser;default:throw Error("Unknown State "+a);}};return d}();e.Machine=f})(f.CheckboxStateMachine||(f.CheckboxStateMachine={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.peerAssessmentStateChanged=function(a){b.togglePeerAssessment();$(document).trigger(b.settings.Triggers.StateChanged,b.activated)};this.deadlineChanged=function(a){b.enabled=b.hasDeadline&&!b.groupActivityEnabled};this.groupActivityStateChanged=function(a,c){b.groupActivityEnabled=c;b.groupActivityEnabled&&(b.activated=!1);b.enabled=b.hasDeadline&&!b.groupActivityEnabled};window[a]=this;this.settings=c;$(function(){b.$peerAssessmentDropDownContainer=
$("#"+b.settings.Controls.PeersCountDropDownContainer);b.$peerAssessmentDropDown=$("#"+b.settings.Controls.PeersCountDropDown);b.$container=$("#"+b.settings.Controls.Container);b.checkbox=window[b.settings.ClientInstanceNames.RequirePeerAssessmentCheckBox];b.deadline=window[b.settings.ClientInstanceNames.Deadline];b.groupActivityEnabled=b.settings.GroupActivityEnabled;b.enabled=b.settings.Enabled;b.$peerAssessmentDropDown.val(b.settings.PeersCount.toString());b.togglePeerAssessment();if(!b.settings.Enabled||
!b.settings.HasDeadlinePassed)if($(b.deadline).change(b.deadlineChanged),b.checkbox.ontoggle(b.peerAssessmentStateChanged),b.settings.Events.GroupActivityStateChanged)$(document).off(b.settings.Events.GroupActivityStateChanged).on(b.settings.Events.GroupActivityStateChanged,b.groupActivityStateChanged)})}Object.defineProperty(a.prototype,"activated",{get:function(){return this.checkbox.isChecked()},set:function(a){this.checkbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"enabled",{set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$container.prop("title",a?"":this.tooltip);this.checkbox.enable(a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"peersToAssessCount",{get:function(){return this.$peerAssessmentDropDown.val()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasDeadline",{get:function(){var a=this.deadline.getState().DateTime;return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"tooltip",{get:function(){return this.settings.HasDeadlinePassed?this.settings.Terms.DeadlineHasPassedWarning:this.hasDeadline?this.groupActivityEnabled?this.settings.Terms.PeerAssessmentDisabledWarning:"":this.settings.Terms.DeadlineIsEmptyWarning},enumerable:!0,configurable:!0});a.prototype.togglePeerAssessment=function(){this.$peerAssessmentDropDownContainer.toggle(this.checkbox.isChecked());this.$peerAssessmentDropDownContainer.prop("disabled",!this.checkbox.isEnabled());
this.$peerAssessmentDropDown.prop("disabled",!this.checkbox.isEnabled())};return a}();e.PeerAssessment=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a){var b=this;this.viewModel=a;this.onJQueryReady=function(){b._$controlElement=$("#"+b.viewModel.ContainerId);b._$whenToShowResultElement=$("."+b.viewModel.WhenToShowResultSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerElement=$("."+b.viewModel.WhenToShowQuestionListAndAnswerSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerContainer=$("#"+b.viewModel.WhenToShowQuestionListAndAnswerContainer,
b._$controlElement);b._$revealCorrectAnswerContainer=$("#"+b.viewModel.RevealCorrectAnswerContainer,b._$controlElement);b._$maxAttemptsAllowedElement=$(""+b.viewModel.MaxAttemptsAllowedSelector)};this._revealCorrectAnswerElement=window[a.RevealCorrectAnswerInstanceName];this._deadlinePicker=window[a.DeadlineInstanceName];$(this.onJQueryReady)}Object.defineProperty(a.prototype,"$controlElement",{get:function(){return this._$controlElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$whenToShowResultElement",{get:function(){return this._$whenToShowResultElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowResultAllOptionElements",{get:function(){return $("option",this.$whenToShowResultElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerElement",{get:function(){return this._$whenToShowQuestionListAndAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAllOptionElements",
{get:function(){return $("option",this.$whenToShowQuestionListAndAnswerElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"revealCorrectAnswerElement",{get:function(){return this._revealCorrectAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerContainer",{get:function(){return this._$whenToShowQuestionListAndAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$revealCorrectAnswerContainer",
{get:function(){return this._$revealCorrectAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$maxAttemptsAllowedElement",{get:function(){return this._$maxAttemptsAllowedElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"deadlinePicker",{get:function(){return this._deadlinePicker},enumerable:!0,configurable:!0});a.prototype.appendOptionToWhenToShowResultElement=function(a,b){this.$whenToShowResultElement.append($("<option></option>").prop("value",
a.toString()).text(b))};a.prototype.appendOptionToWhenToShowQuestionListAndAnswerElement=function(a,b){this.$whenToShowQuestionListAndAnswerElement.append($("<option></option>").prop("value",a.toString()).text(b))};Object.defineProperty(a.prototype,"$whenToShowResultAfterDeadlineOptionItem",{get:function(){return this.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterDeadline)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem",
{get:function(){return this.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterDeadline)},enumerable:!0,configurable:!0});a.prototype.setTextToWhenToShowResultOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowResultElement).text(b)};a.prototype.setTextToWhenToShowQuestionListAndAnswerOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement).text(b)};a.prototype.$getWhenToShowResultOptionItem=function(a){return $("option[value="+
a.toString()+"]",this.$whenToShowResultElement)};a.prototype.$getWhenToShowQuestionListAndAnswerOptionItem=function(a){return $("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement)};return a}();d.ControlsProvider=a})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(){this.handlers=[]}a.prototype.on=function(a){this.handlers.push(a)};a.prototype.trigger=function(a){this.handlers.slice(0).forEach(function(b){return b(a)})};return a}();d.EventHandler=a;var b=function(){return function(a,b){this.previous=a;this.current=b}}();d.MaxAttemptsEventData=b;var c=function(){function c(c,g){var h=this;this.viewModel=c;this.controlsProvider=g;this.deadlineChanged=function(a){h.onDeadlineChangedHandler.trigger(h.hasDeadline)};
this.attemptsChanged=function(a){h.onAttemptsChangedHandler.trigger(new b(h.previousMaxAttemptsAllowed,h.maxAttemptsAllowed));h.previousMaxAttemptsAllowed=h.maxAttemptsAllowed};this.onJQueryReady=function(){h.previousMaxAttemptsAllowed=h.maxAttemptsAllowed;$(h.controlsProvider.deadlinePicker).change(h.deadlineChanged);h.controlsProvider.$maxAttemptsAllowedElement.change(h.attemptsChanged)};this.onDeadlineChangedHandler=new a;this.onAttemptsChangedHandler=new a;$(this.onJQueryReady)}Object.defineProperty(c.prototype,
"onDeadlineChanged",{get:function(){return this.onDeadlineChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"onAttemptsChanged",{get:function(){return this.onAttemptsChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.controlsProvider.$maxAttemptsAllowedElement.val())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasDeadline",{get:function(){var a=this.controlsProvider.deadlinePicker.getState().DateTime;
return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});c.prototype.hasMaxAttemptsChangedToMultiple=function(a,b){return 1===a&&(1<b||b===this.viewModel.UnlimitedAttemptsValue)};c.prototype.hasMaxAttemptsChangedToSingle=function(a,b){return 1===b&&(1<a||a===this.viewModel.UnlimitedAttemptsValue)};return c}();d.ExternalDependenciesController=c})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,h){var c=this;this.viewModel=a;this.controlsProvider=b;this.externalDependenciesController=h;this.removeAfterDeadline=function(){var a=c.whenToShowResult;c.controlsProvider.$whenToShowResultAfterDeadlineOptionItem.remove();a===e.WhenToShowResult.AfterDeadline&&c.controlsProvider.$whenToShowResultElement.val(c.defaultWhenToShowResult).change()};this.addAfterDeadline=function(){if(void 0===c.controlsProvider.$whenToShowResultAfterDeadlineOptionItem[0]){var a=
e.WhenToShowResult.AfterDeadline;c.controlsProvider.appendOptionToWhenToShowResultElement(a,c.getWhenToShowResultOptionText(a))}};this.deadlineChanged=function(a){a?c.addAfterDeadline():c.removeAfterDeadline()};this.replaceEachAttemptWithTheAttempt=function(){c.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){c.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=e.WhenToShowResult.AfterEachAttempt;a=a?c.getWhenToShowResultOptionAlternativeText(b):c.getWhenToShowResultOptionText(b);
c.controlsProvider.setTextToWhenToShowResultOption(b,a)};this.removeAfterAllAttempts=function(a){c.controlsProvider.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterAllAttempts).remove();a===e.WhenToShowResult.AfterAllAttempts&&c.controlsProvider.$whenToShowResultElement.val(c.defaultWhenToShowResult).change()};this.attachDefaultList=function(){c.controlsProvider.$whenToShowResultAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(c.getWhenToShowResultOptionText(a))});if(void 0===c.controlsProvider.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterAllAttempts)[0]&&
c.shouldHaveAfterAllAttemptsOption){var a=e.WhenToShowResult.AfterAllAttempts;c.controlsProvider.appendOptionToWhenToShowResultElement(a,c.getWhenToShowResultOptionText(a))}c.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowResultElementValue=function(a,b,g){c.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,b)?g===e.WhenToShowResult.AfterAllAttempts&&c.controlsProvider.$whenToShowResultElement.val(e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]).change():c.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,
b)&&(a=e.WhenToShowResult[e.WhenToShowResult.AfterAllAttempts],b===c.viewModel.UnlimitedAttemptsValue&&(a=e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]),g===e.WhenToShowResult.AfterEachAttempt&&c.controlsProvider.$whenToShowResultElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:c.replaceEachAttemptWithTheAttempt();c.removeAfterAllAttempts(c.whenToShowResult);break;case c.viewModel.UnlimitedAttemptsValue:c.replaceTheAttemptWithEachAttempt();c.removeAfterAllAttempts(c.whenToShowResult);
break;default:c.attachDefaultList()}c.adjustWhenToShowResultElementValue(a.previous,a.current,c.whenToShowResult)};this.onJQueryReady=function(){c.buildWhenToShowResultList()};h.onDeadlineChanged.on(this.deadlineChanged);h.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowResult",{get:function(){return e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]},enumerable:!0,configurable:!0});a.prototype.getWhenToShowResultOptionText=
function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowResultOptionAlternativeText=function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.buildWhenToShowResultList=function(){var a=this;this.controlsProvider.$whenToShowResultElement.empty();$.each(this.viewModel.WhenToShowResultsOptions,function(b,c){c.Value===e.WhenToShowResult.AfterEachAttempt?
1===a.externalDependenciesController.maxAttemptsAllowed?a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.AlternativeText):a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text):c.Value===e.WhenToShowResult.AfterDeadline?a.externalDependenciesController.hasDeadline&&a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text):c.Value===e.WhenToShowResult.AfterAllAttempts?a.shouldHaveAfterAllAttemptsOption&&a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,
c.Text):a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text)});this.controlsProvider.$whenToShowResultElement.val(this.viewModel.ResultsAndFeedbackState.WhenToShowResult.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,"whenToShowResult",{get:function(){var a=this.controlsProvider.$whenToShowResultElement.val();return e.WhenToShowResult[a]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"whenToShowResultsChanged",{get:function(){return this.whenToShowResult!==this.viewModel.ResultsAndFeedbackState.WhenToShowResult},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return 1!==this.externalDependenciesController.maxAttemptsAllowed&&this.externalDependenciesController.maxAttemptsAllowed!==this.viewModel.UnlimitedAttemptsValue&&this.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides&&this.whenToShowResult!==e.WhenToShowResult.AfterDeadline},
enumerable:!0,configurable:!0});return a}();d.WhenToShowResultsController=a})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b,h,d){var c=this;this.viewModel=a;this.controlsProvider=b;this.whenToShowResultsController=h;this.externalDependenciesController=d;this.removeAfterDeadline=function(){c.removeAfterDeadlineSetNewValue(c.defaultWhenToShowQuestionListAndAnswer)};this.addAfterDeadline=function(){if(c.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides){if(void 0===c.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem[0]){var a=
e.WhenToShowQuestionListAndAnswer.AfterDeadline;c.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,c.getWhenToShowQuestionListAndAnswerOptionText(a))}}else c.removeAfterDeadlineSetNewValue(c.neverWhenToShowQuestionListAndAnswer)};this.deadlineChanged=function(a){a?c.addAfterDeadline():c.removeAfterDeadline()};this.whenToShowResultChanged=function(a){a=c.whenToShowResultsController.whenToShowResult;a===e.WhenToShowResult.Never&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer.Never.toString()).change();
c.buildWhenToShowQuestionListAndAnswerList(c.whenToShowQuestionListAndAnswer);c.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(a!==e.WhenToShowResult.Never);c.deadlineChanged(c.externalDependenciesController.hasDeadline)};this.whenToShowQuestionListAndAnswerChanged=function(a){a=c.whenToShowQuestionListAndAnswer;a===e.WhenToShowQuestionListAndAnswer.Never&&c.controlsProvider.revealCorrectAnswerElement.toggle(!1);c.controlsProvider.$revealCorrectAnswerContainer.toggle(a!==e.WhenToShowQuestionListAndAnswer.Never)};
this.replaceEachAttemptWithTheAttempt=function(){c.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){c.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=e.WhenToShowQuestionListAndAnswer.AfterEachAttempt;a=a?c.getWhenToShowQuestionListAndAnswerOptionAlternativeText(b):c.getWhenToShowQuestionListAndAnswerOptionText(b);c.controlsProvider.setTextToWhenToShowQuestionListAndAnswerOption(b,a)};this.removeAfterAllAttempts=function(a){c.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterAllAttempts).remove();
a===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(c.defaultWhenToShowQuestionListAndAnswer).change()};this.attachDefaultList=function(){c.controlsProvider.$whenToShowQuestionListAndAnswerAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(c.getWhenToShowQuestionListAndAnswerOptionText(a))});if(void 0===c.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterAllAttempts)[0]&&
c.shouldHaveAfterAllAttemptsOption){var a=e.WhenToShowQuestionListAndAnswer.AfterAllAttempts;c.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,c.getWhenToShowQuestionListAndAnswerOptionText(a))}c.whenToShowResultsController.whenToShowResult===e.WhenToShowResult.WhenTeacherDecides&&c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);c.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowQuestionListAndAnswerElementValue=function(a,b,g){c.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,
b)?g===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]).change():c.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,b)&&(a=e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterAllAttempts],b===c.viewModel.UnlimitedAttemptsValue&&(a=e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]),
g===e.WhenToShowQuestionListAndAnswer.AfterEachAttempt&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:c.replaceEachAttemptWithTheAttempt();c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);break;case c.viewModel.UnlimitedAttemptsValue:c.replaceTheAttemptWithEachAttempt();c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);break;default:c.attachDefaultList()}c.adjustWhenToShowQuestionListAndAnswerElementValue(a.previous,
a.current,c.whenToShowQuestionListAndAnswer)};this.onJQueryReady=function(){c.buildWhenToShowQuestionListAndAnswerList(c.viewModel.ResultsAndFeedbackState.WhenToShowQuestionListAndAnswer);c.controlsProvider.$whenToShowResultElement.change(c.whenToShowResultChanged);c.controlsProvider.$whenToShowQuestionListAndAnswerElement.change(c.whenToShowQuestionListAndAnswerChanged);c.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(c.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.Never)};
d.onDeadlineChanged.on(this.deadlineChanged);d.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowQuestionListAndAnswer",{get:function(){return e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"neverWhenToShowQuestionListAndAnswer",{get:function(){return e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.Never]},
enumerable:!0,configurable:!0});a.prototype.getWhenToShowQuestionListAndAnswerOptionText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowQuestionListAndAnswerOptionAlternativeText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.removeAfterDeadlineSetNewValue=function(a){var b=this.whenToShowQuestionListAndAnswer;
this.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem.remove();b===e.WhenToShowQuestionListAndAnswer.AfterDeadline&&this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change()};Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return this.whenToShowResultsController.shouldHaveAfterAllAttemptsOption},enumerable:!0,configurable:!0});a.prototype.buildWhenToShowQuestionListAndAnswerList=function(a){var b=this;this.controlsProvider.$whenToShowQuestionListAndAnswerElement.empty();
$.each(this.viewModel.WhenToShowQuestionListAndAnswerOptions,function(a,c){c.Value===e.WhenToShowQuestionListAndAnswer.AfterEachAttempt?b.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides&&(1===b.externalDependenciesController.maxAttemptsAllowed?b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.AlternativeText):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text)):c.Value===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts?
b.shouldHaveAfterAllAttemptsOption&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text):c.Value===e.WhenToShowQuestionListAndAnswer.WithResults?b.whenToShowResultsController.whenToShowResult===e.WhenToShowResult.WhenTeacherDecides&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text):c.Value===e.WhenToShowQuestionListAndAnswer.AfterDeadline?b.externalDependenciesController.hasDeadline&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,
c.Text):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text)});void 0!==this.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(a)[0]?this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a.toString()).change():this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer.Never.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,
"whenToShowQuestionListAndAnswer",{get:function(){var a=this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val();return e.WhenToShowQuestionListAndAnswer[a]},enumerable:!0,configurable:!0});return a}();d.WhenToShowQuestionListAndAnswerController=a})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;window[a]=this;this.settings=c;this.summarySectionToolTipPositionSettings={my:"center top",at:"right-120 bottom+10",arrow:"bottom"};this.activationLabelToolTipPositionSettings={my:"center top",at:"center bottom+10",arrow:"bottom"};$(function(){CCL.CommonFunctions.isMobileDevice()||(b.$toolTipContent=$("#"+b.settings.Controls.ToolTip),b.toolTip=new CCL.CustomToolTip("lteToolTip",{contentContainer:b.$toolTipContent,zIndex:10},
b.settings.Css.CustomTooltipCssClasses),b.$toolTipContent.show())})}a.prototype.toggleToolTipForView=function(a,c){var b=this;if(!CCL.CommonFunctions.isMobileDevice()){var h,d,f=function(a){clearTimeout(d);clearTimeout(h);d=setTimeout(function(){b.toolTip.isTooltipOpened()&&b.toolTip.closeTooltip()},a)},k=function(a,c,g,e){clearTimeout(d);clearTimeout(h);h=setTimeout(function(){if(!b.toolTip.isTooltipOpened()){var h=c.html();b.$toolTipContent.html(h);b.toolTip.openTooltip(a,g)}},e)};a===e.LearningToolElementSettingsView.Summary&&
(c?($("."+this.settings.Css.SettingSection).on("mouseover",function(a){a=$(a.currentTarget);k(a,a.find("."+b.settings.Css.ToolTipContent),b.summarySectionToolTipPositionSettings,0)}),$("."+this.settings.Css.ExpandSettingsLink).on("mouseover",function(a){a=$(a.currentTarget);k(a,a.siblings("."+b.settings.Css.ToolTipContent),b.summarySectionToolTipPositionSettings,0)}),$("."+this.settings.Css.SettingSection).add($("."+this.settings.Css.ExpandSettingsLink)).on("mouseleave",function(){return f(0)})):
(f(0),$("."+this.settings.Css.SettingSection).add($("."+this.settings.Css.ExpandSettingsLink)).off("mouseover mouseleave")));if(a===e.LearningToolElementSettingsView.OverlayEdit&&!this.settings.IsLearningPathSubElement)if(a=$("#"+this.settings.Controls.ActivationLabel).add("#"+this.settings.Controls.ActivationIcon),c){var p=$("#"+this.settings.Controls.ActivationContainer).find("."+this.settings.Css.ToolTipContent);a.on("mouseover",function(a){return k($(a.currentTarget),p,b.activationLabelToolTipPositionSettings,
0)}).on("mouseleave",function(){return f(0)}).on("click",function(){return f(0)})}else f(0),a.off("mouseover mouseleave click")}};return a}();e.Tooltip=d})(e.Settings||(e.Settings={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.AssessmentScaleState=d;d=function(){function a(a,c){var b=this;this.onAssessmentChanged=function(a){var c=b.$assessmentItemDropDown.find("option:selected").val(),g=c===b.settings.Constants.UseScoreItemValue;b.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(b.settings.EventNames.ToggleCriteriaWeightVisibility,{show:c!==b.settings.Constants.DoNotUseAssessmentItemValue});0===b.$assessmentItemDropDown.length&&
(g=b.settings.Permissions.IsScoreUsed);b.$maxScoreFloatingSection.toggle(g);b.onMaxScoreStateChanged();b.settings.Permissions.UseGradeBook&&b.toggleTermAndCategoryPanel();if(void 0!==b.onChangeHandler&&void 0!==a)b.onChangeHandler(a)};window[a]=this;this.settings=c;$(function(){b.$assessmentItemDropDown=$("#"+b.settings.Controls.AssessmentItemDropDown);b.$maxScoreFloatingSection=$("#"+b.settings.Controls.MaxScoreFloatingSection);b.$maxScoreTextBox=$("#"+b.settings.Controls.MaxScoreTextBox);b.$assessmentRecordContainer=
$("#"+b.settings.Controls.AssessmentRecordContainer);b.$termAndCategoryContainer=$("#"+b.settings.Controls.TermAndCategoryContainer);b.$categoryDropDown=$("#"+b.settings.Controls.CategoryDropDown);b.$termDropDown=$("#"+b.settings.Controls.TermDropDown);b.settings.Permissions.UseGradeBook&&(b.addToGradeBookChekcBoxInstance=window[b.settings.ClientInstanceNames.AddToGradeBookCheckBox],b.addToGradeBookChekcBoxInstance.setOnChangeCallback(function(a,c){b.$termAndCategoryContainer.toggle(c.Checked)}));
b.$assessmentItemDropDown.on("change",function(a){return b.onAssessmentChanged(a)});if(b.$maxScoreTextBox)b.$maxScoreTextBox.on("blur input",function(){return b.onMaxScoreStateChanged()}).on("keydown",function(a){return b.onMaxScoreKeyDown(a)})})}a.prototype.onChange=function(a){this.onChangeHandler=a};a.prototype.getState=function(){var a={};a.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val(),10);a.IsScore=a.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,
10);a.MaxScore=parseInt(this.$maxScoreTextBox.val(),10);this.settings.Permissions.UseGradeBook&&(a.AddToGradeBook=this.addToGradeBookChekcBoxInstance.isChecked());this.$categoryDropDown&&(a.CategoryId=parseInt(this.$categoryDropDown.val(),10));this.$termDropDown&&(a.TermId=parseInt(this.$termDropDown.val(),10));return a};a.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};a.prototype.canUseAutoMaxScore=
function(){return this.settings.Permissions.CanUseAutoMaxScore};a.prototype.isValid=function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};a.prototype.updateMaxScore=function(a,c,g){var b=this;a&&0!==a.length?$.getJSON(this.settings.WebMethods.GetCriteriaWeightTotal,$.param({elementId:this.settings.ElementId,courseId:this.settings.CourseId,learningObjectiveIds:a,
changedCriteriaWeights:c},!0)).done(function(a){b.calculateMaxScore(0<a.criteriaWeightTotal,a.criteriaWeightTotal);g&&g()}):this.calculateMaxScore(!1,0)};a.prototype.onMaxScoreStateChanged=function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};a.prototype.calculateMaxScore=function(a,c){a?(this.$maxScoreTextBox.val((c*this.settings.NumberOfAchievementLevels).toString()),this.$maxScoreTextBox.attr("readonly",
"readonly"),this.$maxScoreTextBox.prop("title",this.settings.Terms.AutoMaxScoreMessage)):(this.$maxScoreTextBox.removeAttr("readonly"),this.$maxScoreTextBox.removeProp("title"))};a.prototype.validateScore=function(a){if(""===a)return!1;a=parseFloat(a.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(a)||a<this.settings.MaxScoreMinValue||a>this.settings.MaxScoreMaxValue?!1:!0};a.prototype.toggleTermAndCategoryPanel=function(){var a=this.$assessmentItemDropDown.find("option:selected").val()!==
this.settings.Constants.DoNotUseAssessmentItemValue;a&&this.$assessmentRecordContainer.is(":visible")||(this.$assessmentRecordContainer.toggle(a),this.addToGradeBookChekcBoxInstance.toggle(a))};a.prototype.onMaxScoreKeyDown=function(a){CCL.CommonFunctions.preventInputIncorrectCharacters(a,[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter])};return a}();e.AssessmentScale=d})(e.Controls||
(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.GroupActivityState=d;d=function(){function a(a,c){var b=this;this.peerAssessmentStateChanged=function(a,c){b.peerAssessmentEnabled=c;b.enabled=!b.settings.AtLeastOneAnswerExistsForElement&&!b.peerAssessmentEnabled};this.groupActivityCheckboxChanged=function(a){b.toggleGroupActivity();$(document).trigger(b.settings.Triggers.StateChanged,b.enabled)};window[a]=this;this.settings=c;$(function(){b.peerAssessmentEnabled=b.settings.PeerAssessmentEnabled;
b.checkBox=window[b.settings.ClientInstanceNames.CheckBoxClientInstanceName];b.$dropDown=$("#"+b.settings.Controls.DropDownId);b.$container=$("#"+b.settings.Controls.Container);b.enabled=!b.peerAssessmentEnabled&&!b.settings.AtLeastOneAnswerExistsForElement;b.toggleGroupActivity();b.checkBox.ontoggle(b.groupActivityCheckboxChanged);if(b.settings.Events.PeerAssessmentStateChanged)$(document).off(b.settings.Events.PeerAssessmentStateChanged).on(b.settings.Events.PeerAssessmentStateChanged,b.peerAssessmentStateChanged)})}
Object.defineProperty(a.prototype,"enabled",{get:function(){return this.checkBox.isChecked()&&!this.peerAssessmentEnabled&&!this.settings.AtLeastOneAnswerExistsForElement},set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$container.prop("title",a?"":this.tooltip);this.checkBox.enable(a)},enumerable:!0,configurable:!0});a.prototype.getState=function(){var a={};a.isGroupActivity=this.checkBox.isChecked();a.groupType=this.$dropDown.val();return a};Object.defineProperty(a.prototype,
"tooltip",{get:function(){return this.settings.AtLeastOneAnswerExistsForElement?this.settings.Terms.AnswersExistWarning:this.peerAssessmentEnabled?this.settings.Terms.GroupActivityDisabledWarning:""},enumerable:!0,configurable:!0});a.prototype.toggleGroupActivity=function(){this.$dropDown.toggle(this.enabled)};return a}();e.GroupActivity=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.settings=c;window[a]=this;$(function(){b.activationControl=window[b.settings.ClientInstanceNames.ActivationControl];b.settingsManager=e.Manager.getInstance();b.$saveSettingsButton=$("."+b.settings.CssClasses.SaveSettingsButton);b.attemptsControl=b.settings.VisibilitySettings.Attempts?window[b.settings.ClientInstanceNames.AttemptsControl]:null;b.resultsAndFeedbackControl=b.settings.VisibilitySettings.ResultsAndFeedback?
window[b.settings.ClientInstanceNames.ResultsAndFeedbackControl]:null;b.settings.VisibilitySettings.AnonymousSubmission&&(b.anonymousCheckBox=window[b.settings.ClientInstanceNames.AnonymousSubmissionCheckBox]);b.settings.VisibilitySettings.PlagiarismControl&&(b.plagiarismCheckBox=window[b.settings.ClientInstanceNames.PlagiarismCheckBox]);b.settings.VisibilitySettings.Mandatory&&(b.notMandatoryCheckBox=window[b.settings.ClientInstanceNames.NotMandatoryCheckBox]);b.settings.VisibilitySettings.Results&&
(b.resultsCheckBox=window[b.settings.ClientInstanceNames.ResultsCheckBox]);b.settings.VisibilitySettings.Deadline&&(b.deadlinePicker=window[b.settings.ClientInstanceNames.Deadline]);b.settings.VisibilitySettings.Homework&&(b.homeworkCheckBox=window[b.settings.ClientInstanceNames.HomeworkCheckBox]);b.settings.VisibilitySettings.PeerAssessment&&(b.peerAssessment=window[b.settings.ClientInstanceNames.PeerAssessment]);b.settings.VisibilitySettings.GroupSubmission&&(b.groupActivitySelector=window[b.settings.ClientInstanceNames.GroupActivitySelector]);
b.settings.VisibilitySettings.AssessmentScale&&(b.assessmentScaleSelector=window[b.settings.ClientInstanceNames.AssessmentScaleControl]);b.settings.VisibilitySettings.TestMode&&(b.testModeCheckBox=window[b.settings.ClientInstanceNames.TestModeCheckBox]);b.initLearningObjectivesListControl();b.initSubmissionStatusControl()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged,function(){b.settings.EventNames.ValidStateChanged&&$(document).trigger(b.settings.EventNames.ValidStateChanged,
b.validateMandatoryFields())});if(this.settings.CanUseRubric)if(this.settings.IsAddMode)$(document).on(this.settings.EventNames.RubricChanged,function(a,c){b.learningObjectiveList.syncLearningObjectives(c.loIds);b.updateMaxScore(c.loIds,c.criteriaWeights)}),$(document).on(this.settings.EventNames.UpdateMaxScore,function(a,c){b.updateMaxScore(c.loIds,c.criteriaWeights)});else $(document).on(this.settings.EventNames.LearningObjectiveChanged,function(a,c){b.updateMaxScore(c.ids);b.settingsManager.setRefreshIframeAfterSave()})}
a.prototype.validateMandatoryFields=function(){return this.settings.VisibilitySettings.AssessmentScale?this.assessmentScaleSelector.isValid():!0};a.prototype.updateMaxScore=function(a,c){var b=this;void 0===c&&(c="");this.assessmentScaleSelector.canUseAutoMaxScore()&&this.assessmentScaleSelector.updateMaxScore(a,c,function(){$(document).trigger(b.settings.EventNames.ValidStateChanged,b.validateMandatoryFields())})};a.prototype.initLearningObjectivesListControl=function(){this.learningObjectiveList||
(this.learningObjectiveList=window[this.settings.ClientInstanceNames.LearningObjectiveList])};a.prototype.initSubmissionStatusControl=function(){this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(this.$submissionStatus=$("#"+this.settings.Controls.SubmissionStatusControl),this.$submissionStatus.val()||(this.settingsManager.showFeedbackErrorMessage(this.settings.Terms.NoSubmissionStatusesFound),this.$saveSettingsButton.toggleHyperlink(!1)))};a.prototype.collectSettings=function(){var a=
{};if(this.settings.VisibilitySettings.Deadline){var c=this.deadlinePicker.getState();a.Deadline=c.DateTime;a.CloseAfterDeadline=c.CloseAfterDeadline}this.settings.VisibilitySettings.Homework&&(a.Homework=this.homeworkCheckBox.isChecked());this.settings.VisibilitySettings.AssessmentScale&&(c=this.assessmentScaleSelector.getState(),a.AssessmentScaleId=c.AssessmentScaleId,a.UseScore=c.IsScore,a.MaxScore=c.IsScore?c.MaxScore:0,a.IsAddToAssessmentRecord=c.AddToGradeBook,a.TermId=c.TermId,a.CategoryId=
c.CategoryId);this.settings.VisibilitySettings.PeerAssessment&&this.peerAssessment.activated&&0<this.peerAssessment.peersToAssessCount&&(a.PeersToAssessCount=this.peerAssessment.peersToAssessCount.toString());this.settings.VisibilitySettings.TestMode&&(a.TestMode=this.testModeCheckBox.isChecked());this.settings.VisibilitySettings.Attempts&&(a.AttemptsState=this.attemptsControl.getState(),a.NotificationData=$.extend(a.NotificationData,{whichAttemptCountsChanged:a.AttemptsState.WhichAttemptCountsChanged}));
this.settings.VisibilitySettings.ResultsAndFeedback&&(a.ResultsAndFeedbackState=this.resultsAndFeedbackControl.getState(),a.NotificationData=$.extend(a.NotificationData,{showResultsToParticipantChanged:a.ResultsAndFeedbackState.WhenToShowResultsChanged}));this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(a.SubmissionStatusId=parseInt(this.$submissionStatus.val(),10));this.settings.VisibilitySettings.GroupSubmission&&(c=this.groupActivitySelector.getState(),a.IsGroupActivity=c.isGroupActivity,
a.SubmissionGroupType=c.groupType);this.settings.VisibilitySettings.AnonymousSubmission&&(a.IsAnonymous=this.anonymousCheckBox.isChecked());this.settings.VisibilitySettings.PlagiarismControl&&(a.IsCheckPlagiarism=this.plagiarismCheckBox.isChecked());this.settings.VisibilitySettings.Mandatory&&(a.IsNotMandatory=this.notMandatoryCheckBox.isChecked());this.activationControl&&(c=this.activationControl.getActivationTimeSpanState(),a.Active=c.isActive,a.UseActivationTimespan=c.useActivationTimeSpan,a.UseActivationTimespan&&
(a.ActivationTimespanFrom=c.fromState.dateAsString,a.ActivationTimespanTo=c.toState.dateAsString));this.settings.VisibilitySettings.LearningObjectiveListDialog&&(a.LearningObjectivesIds=this.learningObjectiveList.getLearningObjectiveIds());this.settings.VisibilitySettings.Results&&(a.IsAssessmentVisible=this.resultsCheckBox.isChecked());return a};a.prototype.validateControls=function(){return this.activationControl?this.activationControl.validateControl():!0};return a}();e.Edit=d})(e.Settings||(e.Settings=
{}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(a){a[a.Hidden=0]="Hidden";a[a.Summary=1]="Summary";a[a.Read=2]="Read";a[a.OverlayEdit=3]="OverlayEdit"})(e.LearningToolElementSettingsView||(e.LearningToolElementSettingsView={}));var d=e.LearningToolElementSettingsView;(function(){return function(){}})();var a=function(){function a(b){var c=this;this.viewAttributesMap={};window[a.clientInstanceName]=this;this.settings=b;$(function(){c.$body=$("body");c.$mainContainer=$("#"+c.settings.Controls.MainContainer);
c.$contentFrameContainer=$("#"+c.settings.Controls.ContentFrame);c.$settingsControlContainer=$("#"+c.settings.Controls.SettingsControl);c.$editSettingsContainer=$("#"+c.settings.Controls.EditSettingsContainer);c.$readSettingsContainer=$("#"+c.settings.Controls.ReadSettingsContainer);c.$background=$("#"+c.settings.Controls.Background);c.settings.IsAddMode||(c.iframe=c.$contentFrameContainer.get(0).contentWindow);c.viewAttributesMap=(a={},a[d.Hidden]={isDirty:!0,cssClass:c.settings.CssClasses.Views.Hidden},
a[d.Summary]={$container:c.$readSettingsContainer,isDirty:!1,cssClass:c.settings.CssClasses.Views.Summary,loadViewUrl:c.settings.Urls.ReadSettings,afterLoadFunction:c.afterLoadSummarySettings},a[d.Read]={$container:c.$readSettingsContainer,isDirty:!0,cssClass:c.settings.CssClasses.Views.OverlayRead,loadViewUrl:c.settings.Urls.ReadSettings,afterLoadFunction:c.afterLoadReadSettings},a[d.OverlayEdit]={$container:c.$editSettingsContainer,isDirty:!0,cssClass:c.settings.CssClasses.Views.OverlayEdit,loadViewUrl:c.settings.Urls.EditSettings,
afterLoadFunction:c.afterLoadEditSettings},a);c.attachEventListeners();c.tooltip=window[c.settings.ClientInstanceNames.SettingsTooltip];c.editFocusTracker=new CCL.FocusTracker(c.$editSettingsContainer);c.switchView(c.settings.IsAddMode?d.OverlayEdit:d.Read);var a})}a.getInstance=function(){return window[a.clientInstanceName]};a.prototype.afterLoadSummarySettings=function(){this.stopTrackingFocus();this.$readSettingsContainer.find("."+this.settings.CssClasses.SectionHeaderIconLink).attr("tabindex",
0)};a.prototype.afterLoadReadSettings=function(){this.stopTrackingFocus();this.setFocusAndHighlight();this.$readSettingsContainer.find("."+this.settings.CssClasses.SectionHeaderIconLink).removeAttr("tabindex")};a.prototype.refreshExtensionFrame=function(){this.iframe&&CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.studentWasAssessed))};a.prototype.notifyExtensionSettingsUpdated=function(a){this.iframe&&(a?CCL.CommonFunctions.makePostMessageCallWithData(this.iframe,
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged),a):CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged)))};a.prototype.refreshTreeMenu=function(){var a=top;a&&a.reloadFolder&&!this.settings.IsLearningPathSubElement&&a.reloadFolder()};a.prototype.refreshPageFunctionsMenu=function(a){window[this.settings.ClientInstanceNames.ViewLearningToolElementPage].changePageFunctionsState(a)};
a.prototype.showFeedbackErrorMessage=function(a,b){void 0===b&&(b=!1);CCL.ErrorFeedback.showFeedback(this.$settingsControlContainer,a,null,b)};a.prototype.hideFeedback=function(){CCL.ErrorFeedback.hideFeedback(this.$settingsControlContainer)};a.prototype.setRefreshIframeAfterSave=function(){this.settings.NeedRefreshIframeAfterSave=!0};a.prototype.attachEventListeners=function(){var a=this,b=$(window);CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.extensionContentChanged,
function(b){b.expandRead?a.switchView(d.Read,!0):a.switchView(a.currentView,!0)});CCL.CommonFunctions.attachPostMessageEventListener(b,[CCL.CommonWindowMessages.MessageNames.hideSettings,CCL.CommonWindowMessages.MessageNames.enableFullScreen],function(){a.switchView(d.Hidden)});CCL.CommonFunctions.attachPostMessageEventListener(b,[CCL.CommonWindowMessages.MessageNames.showSettings,CCL.CommonWindowMessages.MessageNames.disableFullScreen],function(b){a.currentView===d.Hidden&&a.switchView(a.previousView,
!0)});CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.reloadParentIframe,function(){window.location.reload(!0)});this.$body.on("click","."+this.settings.CssClasses.ChangeOptionsLink,function(){a.switchView(d.OverlayEdit,!0);return!1}).on("click","."+this.settings.CssClasses.SaveSettingsButton,function(){a.$saveSettingsButton.getIfHyperLinkEnabled()&&a.save();return!1}).on("click","."+this.settings.CssClasses.SettingsDialogExpandButton,function(){a.isMobileView()||
a.switchView(d.Read)}).on("click","."+this.settings.CssClasses.Views.Summary+" ."+this.settings.CssClasses.SectionHeaderIconLink,function(b){a.onSummaryIconClick($(b.currentTarget))}).on("keypress","."+this.settings.CssClasses.Views.Summary+" ."+this.settings.CssClasses.SectionHeaderIconLink,function(b){if(b.which===CCL.CommonConstants.keyCodes.enter)a.onSummaryIconClick($(b.currentTarget))}).on("click","."+this.settings.CssClasses.ShowMoreOptionsLink,function(){a.toggleMobileOptions(!a.isMobileOptionsExpanded())}).on("keyup",
function(b){switch(b.which){case CCL.CommonConstants.keyCodes.escape:a.currentView!==d.Read&&a.currentView!==d.OverlayEdit||a.cancelButtonClick()}});if(!this.settings.IsAddMode)this.$body.on("click","."+this.settings.CssClasses.CancelEditSettingsButton,function(){return a.cancelButtonClick()}).on("click","."+this.settings.CssClasses.SettingsDialogCollapseButton,function(){a.switchView(d.Summary)});this.$background.click(function(){a.hideFeedback();a.cancelButtonClick()})};a.prototype.onSummaryIconClick=
function(a){this.isMobileView()||(a=parseInt(a.closest("."+this.settings.CssClasses.SettingSection).data(this.settings.LearningToolElementSettingTypeDataAttribute),10),this.switchToExpandedView(a))};a.prototype.afterLoadEditSettings=function(){this.$saveSettingsButton=$("."+this.settings.CssClasses.SaveSettingsButton);this.$cancelEdittingSettingsButton=$("."+this.settings.CssClasses.CancelEditSettingsButton);this.stopTrackingFocus();this.settings.IsAddMode||this.editFocusTracker.startTrackFocus();
this.setFocusAndHighlight()};a.prototype.setFocusAndHighlight=function(){var a=this;setTimeout(function(){var b=a.viewAttributesMap[a.currentView].$container.find("."+a.settings.CssClasses.SettingSection);b.removeClass(a.settings.CssClasses.SettingsSectionHighlight);b=a.getSectionToHighlight(b);a.controlToHighlight=0;if(b){b.addClass(a.settings.CssClasses.SettingsSectionHighlight);var c=a.getFirstElementToFocusInContainer(b)}else a.settings.IsAddMode||(c=a.getFirstElementToFocusInContainer(a.getViewContainer(a.currentView)));
a.scrollToElementIfNeed(b).done(function(){c&&!c.prop("disabled")&&c.focus()})},1)};a.prototype.getFirstElementToFocusInContainer=function(a){return a.find("input, a, select").first()};a.prototype.getSectionToHighlight=function(a){var b=this,c=void 0;$.each(a,function(a,g){a=$(g);return b.controlToHighlight===parseInt(a.data(b.settings.LearningToolElementSettingTypeDataAttribute),10)?(c=a,!1):!0});return c};a.prototype.hideAllViews=function(){this.$editSettingsContainer.hide();this.$readSettingsContainer.hide()};
a.prototype.showOverlayDialogIfNeeds=function(a){this.$background.toggle(a===d.OverlayEdit)};a.prototype.switchView=function(a,b){var c=this;void 0===b&&(b=!1);if(a!==this.currentView||b){this.tooltip.toggleToolTipForView(this.currentView,!1);var g=this.viewAttributesMap[a];b&&(g.isDirty=!0);g.isDirty&&g.loadViewUrl?$.get(g.loadViewUrl).done(function(b){g.$container.html(b);c.refreshViewUi(a,g);c.tooltip.toggleToolTipForView(c.currentView,!0)}).fail(function(){c.alertError()}):(this.refreshViewUi(a,
g),this.tooltip.toggleToolTipForView(this.currentView,!0))}};a.prototype.switchToExpandedView=function(a){this.controlToHighlight=isNaN(a)?0:a;this.switchView(this.settings.CanEdit?d.OverlayEdit:d.Read,this.settings.CanEdit)};a.prototype.alertError=function(a){void 0===a&&(a="");CCL.CommonFunctions.jAlertAjaxError(a?a:this.settings.Terms.SomethingWentWrong,this.settings.Terms.ErrorOccured,this.settings.Terms.Ok,!1)};a.prototype.refreshViewUi=function(a,b){this.$mainContainer.removeClass().addClass(b.cssClass);
this.previousView=this.currentView;this.currentView=a;this.hideAllViews();this.showOverlayDialogIfNeeds(a);(this.afterLoadFunction=b.afterLoadFunction)&&this.afterLoadFunction();this.toggleMobileOptions(this.isMobileOptionsExpanded());b.isDirty=!1;b.$container.show();a=0<this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.ShowOnlyIfMobileOptionsExpanded).length;this.getShowMoreLinkForCurrentView().toggle(a)};a.prototype.enableSaveCancelButtons=function(a){this.$cancelEdittingSettingsButton.toggleHyperlink(a);
this.$saveSettingsButton.toggleHyperlink(a);this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].lockSaveButton(!a)};a.prototype.cancelButtonClick=function(){this.settings.IsAddMode||(this.hideFeedback(),this.switchView(this.getViewToSwitchBack()));return!1};a.prototype.isMobileView=function(){return $(window).width()<=CCL.CommonConstants.mediaScreenSizes.iPadPortraitMode};a.prototype.getViewToSwitchBack=function(){switch(this.currentView){case d.Read:return d.Summary;
case d.OverlayEdit:return this.isMobileView()?d.Read:this.previousView;default:throw"Unsupported view transition";}};a.prototype.save=function(){var a=this;this.hideFeedback();this.enableSaveCancelButtons(!1);var b=this.collectContentAndSettings();window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName].validateControls()?$.post(this.settings.Urls.SaveSettings,b).done(function(c){c.Success?a.settings.IsAddMode?c.ClientScriptToCompleteSaving?eval(c.ClientScriptToCompleteSaving):c.PageUrlToRedirect&&
window.location.replace(c.PageUrlToRedirect):(a.switchView(a.getViewToSwitchBack(),!0),a.settings.NeedRefreshIframeAfterSave&&a.refreshExtensionFrame(),a.settings.SettingsUpdateNotification&&a.notifyExtensionSettingsUpdated(b.Settings.NotificationData),a.refreshTreeMenu(),a.refreshPageFunctionsMenu(c.EnableElementActivationPageFeatures)):(a.showFeedbackErrorMessage(c.Errors.join("<br />"),!0),a.enableSaveCancelButtons(!0))}).fail(function(){a.alertError();a.enableSaveCancelButtons(!0)}):(this.enableSaveCancelButtons(!0),
this.showFeedbackErrorMessage(this.settings.Terms.YourInputIsInvalid,!0),this.scrollToElementIfNeed($("."+this.settings.CssClasses.InvalidInput+":first")))};a.prototype.collectContentAndSettings=function(){var a=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName],b={};b.ElementId=this.settings.ElementId;b.IsAddMode=this.settings.IsAddMode;b.Settings=a.collectSettings();this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&(b.Content=window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].collectContent());
return b};a.prototype.toggleMobileOptions=function(a){var b=a?this.settings.Terms.ShowLess:this.settings.Terms.ShowMore;this.getShowMoreLinkForCurrentView().children("span").text(b);this.getViewContainer(this.currentView).toggleClass(this.settings.CssClasses.ExpandMobileOptions,a)};a.prototype.isMobileOptionsExpanded=function(){return this.getViewContainer(this.currentView).hasClass(this.settings.CssClasses.ExpandMobileOptions)};a.prototype.getShowMoreLinkForCurrentView=function(){return this.getViewContainer(this.currentView).find("."+
this.settings.CssClasses.ShowMoreOptionsLink)};a.prototype.getViewContainer=function(a){return this.viewAttributesMap[a].$container};a.prototype.stopTrackingFocus=function(){this.editFocusTracker.stopTrackFocus()};a.prototype.scrollToElementIfNeed=function(a){if(!a)return $.when();if(this.settings.IsAddMode)return CCL.CommonFunctions.isElementFullyShownInWindow(a)||window.scrollTo(a.offset().top,0),$.when();var b=this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.OverlayDialogInnerContainer);
return CCL.CommonFunctions.isElementFullyShownInContainer(a,b)?$.when():b.animate({scrollTop:a.offset().top},500).promise()};a.prototype.refreshReadView=function(){this.switchView(this.currentView,!0)};a.clientInstanceName="LearningToolElementSettingsManager";return a}();e.Manager=a})(e.Settings||(e.Settings={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){}}();e.ManageLearnerDefinedGroupState=f;f=function(){function d(a,b){var c=this;this.renderItem=function(a,b){return $("<li>").append(b.metadata?'<a>\n                            <img alt="" class="'+c.settings.CssClasses.AutoCompleteItem.Image+'" src="'+b.metadata.ImageUrl+'" />\n                            <span class="'+c.settings.CssClasses.AutoCompleteItem.Info+'">\n                                <span>'+b.label+"</span>\n                                "+
(""!==b.metadata.Organization?'<span class="'+c.settings.CssClasses.AutoCompleteItem.Organization+'">'+b.metadata.Organization+"</span>":"")+"\n                            </span>\n                       </a>":'<span class="'+c.settings.CssClasses.AutoCompleteItem.NoMatches+'">'+c.settings.Terms.NoMatches+"</span>").addClass(c.settings.CssClasses.AutoCompleteItem.Item).appendTo(a)};this.participantsAutocomplete=function(a,b){c.participantsAutocompleteRequest&&c.participantsAutocompleteRequest.abort&&
c.participantsAutocompleteRequest.abort();var g=c.getAddedPersonIds();c.participantsAutocompleteRequest=$.get(c.settings.WebMethods.FindParticipants,$.param({elementId:c.settings.ElementId,courseId:c.settings.CourseId,collaborationId:c.settings.CollaborationId,search:a.term},!0),void 0,"jsonp").done(function(a){a=a.filter(function(a){return 0===g.filter(function(b){return b===a.PersonId}).length});a.length?b($.map(a,function(a){return{label:a.Name,value:a.Name,metadata:a}})):b([{value:b.term}])}).always(function(){c.participantsAutocompleteRequest=
void 0})};this.onRemoveClick=function(a){$(a.target).closest("."+c.settings.CssClasses.GroupList.UserContainer).remove()};window[a]=this;this.settings=b;this.$membersContainer=$("#"+this.settings.Controls.MembersContainerId);this.$groupContentContainer=$("#"+this.settings.Controls.GroupContentContainerClientId);$(function(){c.addPerson(c.settings.CurrentPerson,!0);c.settings.GroupMembers&&c.settings.GroupMembers.length&&c.settings.GroupMembers.forEach(function(a){c.addPerson(a,!1)})});$(document).on(this.settings.Events.OnSelectUser,
function(a,b){b&&(a={},a.Name=b.Name,a.ImageUrl=b.ImageUrl,a.PersonId=b.PersonId,c.addPerson(a,!1))});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.submitIframe,function(){CCL.CommonFunctions.makePostMessageCallWithData(window.parent,new CCL.CommonWindowMessages.GenericMessage(c.settings.Events.SubmitForm),{PersonIds:c.getAddedPersonIds()})})}d.prototype.addPerson=function(a,b){this.$membersContainer.append(this.getPersonHtml(a,b))};d.prototype.getPersonHtml=
function(a,b){var c=$('<div class="'+this.settings.CssClasses.GroupList.UserContainer+'"></div>'),g=$('<div class="'+this.settings.CssClasses.GroupList.ImageContainer+'"><img alt="" src="'+a.ImageUrl+'" class="'+this.settings.CssClasses.GroupList.Image+'" /></div>'),h=$('<div class="'+this.settings.CssClasses.GroupList.NameContainer+'"><span>'+a.Name+"</span></div>");c.data("meta",a).append(g).append(h);a=$('<div class="'+this.settings.CssClasses.GroupList.RemoveLinkContainer+'"></div>');b||(b=$('<a href="#">&times;</a>'),
b.click(this.onRemoveClick),a.append(b));c.append(a);return c};d.prototype.getAddedPersonInfos=function(){return $.makeArray(this.$membersContainer.find("div."+this.settings.CssClasses.GroupList.UserContainer).map(function(a,b){return $(b).data("meta")}))};d.prototype.getAddedPersonIds=function(){return this.getAddedPersonInfos().map(function(a){return a.PersonId})};return d}();e.ManageLearnerDefinedGroup=f})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b,c){var g=this;this.settings=a;this.controls=b;this.afterAttachElements=c;this.onAddResourceMenuItemLinkClick=function(a){parseInt($(a.currentTarget).data(g.settings.dataAttributes.ElementExternalSource),10)===f.AddResourceMenu.ElementExternalSourceType.Course&&g.addFromCourse()};this.currentElementStates=new Map;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.loadElementStates()}d.prototype.removeElement=function(a){var b=
this.currentElementStates.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.currentElementStates.set(a,b);this.saveElementStates()};d.prototype.addFromCourse=function(){var a=this,b={locationId:this.settings.locationId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course},c={elementStates:f.MapUtils.makeCopy(this.currentElementStates),elementType:f.ElementLinkDialog.ContentElementType.All,header:this.settings.terms.addResourceDialogTitle,afterOkClickCallback:function(b){if(b){var c=
[];a.currentElementStates=f.MapUtils.makeCopy(b);b.forEach(function(b,g){a.checkboxStateMachine.isElementChecked(b)&&c.push(g)});a.saveElementStates();0<c.length&&a.afterAttachElements(c)}},showAll:!1,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.CalendarEvent,relatedEntityId:this.settings.eventId};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,b)};d.prototype.loadElementStates=function(){var a=this.controls.elementIdsWithStatesHidden.val();0<this.controls.elementIdsWithStatesHidden.length&&
a&&(this.currentElementStates=f.MapUtils.jsonStringToMap(a,f.MapUtils.numberKeyConverter))};d.prototype.saveElementStates=function(){this.controls.elementIdsWithStatesHidden.val(f.MapUtils.mapToJsonString(this.currentElementStates)).trigger("change")};return d}();e.EditEventElementLinkManager=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.settings=b;this.$saveButton=$("#"+this.settings.Controls.GroupDialogOkButton);this.$cancelButton=$("#"+this.settings.Controls.GroupDialogCancelButton);this.$learnerDefinedGroupLink=$("#"+this.settings.Controls.GroupLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.$withdrawLink=$("#"+this.settings.Controls.WithdrawLink);this.manageGroupDalog=
window[this.settings.Controls.ManageGroupDialog];this.settingManager=e.Settings.Manager.getInstance();$(function(){CCL.CommonFunctions.attachPostMessageEventListener($(window),c.settings.Events.SubmitForm,function(a){$.post(c.settings.WebMethods.CreateCollaborationBasedOnLearnerDefinedGroup,$.param({elementId:c.settings.ElementId,personIds:a.PersonIds},!0)).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});c.manageGroupDalog.setCustomScripts({afterOpenDialog:function(){setTimeout(function(){$("."+
c.settings.Css.ExpandedExtensionIframe).addClass(c.settings.Css.ExpandedExtensionIframeStackedUnderSettings)},100)},beforeCloseDialog:function(){$("."+c.settings.Css.ExpandedExtensionIframe).removeClass(c.settings.Css.ExpandedExtensionIframeStackedUnderSettings)}});c.$submitIndividuallyLink.on("click",function(){$.post(c.settings.WebMethods.UseIndividualSubmission,{elementId:c.settings.ElementId}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});
c.$learnerDefinedGroupLink.on("click",function(){c.manageGroupDalog.openDialog(!1)});c.$withdrawLink.on("click",function(){c.settings.IsIndividualSubmission?c.withdrawFromGroup():CCL.CommonFunctions.jAjaxConfirm(c.settings.Terms.WithdrawConfirmation,c.settings.Terms.ConfirmTitle,c.settings.Terms.Yes,c.settings.Terms.No,function(a){a&&c.withdrawFromGroup()})});c.$saveButton.on("click",function(){c.saveGroup()&&CssModal.closeDialog()});c.$cancelButton.on("click",function(){CssModal.closeDialog()})})}
a.prototype.saveGroup=function(){this.$saveButton.toggleHyperlink(!1);var a=$("#"+this.settings.Controls.ManageGroupDialog).find("iframe").get(0).contentWindow;CCL.CommonFunctions.makePostMessageCall(a,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe));return!0};a.prototype.withdrawFromGroup=function(){var a=this;$.post(this.settings.WebMethods.WithdrawFromLearnerDefinedGroup,{elementId:this.settings.ElementId}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()})};
a.prototype.processResponse=function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();d.LearnerDefinedGroups=a})(f.Collaboration||(f.Collaboration={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,b,h,d,e){this._isActive=a;this._useTimeSpan=b;this._timeZoneOffsetInSeconds=h;this._incorrectFormatTerm=d;this._dateShouldBeSetTerm=e}Object.defineProperty(a.prototype,"isActive",{get:function(){return this._isActive},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"useActivationTimeSpan",{get:function(){return this._useTimeSpan},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromDateTime",{get:function(){return this.fromState.date},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toDateTime",{get:function(){return this.toState.date},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isValid",{get:function(){if(!this.useActivationTimeSpan)return!0;var a=this.validationErrors;return 0===a.fromValidationError.length&&0===a.toValidationError.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromNow",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&
void 0==this.fromDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toInfinity",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&void 0==this.toDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"validationErrors",{get:function(){var a={fromValidationError:"",toValidationError:""};if(!this.useActivationTimeSpan)return a;this.fromState.isValid||(a.fromValidationError=this._incorrectFormatTerm);this.toState.isValid||(a.toValidationError=
this._incorrectFormatTerm);if(0<a.fromValidationError.length||0<a.toValidationError.length)return a;!this.toInfinity&&this.fromNow&&(a.fromValidationError=this._dateShouldBeSetTerm);return a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isActiveAccordingToTimeSpan",{get:function(){if(!this.useActivationTimeSpan)return this.isActive;var a=CCL.DateFunctions.getItslNow(this._timeZoneOffsetInSeconds);return this.fromNow&&this.toInfinity?!0:this.fromNow?this.isFirstLessThanSecond(a,
this.toDateTime):this.toInfinity?this.isFirstLessThanSecond(this.fromDateTime,a):this.isFirstLessThanSecond(this.fromDateTime,a)&&this.isFirstLessThanSecond(a,this.toDateTime)},enumerable:!0,configurable:!0});a.prototype.isFirstLessThanSecond=function(a,b){if(a&&b)return a<b};return a}();e.ActivationTimeSpanState=d;var a=function(){function a(a,b){var c=this;window[a]=this;this.settings=b;this.isElementActiveNow=this.settings.IsActive;this.useTimespan=this.settings.UseActivationTimespan;$(function(){c.fillJQueryElements();
c.fromDateTimePickerInstance=window[c.settings.ClientInstances.FromDateTimePickerClientInstanceName];c.toDateTimePickerInstance=window[c.settings.ClientInstances.ToDateTimePickerClientInstanceName];c.$activationLink.add(c.$activationLabel).click(function(){c.useTimespan&&(c.useTimespan=!1);c.isElementActiveNow=!c.isElementActiveNow;c.updateControlState()});c.$toggleTimespanLink.click(function(){c.useTimespan=!c.useTimespan;c.updateControlState()});c.updateControlState();$(c.fromDateTimePickerInstance).add($(c.toDateTimePickerInstance)).change(function(){return c.updateControlState()})})}
a.prototype.getActivationTimeSpanState=function(){var a=new d(this.isElementActiveNow,this.useTimespan,this.settings.TimeZoneOffsetInSeconds,this.settings.Terms.DateMustBeOnTheFormatX,this.settings.Terms.PleaseEnterDate);a.useActivationTimeSpan&&(a.fromState=this.fromDateTimePickerInstance.getDateTimePickerState(),a.toState=this.toDateTimePickerInstance.getDateTimePickerState());return a};a.prototype.validateControl=function(){var a=this.getActivationTimeSpanState(),b=a.validationErrors,h={isInvalid:b.toValidationError&&
0<b.toValidationError.length,errorMessage:b.toValidationError,highlightInput:!0};this.fromDateTimePickerInstance.toggleValidationError({isInvalid:b.fromValidationError&&0<b.fromValidationError.length,errorMessage:b.fromValidationError,highlightInput:!0});this.toDateTimePickerInstance.toggleValidationError(h);return a.isValid};a.prototype.isStringNullOrEmpty=function(a){return!a||0===a.length};a.prototype.fillJQueryElements=function(){this.$textAndIconContainer=$("#"+this.settings.Controls.TextAndIconContainer);
this.$activationLink=$("#"+this.settings.Controls.ActivationLink);this.$activationImage=this.$activationLink.find("img");this.$activationLabel=$("#"+this.settings.Controls.ActivationLabel);this.$toggleTimespanLink=$("#"+this.settings.Controls.ToggleTimespanLink);this.$timespanContainer=$("#"+this.settings.Controls.TimespanContainer);this.$fromDateInput=$("#"+this.settings.Controls.FromDateInput);this.$fromHoursDropDown=$("#"+this.settings.Controls.FromHoursDropDown);this.$fromMinutesDropDown=$("#"+
this.settings.Controls.FromMinutesDropDown);this.$toDateInput=$("#"+this.settings.Controls.ToDateInput);this.$toHoursDropDown=$("#"+this.settings.Controls.ToHoursDropDown);this.$toMinutesDropDown=$("#"+this.settings.Controls.ToMinutesDropDown)};a.prototype.updateControlState=function(){var a=this.getActivationTimeSpanState();a.useActivationTimeSpan&&(a=a.isActiveAccordingToTimeSpan,void 0!=a&&(this.isElementActiveNow=a));this.$timespanContainer.toggle(this.useTimespan);this.$toggleTimespanLink.toggleClass(this.settings.Css.AddLink,
!this.useTimespan).toggleClass(this.settings.Css.RemoveLink,this.useTimespan);this.$toggleTimespanLink.find("span").text(this.useTimespan?this.settings.Terms.RemoveScheduledVisibility:this.settings.Terms.AddScheduledVisibility);this.$activationLabel.html(this.isElementActiveNow?this.settings.Terms.ResourceIsVisible:this.settings.Terms.ResourceIsNotVisible);this.$activationImage.attr("src",this.isElementActiveNow?this.settings.Images.Active:this.settings.Images.Inactive);this.$textAndIconContainer.find("."+
this.settings.Css.TooltipHeader).html(this.isElementActiveNow?this.settings.Terms.ClickToMakeInvisible:this.settings.Terms.ClickToMakeVisible)};return a}();e.Activation=a})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;this.$toggle=$("#"+b.Controls.CompletedToggle);this.$simpleStatusSelector=$("#"+b.Controls.SimpleStatusSelector);if(0<this.$toggle.length||0<this.$simpleStatusSelector.length){this.$score=$("#"+b.Controls.Score);this.$assessment=$("#"+b.Controls.Assessment);var g=$("#"+b.Controls.CompletedToggleLabel),h=$("#"+b.Controls.AssessmentLabel+", #"+b.Controls.ScoreLabel);this.$toggle.on(b.ToggleStateChangedEventName,
function(a,c){a=window[c.toggleInstanceId];a.isChecked()?g.html(b.Terms.CompletedToggleOn):g.html(b.Terms.CompletedToggleOff);h.toggleClass(b.CssClasses.MandatoryMark,a.isChecked())});this.settings.IsAssessmentMandatoryForCompletedStatus&&(this.$score.add(this.$simpleStatusSelector).change(function(){h.toggleClass(b.CssClasses.MandatoryMark,c.isAsessmentMissingForCompleted())}),this.$assessment.on("autocompletechange",function(){h.toggleClass(b.CssClasses.MandatoryMark,c.isAsessmentMissingForCompleted())}))}this.rubricToggleChangeValue=
b.RubricToggleChangeValue;this.$criteriaAssessmentToggle=$("#"+this.settings.Controls.CriteriaAssessment);this.$rubricCriteriaList=$("#"+this.settings.Controls.RubricCriteriaList);this.$criteriaAssessmentToggle.change(function(){return c.toggleCriteriaAssessmentList()})}d.prototype.toggleCriteriaAssessmentList=function(){var a=this.$criteriaAssessmentToggle.val()===this.rubricToggleChangeValue;this.$rubricCriteriaList.toggleClass(this.settings.CssClasses.Hidden,!a)};d.prototype.isAsessmentMissingForCompleted=
function(){return(this.$toggle.is(":checked")||this.$simpleStatusSelector.val()===this.settings.SimpleStatusSelectorCompletedValue)&&(this.$assessment.val()===this.settings.NotAssessedValue||""===this.$score.val())};d.prototype.validateAssessmentForCompleted=function(a,b){b.IsValid=!this.isAsessmentMissingForCompleted()};return d}();e.ActivityMultipleAssessment=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.synchronize(a)}Object.defineProperty(d.prototype,"currentClientTime",{get:function(){return(new Date).getTime()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"clientDeltaTime",{get:function(){return this.currentClientTime-this.clientFixedTime},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentServerTime",{get:function(){return new Date(this.serverFixedTime+this.clientDeltaTime)},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"currentServerTimeWithoutSeconds",{get:function(){var a=this.currentServerTime;a.setSeconds(0);a.setMilliseconds(0);return a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSynchronizeNeeded",{get:function(){return 3E5<this.clientDeltaTime},enumerable:!0,configurable:!0});d.prototype.synchronize=function(a){this.serverFixedTime=a.getTime();this.clientFixedTime=this.currentClientTime};return d}();e.DateTimeSynchronizer=f})(f.Controls||
(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.msInDay=864E5;window[a]=this;this.settings=b;this.datePeriod=this.settings.DatePeriod;this.startDate=$.datepicker.parseDate(this.settings.DateFormat,this.settings.StartDate);this.setEndDate();this.weekNumber=this.settings.WeekNumber;this.dayNames=this.settings.DayNames;$(function(){c.$prevButton=$("#"+c.settings.ClientIds.PrevButton);c.$nextButton=$("#"+c.settings.ClientIds.NextButton);c.$dateShortLabel=$("#"+c.settings.ClientIds.DateShortLabel);
c.$datePrefixLabel=$("#"+c.settings.ClientIds.DatePrefixLabel);c.$prevButton.click(function(){return c.goToPreviousPeriod()});c.$nextButton.click(function(){return c.goToNextPeriod()});c.triggerPeriodChangedEvent()})}d.prototype.toggleNavigationButtons=function(a){this.$prevButton.toggleHyperlink(a);this.$nextButton.toggleHyperlink(a)};d.prototype.changeDatePeriod=function(a){this.startDate=$.datepicker.parseDate(this.settings.DateFormat,a);this.setEndDate();this.setWeekNumber();this.updateTitleLabel();
this.triggerPeriodChangedEvent()};d.prototype.toggleWeekDayMode=function(a,b){this.datePeriod=a;switch(this.datePeriod){case e.DatePeriod.Day:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousDay);this.$nextButton.prop("title",this.settings.Terms.GoToTheNextDay);break;case e.DatePeriod.Week:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousWeek),this.$nextButton.prop("title",this.settings.Terms.GoToTheNextWeek)}this.changeDatePeriod(b)};d.prototype.goToPreviousPeriod=
function(){this.$prevButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(-this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent())};d.prototype.goToNextPeriod=function(){this.$nextButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent())};d.prototype.setNewPeriodDates=function(a){this.startDate&&(this.startDate=new Date(this.startDate.getTime()+a*this.msInDay),this.setEndDate(),
this.setWeekNumber())};d.prototype.setEndDate=function(){this.endDate=new Date(this.startDate.getTime()+(this.getNumberOfDaysInPeriod()-1)*this.msInDay);this.endDate.setHours(23);this.endDate.setMinutes(59)};d.prototype.setWeekNumber=function(){this.weekNumber=$.datepicker.iso8601Week(this.startDate)};d.prototype.triggerPeriodChangedEvent=function(){$(this).trigger(d.periodChangedEventName,{startDate:this.getStartDate(),endDate:this.getEndDate()})};d.prototype.updateTitleLabel=function(){var a=this.settings.ShowWeekNumber?
String.format(this.settings.Terms.WeekNumberTemplate,this.weekNumber.toString()):"",b=$.datepicker.formatDate(this.settings.DateFormat,this.startDate),c=$.datepicker.formatDate(this.settings.DateFormat,this.endDate);this.$datePrefixLabel.toggle(this.datePeriod===e.DatePeriod.Day||this.settings.ShowWeekNumber);switch(this.datePeriod){case e.DatePeriod.Day:this.$datePrefixLabel.text(this.dayNames[this.startDate.getDay()]);this.$dateShortLabel.text(b);break;case e.DatePeriod.Week:this.$datePrefixLabel.text(a);
this.$dateShortLabel.text(b+" - "+c);break;default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};d.prototype.getNumberOfDaysInPeriod=function(){switch(this.datePeriod){case e.DatePeriod.Day:return 1;case e.DatePeriod.Week:return 7;default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};d.prototype.getDateTimeAsString=function(a){return a?$.datepicker.formatDate(this.settings.DateFormat,a)+" "+e.DateTimePicker.getNumberAsTwoCharString(a.getHours())+":"+
e.DateTimePicker.getNumberAsTwoCharString(a.getMinutes()):""};d.prototype.getStartDate=function(){return this.getDateTimeAsString(this.startDate)};d.prototype.getEndDate=function(){return this.getDateTimeAsString(this.endDate)};d.periodChangedEventName="datePeriodSelector:periodChanged";return d}();e.DatePeriodSelector=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c,g,h){d.call(this,a,c,g,h)}__extends(a,d);a.prototype.getParams=function(a){var b=a.attr("data-date");a=a.parent().parent().attr("data-kpi-m-id");return{Date:b,MeasurementId:a}};a.prototype.paramsAreEqual=function(a,c){return null==a?!1:a.Date===c.Date&&a.MeasurementId===c.MeasurementId};a.prototype.formatUrlParams=function(a){return{date:a.Date,measurementid:a.MeasurementId}};return a}(e.BaseDetailedInfo);e.FeatureAdoptionDetailedInfo=f})(f.Controls||
(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;$(function(){c.$dataHidden=$("#"+c.settings.Controls.DataHidden);c.$listContainer=$("#"+c.settings.Controls.ListContainer);c.$orderChangedHidden=$("#"+c.settings.Controls.OrderChangedHidden);c.$listContainer.on("click","."+c.settings.Css.RemoveLink,function(a){a=$(a.currentTarget).closest("li");a=parseInt(a.data("id"),10);c.deleteElement(a)})})}d.prototype.getElementIds=function(){var a=this.$dataHidden.val();
return a?JSON.parse(a):[]};d.prototype.updateOrder=function(a){for(var b=[],c=0;c<a.length;c++){var g=a[c];g&&g.length&&(g=parseInt(g),isNaN(g)||b.push(g))}0<b.length&&this.$dataHidden.val(JSON.stringify(b));this.$orderChangedHidden.val("true")};d.prototype.addElement=function(a){var b=this;return $.post(this.settings.WebMethods.GetElement,{elementId:a},void 0,"json").done(function(a){b.addElementItem(a.ElementId,a.Title,a.IsActive,a.IconUrl)})};d.prototype.addElements=function(a){var b=this;return $.post(this.settings.WebMethods.GetElements,
$.param({courseId:this.settings.CourseId,elementIds:a},!0),void 0,"json").done(function(a){$.each(a,function(a,c){b.addElementItem(c.ElementId,c.Title,c.IsActive,c.IconUrl)})})};d.prototype.addElementItem=function(a,b,c,g){var h=JSON.parse(this.$dataHidden.val());if(-1===$.inArray(a,h)){var d=this.settings.Terms.RemoveTooltip.replace("{0}",b);c=c?"":this.settings.Css.Inactive;this.$listContainer.append($("<li></li>").attr("data-id",a).append($("<span></span>").attr("class",this.settings.Css.ListItem).append($("<span></span>").attr("class",
this.settings.Css.AssignmentIcon).append($("<img>").attr("src",g)).append($("<span></span>").attr("class",c).text(b)).append("&nbsp;")).append($("<span></span>").attr("class",this.settings.Css.RemoveLink).attr("title",d).text(this.settings.DeleteChar))));h.push(a);this.$dataHidden.val(JSON.stringify(h));this.$orderChangedHidden.val("true")}else a=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",a)+" span:first-child span:first-child span"),a.text(b),a.toggleClass(this.settings.Css.Inactive,
!c)};d.prototype.deleteElement=function(a){var b=JSON.parse(this.$dataHidden.val()),c=b.indexOf(a);-1<c&&(b.splice(c,1),this.$dataHidden.val(JSON.stringify(b)));(a=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",a)))&&a.remove()};d.prototype.deleteElements=function(a){var b=this;$.each(a,function(a,g){b.deleteElement(g)})};return d}();e.ElementList=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.viewModel=c;window[a]=this;this.controlsProvider=new e.ResultsAndFeedbackInternals.ControlsProvider(c);this.externalDependenciesController=new e.ResultsAndFeedbackInternals.ExternalDependenciesController(c,this.controlsProvider);this.whenToShowResultsController=new e.ResultsAndFeedbackInternals.WhenToShowResultsController(c,this.controlsProvider,this.externalDependenciesController);this.whenToShowQuestionListAndAnswerController=
new e.ResultsAndFeedbackInternals.WhenToShowQuestionListAndAnswerController(c,this.controlsProvider,this.whenToShowResultsController,this.externalDependenciesController);$(function(){b.controlsProvider.$revealCorrectAnswerContainer.toggle(b.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer!==e.WhenToShowQuestionListAndAnswer.Never)})}Object.defineProperty(a.prototype,"revealCorrectAnswer",{get:function(){return this.controlsProvider.revealCorrectAnswerElement.isChecked()},
enumerable:!0,configurable:!0});a.prototype.getState=function(){return{WhenToShowResult:this.whenToShowResultsController.whenToShowResult,WhenToShowQuestionListAndAnswer:this.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer,RevealCorrectAnswer:this.revealCorrectAnswer,WhenToShowResultsChanged:this.whenToShowResultsController.whenToShowResultsChanged}};return a}();e.ResultsAndFeedback=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.viewModel=c;this.attemptsChanged=function(a){b.whichAttemptCountsContainer.toggle(1!==b.maxAttemptsAllowed)};window[a]=this;$(function(){b.controlElement=$("#"+c.ContainerId);b.maxAttemptsAllowedElement=$("."+c.MaxAttemptsAllowedSelector,b.controlElement);b.whichAttemptCountsElement=$("."+c.WhichAttemptCountsSelector,b.controlElement);b.whichAttemptCountsContainer=$("#"+c.WhichAttemptCountsContainer,b.controlElement);
b.maxAttemptsAllowedElement.change(b.attemptsChanged).change()})}Object.defineProperty(a.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.maxAttemptsAllowedElement.val(),10)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"whichAttemptCounts",{get:function(){var a=this.whichAttemptCountsElement.val();return e.WhichAttemptCounts[a]},enumerable:!0,configurable:!0});a.prototype.getState=function(){return{MaxAttemptsAllowed:this.maxAttemptsAllowed,WhichAttemptCounts:this.whichAttemptCounts,
WhichAttemptCountsChanged:this.whichAttemptCounts!==this.viewModel.AttemptsState.WhichAttemptCounts}};return a}();e.Attempts=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){}}();e.DateWithAdditionalInfo=f;var d=function(){function a(a,c,g,h){this._dateFormat=a;if(0>g||24<=g||0>h||60<=h)this._isValid=!1;else if(c&&c.length){this._isEmpty=!1;try{this._date=$.datepicker.parseDate(this._dateFormat,c),this._date.setHours(g),this._date.setMinutes(h),this._isValid=!0}catch(l){this._isValid=!1}}else this._isValid=this._isEmpty=!0}Object.defineProperty(a.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"isEmpty",{get:function(){return this._isEmpty},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"date",{get:function(){return this._date},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dateAsString",{get:function(){return this.isEmpty||!this.isValid?"":$.datepicker.formatDate(this._dateFormat,this._date)+" "+a.getNumberAsTwoCharString(this._date.getHours())+":"+a.getNumberAsTwoCharString(this._date.getMinutes())},
enumerable:!0,configurable:!0});a.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};return a}();e.DateTimePickerState=d;f=function(){function a(b,c){var g=this;window[b]=this;this.settings=c;this.$datePickerInput=$("#"+this.settings.Controls.DateInputId);this.$hoursDropDown=$("#"+this.settings.Controls.HoursDropDownId);this.$minutesDropDown=$("#"+this.settings.Controls.MinutesDropDownId);this.$validationMessage=$("#"+this.settings.Controls.ValidationMessageId);this.$textDescription=
$("#"+this.settings.Controls.TextDescriptionId);var h={showOn:"focus",buttonImage:"",buttonImageOnly:!1,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0};h.dateFormat=this.settings.DatePickerOptions.DateFormat;h.firstDay=this.settings.DatePickerOptions.FirstDayOfWeek;h.monthNames=this.settings.DatePickerOptions.MonthNames;h.monthNamesShort=this.settings.DatePickerOptions.MonthNamesShort;h.dayNames=this.settings.DatePickerOptions.DayNames;h.dayNamesShort=this.settings.DatePickerOptions.AbbreviatedDayNames;
h.dayNamesMin=this.settings.DatePickerOptions.AbbreviatedDayNames;h.closeText=this.settings.DatePickerOptions.CloseText;h.prevText=this.settings.DatePickerOptions.PrevText;h.nextText=this.settings.DatePickerOptions.NextText;h.currentText=this.settings.DatePickerOptions.CurrentText;h.showWeek=this.settings.DatePickerOptions.ShowWeek;h.weekHeader=this.settings.DatePickerOptions.WeekHeader;h.onChangeMonthYear=function(b,c,h){$(g).trigger(a.monthChangedEventName,{year:b,month:c,instance:h})};h.beforeShowDay=
function(a){var b=!0;g.settings.EnableSelectingDatesInThePast||(b=new Date,b=a>=new Date(b.getFullYear(),b.getMonth(),b.getDate()));g.minDate&&(b=a>=g.minDateAtTheBeginningOfDay);if(!g.datesToHighlight||0===g.datesToHighlight.length)return[b];b=[b,""];for(var c=0;c<g.datesToHighlight.length;c++)if(g.areDatesEqual(a,g.datesToHighlight[c].Date)){b[1]=g.datesToHighlight[c].CssClass;break}return b};h.beforeShow=function(b,c){b=$(b).datepicker("getDate");null==b&&(b=new Date);$(g).trigger(a.monthChangedEventName,
{year:b.getFullYear(),month:b.getMonth()+1,instance:c})};h.onSelect=function(a){if(g.datesToHighlight&&0!==g.datesToHighlight.length&&(a=$.datepicker.parseDate(h.dateFormat,a))){for(var b=0,c=0,d=0;d<g.datesToHighlight.length;d++)if(g.areDatesEqual(g.datesToHighlight[d].Date,a)){b=g.datesToHighlight[d].Date.getHours();c=g.datesToHighlight[d].Date.getMinutes();break}0!==b||0!==c?g.setTime(b,c):g.setTime(g.settings.DefaultHours,g.settings.DefaultMinutes)}g.updateTimePickerState();g.updateDependentPicker();
g.settings.EnableAutoSelectCurrentTimeForCurrentDate&&g.dateTimeSync&&g.isDateInputTextValid()&&(a=g.dateTimeSync.currentServerTime,g.areDatesEqual(g.getDateTime(),a)&&g.setTimePickerStateToCurrentTime(a));$(g).trigger("change",g.getDateTime())};if(this.$datePickerInput&&(this.$datePickerInput.datepicker(h),""===this.$datePickerInput.val()&&this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes),this.$datePickerInput.change(function(){g.updateTimePickerState();$(g).trigger("change",
g.getDateTime())}),this.settings.EnableTriggerDateInputBlurEvent))this.$datePickerInput.add(this.$hoursDropDown).add(this.$minutesDropDown).on("blur",function(){return $(g).trigger("blur",g.getDateTime())});this.$hoursDropDown.add(this.$minutesDropDown).change(function(){$(g).trigger("change",g.getDateTime());g.toggleValidationError({isInvalid:!1})});this.updateTimePickerState()}Object.defineProperty(a.prototype,"dependentPicker",{set:function(a){this.dependentPickerInstance=a},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"dateTimeSynchronizer",{set:function(a){this.dateTimeSync=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"minDate",{get:function(){return this.minDateValue},set:function(a){this.minDateValue=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"minDateAtTheBeginningOfDay",{get:function(){var a=new Date(this.minDateValue.getTime());a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},enumerable:!0,configurable:!0});
a.prototype.areDatesEqual=function(a,c){return a.getFullYear()===c.getFullYear()&&a.getMonth()===c.getMonth()&&a.getDate()===c.getDate()};a.prototype.setTime=function(a,c){1<this.settings.MinutesInterval?(a=this.getTimeOfNextInterval(a,c,this.settings.MinutesInterval),this.setDropDownValue(this.$hoursDropDown,a.hours.toString()),this.setDropDownValue(this.$minutesDropDown,a.minutes.toString())):(this.setDropDownValue(this.$hoursDropDown,a.toString()),this.setDropDownValue(this.$minutesDropDown,c.toString()))};
a.prototype.getTimeOfNextInterval=function(a,c,g){return 60-c<g?{hours:a+1,minutes:0}:{hours:a,minutes:Math.ceil(c/g)*g}};a.prototype.setDropDownValue=function(a,c){if(a){var b=!1;a.find("option").each(function(a,g){return g.getAttribute("value")===c?(b=!0,!1):!0});b&&a.val(c)}};a.prototype.getDateTimePickerState=function(){return new d(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val(),this.getDropDownValue(this.$hoursDropDown),this.getDropDownValue(this.$minutesDropDown))};a.prototype.getStringValue=
function(){var b=this.$datePickerInput.val();return b?b+" "+a.getNumberAsTwoCharString(this.getHours())+":"+a.getNumberAsTwoCharString(this.getMinutes()):""};a.prototype.getDateTimeAsString=function(){var b=this.getDateTime();return b?$.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,b)+" "+a.getNumberAsTwoCharString(b.getHours())+":"+a.getNumberAsTwoCharString(b.getMinutes()):""};Object.defineProperty(a.prototype,"isDateValidOrEmpty",{get:function(){return 0===this.$datePickerInput.val().length||
this.isDateInputTextValid()},enumerable:!0,configurable:!0});a.prototype.getDateTime=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val())}catch(c){}if(a)return a.setHours(this.getHours()),a.setMinutes(this.getMinutes()),a};a.prototype.setDateTime=function(a){"undefined"===typeof a?(this.$datePickerInput.val(""),this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes)):(this.$datePickerInput.val($.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,
a)),this.setTime(a.getHours(),a.getMinutes()));this.updateTimePickerState();this.updateDependentPicker()};a.prototype.toggleValidationError=function(a){a.isInvalid?(a.errorMessage&&0<a.errorMessage.length&&(this.$validationMessage.text(a.errorMessage).show(),this.$textDescription.hide()),a.highlightInput&&(this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput),this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput))):
(this.$validationMessage.empty().hide(),this.$textDescription.show(),this.$datePickerInput.removeClass(this.settings.CssClasses.InvalidInput),this.$hoursDropDown.removeClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.removeClass(this.settings.CssClasses.InvalidInput))};a.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};a.prototype.getHours=function(){return this.getDropDownValue(this.$hoursDropDown)};a.prototype.getMinutes=function(){return this.getDropDownValue(this.$minutesDropDown)};
a.prototype.getDropDownValue=function(a){return a?(a=a.val())&&""!==a.toString()?+a:0:0};a.prototype.enable=function(a){this.$datePickerInput.prop("disabled",!a);this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!a||!this.isDateInputTextValid())};a.prototype.setHighlightDates=function(a){this.datesToHighlight=a;this.$datePickerInput.datepicker("refresh")};a.prototype.isDateInputTextValid=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val())}catch(c){}return void 0!==
a&&null!==a};a.prototype.updateTimePickerState=function(){this.toggleValidationError({isInvalid:!1});this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!this.isDateInputTextValid())};a.prototype.setTimePickerStateToCurrentTime=function(a){this.setTime(a.getHours(),a.getMinutes())};a.prototype.updateDependentPicker=function(){this.dependentPickerInstance&&(this.dependentPickerInstance.minDate=this.getDateTime())};a.monthChangedEventName="DateTimePicker:MonthChanged";return a}();e.DateTimePicker=
f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.DeadlineState=d;d=function(){function a(a,c){var b=this;this.peerAssessmentStateChanged=function(a,c){(b.emptyDeadlineValidationEnabled=c)?b.closeAfterDeadlineCheckBox.toggle(c):b.closeAfterDeadlineCheckBox.toggle(b.settings.CloseAfterDeadline);b.closeAfterDeadlineCheckBox.enable(!c);b.closeAfterDeadlineCheckBox.getContainer().prop("title",c?b.settings.Terms.CloseAfterDeadlineDisabledWarning:b.settings.Terms.CloseAfterDeadline);
b.closeAfterDeadlineCheckBox.getContainer().toggleClass(b.settings.CssClasses.Disabled,c);b.initEmptyDeadlineValidation()};window[a]=this;this.settings=c;$(function(){b.closeAfterDeadlineCheckBox=window[b.settings.ClientInstanceNames.CloseAfterDeadlineCheckBox];b.dateTimePicker=window[b.settings.ClientInstanceNames.DateTimePicker];if(b.settings.HasDeadlinePassed&&b.settings.PeerAssessmentEnabled)b.enabled=!1;else{if(b.settings.Events.PeerAssessmentStateChanged)$(document).off(b.settings.Events.PeerAssessmentStateChanged).on(b.settings.Events.PeerAssessmentStateChanged,
b.peerAssessmentStateChanged);$(b.dateTimePicker).change(function(){b.emptyDeadlineValidationEnabled&&b.dateTimePicker.getDateTimePickerState().isEmpty?b.dateTimePicker.toggleValidationError({isInvalid:!0,errorMessage:c.Terms.SetDeadline,highlightInput:!0}):$(b).trigger("change",b.dateTimePicker.getDateTime())});if(b.dateTimePicker)$(b.dateTimePicker).on(f.Controls.DateTimePicker.monthChangedEventName,function(a,c){b.settings.WebMethods.GetEventsDateTime&&b.settings.CourseId&&0!==b.settings.CourseId&&
(a=new Date(c.year,c.month,6),$.post(b.settings.WebMethods.GetEventsDateTime,{startDate:JSON.stringify(new Date(c.year,c.month-2,25)),endDate:JSON.stringify(a),courseId:b.settings.CourseId}).done(function(a){for(var c=[],g=0;g<a.length;g++){var h=a[g],d={};d.Date=b.convertStringToDate(h.Date);d.CssClass=h.CssClass;c.push(d)}b.dateTimePicker.setHighlightDates(c)}))})}})}a.prototype.getState=function(){return{CloseAfterDeadline:this.settings.UseCloseAfterDeadline?this.closeAfterDeadlineCheckBox.isChecked():
!1,DateTime:this.dateTimePicker.getStringValue()}};a.prototype.convertStringToDate=function(a){a=a.split(".");return new Date(+a[2],+a[1]-1,+a[0],+a[3],+a[4])};Object.defineProperty(a.prototype,"enabled",{set:function(a){this.closeAfterDeadlineCheckBox.enable(a);this.dateTimePicker.enable(a)},enumerable:!0,configurable:!0});a.prototype.initEmptyDeadlineValidation=function(){this.emptyDeadlineValidationEnabled||this.dateTimePicker.toggleValidationError({isInvalid:!1})};return a}();e.Deadline=d})(e.Controls||
(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d.invalidDateAllowEmpty=function(a,b){return e.ValidatorFactory.checkToggle(function(){return!a.isDateValidOrEmpty},a,b)};d.invalidDateDenyEmpty=function(a,b){return e.ValidatorFactory.checkToggle(function(){return void 0===a.getDateTime()},a,b)};d.invalidDateAllowEmptyNoHighlight=function(a,b,c){return e.ValidatorFactory.checkNoHighlight(a,function(){return!a.isDateValidOrEmpty},b,c)};d.invalidDateDenyEmptyNoHighlight=function(a,b,c){return e.ValidatorFactory.checkNoHighlight(a,
function(){return void 0===a.getDateTime()},b,c)};d.compareDates=function(a,b,c,g){return e.ValidatorFactory.checkToggle(function(){return a(b.getDateTime(),c)},b,g)}})(e.DateTimePickerValidatorFactory||(e.DateTimePickerValidatorFactory={}))})(e.Validation||(e.Validation={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){function a(a,c,g){g&&c.isInvalid&&g();a.toggleValidationError(c);return!c.isInvalid}d.lessThanOrEqual=function(a,c){return a<=c};d.all=function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return function(){return 0===a.filter(function(a){return!a()}).length}};d.until=function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return function(){return a.every(function(a){return a()})}};d.checkToggle=function(b,c,g){return function(){return a(c,
{isInvalid:b(),errorMessage:g,highlightInput:!0},void 0)}};d.checkNoHighlight=function(b,c,g,h){return function(){return a(b,{isInvalid:c(),errorMessage:g,highlightInput:!1},h)}}})(e.ValidatorFactory||(e.ValidatorFactory={}))})(e.Validation||(e.Validation={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.contentMaxHeight=250;this.settings=c;window[a]=this;this.$mainContainer=$("."+c.ContainerCssClass);this.$showMore=$("#"+c.ShowMoreClientId);this.$showLess=$("#"+c.ShowLessClientId);this.showLess(!0)}a.prototype.showMore=function(){var a=this;this.$showMore.hide();this.expandMainContainer();var c=this.$mainContainer.height();this.$mainContainer.css("height",this.contentMaxHeight).css("overflow","hidden").animate({height:c},
function(){a.expandMainContainer();c>a.contentMaxHeight&&a.$showLess.show()})};a.prototype.showLess=function(a){var b=this;this.$showLess.hide();this.expandMainContainer();this.$mainContainer.height()<=this.contentMaxHeight||this.$mainContainer.css("overflow","hidden").animate({height:this.contentMaxHeight},a?0:400,function(){b.$mainContainer.css("position","relative");b.$showMore.show();b.$mainContainer.find(":tabbable:visible").on("focus",function(a){b.showMoreWhenOutOfView(a)})})};a.prototype.showMoreWhenOutOfView=
function(a){a=$(a.currentTarget).offset().top;var b=this.$mainContainer.offset().top+this.contentMaxHeight-this.$showMore.height();a>b&&(this.showMore(),this.$mainContainer.find(":tabbable:visible").off("focus"))};a.prototype.expandMainContainer=function(){this.$mainContainer.css("height","").css("overflow","").css("position","")};return a}();e.ShowMoreLessLinks=d})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var a=function(){function a(a,b){var c=this;this.controls=a;this.settings=b;this.eventDialog=window[this.settings.ClientInstanceNames.EventDialog];this.currentDatePeriod=this.settings.DatePeriod;this.ajaxClient=new d.AgendaAjaxClient(this.settings.WebMethods,this.settings.WidgetSettings);this.utility=new d.AgendaUtility(this.settings,this.controls);this.setupEventItemClick();this.setupHideTaskItemClick();this.controls.DayViewLink.add(this.controls.WeekViewLink).click(function(a){return c.changeDatePeriod(c.utility.getExpectedDatePeriod(a.currentTarget))});
this.contentBlockExpander=new CCL.ContentBlockExpander(this.controls.Container,{maxHeight:this.settings.ExpanderMaxPixelHeight,collapseHeight:this.settings.ExpanderCollapsePixelHeight,lang:{showLess:this.settings.Terms.ShowLess,showMore:this.settings.Terms.ShowMore}});$(function(){c.datePeriodSelector=window[c.settings.ClientInstanceNames.DatePeriodSelector];$(c.datePeriodSelector).on(f.Controls.DatePeriodSelector.periodChangedEventName,function(a,b){return c.loadAgenda(c.ajaxClient.createGetAgendaDayListContainerAjaxRequest(b.startDate,
b.endDate,c.currentDatePeriod))})})}a.prototype.afterUpdateWidget=function(){this.contentBlockExpander.reRenderShowMoreLink()};a.prototype.clearEventDialogContent=function(){this.controls.EventDialogContent.empty()};a.prototype.changeDatePeriod=function(a){this.currentDatePeriod!==a&&(this.currentDatePeriod=a,this.controls.DayViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===f.Controls.DatePeriod.Day),this.controls.WeekViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,
this.currentDatePeriod===f.Controls.DatePeriod.Week),this.datePeriodSelector.toggleWeekDayMode(this.currentDatePeriod,this.currentDatePeriod===f.Controls.DatePeriod.Week?this.settings.FirstDayOfTheWeek:this.settings.Today))};a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),function(b){b=$(b.currentTarget);if(b.getIfHyperLinkEnabled()){b=b.closest("."+a.settings.CssClasses.EventItemContainer);
var c=b.find(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.EventDialogContent)).clone();a.eventDialog.setTitle(a.utility.getEventTitle(b));a.controls.EventDialogContent.empty().append(c);b=c.find(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.EventDescription));b.html(a.utility.getEventDescription(b));a.eventDialog.openDialog(!1)}})};a.prototype.setupHideTaskItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.TaskHideId),
function(b){return a.loadAgenda(a.ajaxClient.createHideTaskAjaxRequest(a.utility.getTaskHideId($(b.currentTarget)),a.datePeriodSelector.getStartDate(),a.datePeriodSelector.getEndDate(),a.currentDatePeriod))})};a.prototype.loadAgenda=function(a){var b=this;this.currentLoadingSession&&this.currentLoadingSession.abort&&this.currentLoadingSession.abort();this.controls.AjaxLoadingWheel.show();this.controls.DayListContainer.empty().hide();this.contentBlockExpander.reRenderShowMoreLink();this.currentLoadingSession=
a();this.currentLoadingSession.done(function(a){return b.controls.DayListContainer.append(a).show()}).always(function(){b.controls.AjaxLoadingWheel.hide();b.contentBlockExpander.renderShowMoreLinkIfNeed(!1);b.currentLoadingSession=void 0})};return a}();d.AgendaContentBlock=a})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.controls=a;this.settings=b;this.elementLinkItemSelector=CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkItemId);this.listItemFocusedAreaSelector="."+this.settings.CssClasses.ListItemFocusedArea}d.prototype.isListItemFocusedArea=function(a){return a.is(this.listItemFocusedAreaSelector)};d.prototype.closestListItemFocusedArea=function(a){return a.closest(this.listItemFocusedAreaSelector)};d.prototype.closestElementItem=
function(a){return a.closest(this.elementLinkItemSelector)};d.prototype.getElementId=function(a){return a.data(this.settings.DataAttributes.ElementLinkItemId)};d.prototype.getCheckbox=function(a){return window[""+this.settings.ClientInstanceNames.ElementItemPrefix+a]};return d}();e.Utility=f})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementLinkDialog||(f.ElementLinkDialog={});f=f.ElementsPopupOpener||(f.ElementsPopupOpener={});f[f.None=0]="None";f[f.Plan=1]="Plan";f[f.WorkingPortfolioTask=2]="WorkingPortfolioTask";f[f.WorkingPortfolioPersonalizedTask=3]="WorkingPortfolioPersonalizedTask";f[f.CalendarEvent=4]="CalendarEvent"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.getParticipantCheckBox=function(a){return window[""+c.settings.ClientInstanceNames.DialogPersonItemCheckBoxPrefix+a]};this.getGroupCheckBox=function(a){return window[""+c.settings.ClientInstanceNames.DialogGroupItemCheckBoxPrefix+a]}}d.prototype.getItemId=function(a){return a.data(this.settings.DataAttributes.ItemId)};d.prototype.getItemType=function(a){return a.data(this.settings.DataAttributes.ItemType)};
d.prototype.getSelectedItemMarkup=function(a){return a.data(this.settings.DataAttributes.SelectedItemMarkup)};d.prototype.findLoadMoreItemsPointer=function(a){return a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LoadMoreItems))};d.prototype.getVirtualCount=function(a){return a.data(this.settings.DataAttributes.VirtualCount)};d.prototype.findListItems=function(a){return a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};d.prototype.findSelectedItems=
function(a){return this.controls.SelectedList.children("undefined"===typeof a?CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId):CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemType,a))};d.prototype.closestListItem=function(a){return a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};d.prototype.closestSelectedItem=function(a){return a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};return d}();
e.Utility=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.options=new Map;this.optionsGroup=a;this.options=new Map;b.forEach(function(a){return c.options.set(a[0],a[1])});this.optionsGroup.on("keydown","label",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter||a.keyCode===CCL.CommonConstants.keyCodes.space)return $(a.target).click(),a.preventDefault(),!1})}d.prototype.isSelected=function(a){return this.isOptionSelected(this.options.get(a))};d.prototype.addOnChangeHandler=
function(a){this.optionsGroup.on("change","input:radio",a)};d.prototype.isOptionSelected=function(a){return a.is(":checked")};return d}();e.OptionRadioButtonManagerBase=f})(f.OptionRadioButton||(f.OptionRadioButton={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a){d.call(this,a.controls.RadioButtonGroup,[[e.ItemType.Participant,a.controls.ParticipantsRadioButton],[e.ItemType.Group,a.controls.GroupsRadioButton]])}__extends(a,d);return a}(f.OptionRadioButton.OptionRadioButtonManagerBase);e.OptionRadioButtonManager=k})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a){this.utility=d;this.itemType=a;this.checkboxStateManager=new e.CheckboxStateManager;this.markupBuilder=new e.MarkupBuilder(this.utility,a);switch(a){case e.ItemType.Participant:this.itemList=this.utility.controls.ParticipantList;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoParticipantsFound,noItemsInCourse:this.utility.settings.Terms.NoParticipantsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForParticipants};
this.getCheckbox=this.utility.getParticipantCheckBox;break;case e.ItemType.Group:this.itemList=this.utility.controls.GroupList;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoGroupsFound,noItemsInCourse:this.utility.settings.Terms.NoGroupsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForGroups};this.getCheckbox=this.utility.getGroupCheckBox;break;default:throw Error("Unknown ItemType "+a);}}}();e.DialogItemModeDependentObjects=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.utility=a;this.itemType=b;this.cache=new Map}d.prototype.putMarkupFromSelectedItems=function(){var a=this;this.utility.findSelectedItems(this.itemType).each(function(b,c){return a.cache.set(a.utility.getItemId($(c)),c.outerHTML)})};d.prototype.putMarkupFromToggledItem=function(a){this.cache.set(this.utility.getItemId(a),this.utility.getSelectedItemMarkup(a))};d.prototype.buildMarkup=function(a){var b=this;return a.map(function(a){return b.cache.get(a)}).join("")};
return d}();e.MarkupBuilder=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(){this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.committedStateMap=new Map;this.pendingStateMap=new Map;this.ignoreCheckboxEvents=!1}d.prototype.setInitiallySelectedItemIds=function(a){for(var b=0;b<a.length;b++)this.committedStateMap.set(a[b],f.CheckboxStateMachine.State.Saved)};d.prototype.getSelectedItemIds=function(){var a=this,b=[];this.committedStateMap.forEach(function(c,g){a.isStateChecked(c)&&b.push(g)});return b};d.prototype.isItemPendingChecked=
function(a){return this.isStateChecked(this.pendingStateMap.get(a)||f.CheckboxStateMachine.State.Empty)};d.prototype.initializePendingStateMap=function(){this.pendingStateMap=f.MapUtils.makeCopy(this.committedStateMap)};d.prototype.commitPendingStateMap=function(){this.committedStateMap=f.MapUtils.makeCopy(this.pendingStateMap)};d.prototype.withIgnoreCheckboxEvents=function(a){this.ignoreCheckboxEvents=!0;try{a()}finally{this.ignoreCheckboxEvents=!1}};d.prototype.transferPendingState=function(a){var b=
a.itemId;a=a.isChecked;if(!this.ignoreCheckboxEvents){var c=this.pendingStateMap.get(b)||f.CheckboxStateMachine.State.Empty;a=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(a,c);this.pendingStateMap.set(b,a)}};d.prototype.transferCommittedStateToUnchecked=function(a){var b=this.committedStateMap.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.committedStateMap.set(a,b)};d.prototype.isStateChecked=function(a){return a===f.CheckboxStateMachine.State.Saved||
a===f.CheckboxStateMachine.State.AttachedByUser};return d}();e.CheckboxStateManager=k})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.searchTimeoutMilliseconds=1E3;this.pageIndex=0;this.searchDebouncer=new CCL.CallbackDebouncer(function(){return c.search()});this.isSelectedListCollapsed=!0;this.onCheckboxStateChanged=function(a,b){a=c.utility.closestListItem($(a.currentTarget));var g=c.utility.getItemId(a);c.currentObjects.checkboxStateManager.transferPendingState({itemId:g,isChecked:b.Checked});c.currentObjects.markupBuilder.putMarkupFromToggledItem(a)};
this.onClickingListItem=function(a){var b=$(a.currentTarget);c.optionRadioManager.isSelected(e.ItemType.Participant)&&b.children("a").get(0).contains(a.target)||c.toggleOptionCheckBox(c.utility.getItemId(b),function(a){return!a})};this.onWithdrawItem=function(a){a.preventDefault();var b=c.utility.closestSelectedItem($(a.currentTarget));a=c.utility.getItemId(b);var g=c.utility.getItemType(b);b.remove();b=g===e.ItemType.Participant?c.personObjects.checkboxStateManager:c.groupObjects.checkboxStateManager;
c.uncheckCheckbox(a,b);b.transferCommittedStateToUnchecked(a);c.updatePickerResultHidden();c.updateCollapserWhenNumberOfSelectedItemsChanged();c.setSelectedItemSectionVisibility()};this.utility=new e.Utility(a,b);this.modalDialog=window[this.settings.ClientInstanceNames.Dialog];this.personObjects=new e.DialogItemModeDependentObjects(this.utility,e.ItemType.Participant);this.groupObjects=new e.DialogItemModeDependentObjects(this.utility,e.ItemType.Group);this.currentObjects=this.settings.InitialItemType===
e.ItemType.Group?this.groupObjects:this.personObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups();this.optionRadioManager=new e.OptionRadioButtonManager(this.utility);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.setupOkButtonClickHandler();this.controls.ShowMoreSelectedItemsLink.click(function(a){a.preventDefault();c.toggleCollapser()});this.controls.ChangeLink.click(function(a){c.openDialog();c.personObjects.checkboxStateManager.initializePendingStateMap();c.groupObjects.checkboxStateManager.initializePendingStateMap();
c.updateCheckboxes();a.preventDefault()});a=this.controls.ParticipantList.add(this.controls.GroupList);a.on((g={},g[this.settings.EventNames.OptionCheckBoxChanged]=this.onCheckboxStateChanged,g),"input:checkbox");a.on("click","li",this.onClickingListItem);this.controls.SelectedList.on("click","."+this.settings.CssClasses.WithdrawLink,this.onWithdrawItem);this.setupLoadMoreOnScroll();this.setupRadioButtonChangeHandler();this.setupSearch();this.personObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedParticipantIds);
this.groupObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedGroupIds);this.personObjects.markupBuilder.putMarkupFromSelectedItems();this.groupObjects.markupBuilder.putMarkupFromSelectedItems();this.updatePickerResultHidden();this.controls.DialogContent.keypress(function(a){a.which!==CCL.CommonConstants.keyCodes.enter||c.controls.OkButton.is(":focus")||a.preventDefault()});var g}d.prototype.setupLoadMoreOnScroll=function(){var a=this;this.controls.DialogContent.on((this.isIosDevice?
"touchmove":"")+" scroll",function(){var b=a.currentObjects.itemList,c;!a.isLoadingInProgress&&0<a.utility.findLoadMoreItemsPointer(b).length&&CCL.CommonFunctions.isOnScreen((c=a.utility.findListItems(b)).eq(Math.max(0,c.length-3)),.1,.1,a.isIosDevice?window.parent:window)&&a.loadMoreItems()})};d.prototype.setupRadioButtonChangeHandler=function(){var a=this;this.optionRadioManager.addOnChangeHandler(function(){a.switchCurrentObjects();a.search()})};d.prototype.setupSearch=function(){var a=this;this.controls.SearchTextBox.on("input",
function(b){""===a.controls.SearchTextBox.val()?a.search():a.searchDebouncer.invokeCallback(void 0,a.searchTimeoutMilliseconds);b.preventDefault()})};d.prototype.search=function(){this.pageIndex=0;this.loadMoreItems({cleanExistingEntries:!0})};d.prototype.loadMoreItems=function(a){var b=this;a=(void 0===a?{}:a).cleanExistingEntries;var c=this.currentObjects.itemList;this.isLoadingInProgress=!0;if(void 0===a?0:a)c.empty(),this.controls.NoItemsFoundPanel.hide(),this.controls.AjaxLoader.show();this.itemsRequest&&
this.itemsRequest.abort&&this.itemsRequest.abort();this.itemsRequest=this.searchOrLoadMore();this.itemsRequest.done(function(a){b.utility.findLoadMoreItemsPointer(c).remove();c.append(a);var g=b.utility.findLoadMoreItemsPointer(c);a=b.utility.findListItems(c).length;var d=0!==a;g=0<g.length?b.utility.getVirtualCount(g):a;b.controls.PageInfo.toggle(d).text(CCL.CommonFunctions.formatString(b.settings.Terms.ShowingXofYLabelFormat,a,g));c.toggle(d);d||b.controls.NoItemsFoundPanel.text(""===b.controls.SearchTextBox.val()?
b.currentObjects.terms.noItemsInCourse:b.currentObjects.terms.noItemsMeetSearchCriteria);b.controls.NoItemsFoundPanel.toggle(!d);b.pageIndex++;b.updateCheckboxes()}).always(function(){b.itemsRequest=void 0;b.isLoadingInProgress=!1;b.controls.AjaxLoader.hide()})};d.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.click(function(b){a.applySelectedItems();CssModal.closeDialog();b.preventDefault()})};d.prototype.applySelectedItems=function(){this.personObjects.checkboxStateManager.commitPendingStateMap();
this.groupObjects.checkboxStateManager.commitPendingStateMap();this.updatePickerResultHidden();this.controls.SelectedList.empty().append(this.personObjects.markupBuilder.buildMarkup(this.personObjects.checkboxStateManager.getSelectedItemIds())).append(this.groupObjects.markupBuilder.buildMarkup(this.groupObjects.checkboxStateManager.getSelectedItemIds()));this.updateCollapserWhenNumberOfSelectedItemsChanged();this.setSelectedItemSectionVisibility()};d.prototype.updateCollapserWhenNumberOfSelectedItemsChanged=
function(){this.updateToggleSelectedItemsCountLinkText();this.controls.ShowMoreSelectedItemsLinkContainer.toggle(this.utility.findSelectedItems().length>this.settings.NumberOfSelectedItemsToDisplayInCollapsedMode)};d.prototype.toggleCollapser=function(){this.isSelectedListCollapsed=!this.isSelectedListCollapsed;this.controls.SelectedList.toggleClass(this.settings.CssClasses.SelectedListCollapsed,this.isSelectedListCollapsed);this.updateToggleSelectedItemsCountLinkText()};d.prototype.updateToggleSelectedItemsCountLinkText=
function(){this.controls.ShowMoreSelectedItemsLink.text(this.isSelectedListCollapsed?CCL.CommonFunctions.formatString(this.settings.Terms.ShowAllFormat,this.utility.findSelectedItems().length):this.settings.Terms.Hide)};d.prototype.updateCheckboxes=function(){var a=this;this.currentObjects.checkboxStateManager.withIgnoreCheckboxEvents(function(){a.utility.findListItems(a.currentObjects.itemList).each(function(b,c){b=$(c);c=a.utility.getItemId(b);a.toggleOptionCheckBox(c,a.currentObjects.checkboxStateManager.isItemPendingChecked(c));
a.currentObjects.markupBuilder.putMarkupFromToggledItem(b)})})};d.prototype.setSelectedItemSectionVisibility=function(){var a=0<this.utility.findSelectedItems().length;this.controls.SelectedListContainer.toggle(a);this.controls.NoOneIsChosenLabel.toggle(!a)};d.prototype.openDialog=function(){this.controls.SearchTextBox.focus();this.modalDialog.openDialog(!1);this.controls.SearchTextBox.val("");this.search()};d.prototype.searchOrLoadMore=function(){var a={ElementOrParentFolderId:this.settings.ElementOrParentFolderId,
PageIndex:this.pageIndex,Search:this.controls.SearchTextBox.val(),IsGroups:this.optionRadioManager.isSelected(e.ItemType.Group)};return $.ajax({type:"POST",url:this.settings.Urls.GetParticipantOrGroupListContent,data:a,dataType:"html"})};d.prototype.sortSelectedList=function(){var a=this;this.utility.findSelectedItems().get().sort(function(b,c){var g=a.settings.IsParticipantListSortOrderAscending?c:b,d="data-"+a.settings.DataAttributes.SelectedItemSortExpression;return $(a.settings.IsParticipantListSortOrderAscending?
b:c).attr(d).localeCompare($(g).attr(d))}).forEach(function(b){a.controls.SelectedList.append(b)})};d.prototype.uncheckCheckbox=function(a,b){var c=this;b.withIgnoreCheckboxEvents(function(){c.toggleOptionCheckBox(a,!1)})};d.prototype.updatePickerResultHidden=function(){var a={ParticipantIds:this.personObjects.checkboxStateManager.getSelectedItemIds(),GroupIds:this.groupObjects.checkboxStateManager.getSelectedItemIds()};this.controls.PickerResultHidden.val(JSON.stringify(a))};d.prototype.toggleOptionCheckBox=
function(a,b){(a=this.currentObjects.getCheckbox(a))&&("boolean"===typeof b?a.toggle(b):a.toggle(b(a.getState().Checked)))};d.prototype.switchCurrentObjects=function(){this.currentObjects=this.optionRadioManager.isSelected(e.ItemType.Participant)?this.personObjects:this.groupObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups()};d.prototype.updateUiAfterSwitchBetweenParticipantsAndGroups=function(){this.utility.controls.ParticipantList.toggle(this.currentObjects.itemType===e.ItemType.Participant);
this.utility.controls.GroupList.toggle(this.currentObjects.itemType===e.ItemType.Group);this.utility.controls.SearchTextBox.prop("placeholder",this.currentObjects.terms.searchPlaceholder)};return d}();e.PickerManager=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;this.addCourseWindow=$("."+this.settings.CssClasses.Window);this.addCourseForm=this.addCourseWindow.find("form");this.scrollable=this.addCourseForm.find("."+this.settings.CssClasses.ScrollDiv);this.titleInput=$("#"+this.settings.ControlIds.CourseTitle);this.titleError=$("."+this.settings.CssClasses.Title.Error);this.courseIcon=$("."+this.settings.CssClasses.CourseIcon);this.colorPicker=$("#"+this.settings.ControlIds.ColorPicker);
this.colorPickerHover=this.colorPicker.next();this.codeInput=$("."+this.settings.CssClasses.Code);this.buttons=$("."+this.settings.CssClasses.Buttons);this.buttonSubmit=$("#"+this.settings.ControlIds.CreateCourseButton);this.buttonCancel=$("#"+this.settings.ControlIds.CancelButton);this.advancedOptionsToggler=$("."+this.settings.CssClasses.Advanced.Toggler);this.advancedOptionsContent=$("."+this.settings.CssClasses.Advanced.Content);this.advancedOptionsLanguage=this.advancedOptionsToggler.data("lang");
this.advancedOptionsShow=!1;this.advancedOptionsTemplates=$("."+this.settings.CssClasses.Advanced.Templates);this.courseType=$(this.settings.ControlIds.CourseType);this.courseTemplateHolder=$("."+this.settings.CssClasses.Advanced.TemplatesHolder);this.courseTemplateLink=$("."+this.settings.CssClasses.Advanced.TemplateLink);this.courseTemplatesIframe=$("."+this.settings.CssClasses.Advanced.TemplatesIframe);this.radioButtonLabel=$("."+this.settings.CssClasses.RadioButtonLabel);this.modalMask=$("."+
this.settings.CssClasses.ModalMask);this.setupControls();this.setupControlsEvents()}d.prototype.setupControls=function(){this.courseTemplateHolder.hide();this.changeColor();this.scrollable.perfectScrollbar({suppressScrollX:!0});this.titleInput.focus();this.advancedOptionsTemplates.hide()};d.prototype.setupControlsEvents=function(){var a=this;this.courseTemplatesIframe.load(function(){a.advancedOptionsTemplates.is(":visible")?(a.scrollable.scrollTop(1E3).perfectScrollbar("update"),a.courseTemplatesIframe.contents().find("#"+
a.settings.ControlIds.TemplateSearchTextBox).focus()):a.titleInput.focus()});this.advancedOptionsToggler.on("click touch",function(b){a.advancedOptionsShow=!a.advancedOptionsShow;a.advancedOptionsToggler.toggleClass(a.settings.CssClasses.Advanced.TogglerOpen);a.buttons.toggleClass(a.settings.CssClasses.ButtonsShadow);a.advancedOptionsContent.toggle();a.advancedOptionsToggler.text(a.advancedOptionsShow?a.advancedOptionsLanguage.hide:a.advancedOptionsLanguage.show);a.scrollable.animate({scrollTop:a.advancedOptionsShow?
a.advancedOptionsToggler.offset().top:0},250);b.preventDefault();return!1});this.colorPickerHover.change(function(){a.changeColor()});this.courseType.change(function(){var b=a.courseType.get();a.advancedOptionsTemplates.hide();a.courseTemplateHolder.hide();1>=b.length||(b[0].checked?($("."+a.settings.CssClasses.TemplateId).val("null"),$("."+a.settings.CssClasses.TemplateType).val("0"),a.scrollable.perfectScrollbar("update")):(a.courseTemplatesIframe.attr("src",b[1].checked?a.settings.Urls.FindCourseTemplates:
a.settings.Urls.FindPlannerTemplates),a.fecthTemplates(),a.scrollable.scrollTop(1E3).perfectScrollbar("update"),a.courseTemplatesIframe.contents().find("#"+a.settings.ControlIds.TemplateSearchTextBox).focus()),a.buttonSubmit.trigger("buttonSubmitDisable"))});this.titleInput.on("input",function(){var b=0===a.titleInput.val().trim().length;a.titleError.css({display:b?"block":"none"});a.titleError.next().css({"margin-top":b?"0px":"","margin-bottom":b?"0px":""});a.buttonSubmit.trigger("buttonSubmitDisable")});
this.buttonSubmit.on("buttonSubmitDisable",function(){var b=a.isTitleEmpty()||!a.isCourseTypeRegular()&&!a.isTemplateSelected();a.buttonSubmit.prop("disabled",b)});this.buttonCancel.on("keydown",function(b){if(b.keyCode===CCL.CommonConstants.keyCodes.tab)return a.titleInput.focus(),b.preventDefault(),!1});this.radioButtonLabel.on("keydown",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter)return $(a.target).click(),a.preventDefault(),!1});this.buttonCancel.on("click touch",function(){a.addCourseWindow.remove();
a.modalMask.remove()});this.modalMask.on("click touch",function(){a.addCourseWindow.remove();a.modalMask.remove()});this.courseTemplateHolder.on("click touch","."+this.settings.CssClasses.Advanced.TemplateLink,function(){a.courseTemplateHolder.hide();a.fecthTemplates()});this.addCourseWindow.on("invalid-form.validate","form",function(){var a=$(this).find('input[type="submit"]');setTimeout(function(){a.removeAttr("disabled")},1)});this.addCourseWindow.on("submit","form",function(){var a=$(this).find('input[type="submit"]');
setTimeout(function(){a.attr("disabled","disabled")},0)})};d.prototype.isTitleEmpty=function(){return 0===this.titleInput.val().trim().length};d.prototype.isCourseTypeRegular=function(){return this.courseType.get()[0].checked};d.prototype.isTemplateSelected=function(){return 0<$("."+this.settings.CssClasses.TemplateId).val().length};d.prototype.changeColor=function(){this.currentColor&&this.courseIcon.removeClass(this.currentColor);this.currentColor=this.colorPickerHover[0].classList[0];this.courseIcon.addClass(this.currentColor)};
d.prototype.fecthTemplates=function(){var a=this;window.parent.selectCourseTemplate=function(b,c){void 0===c&&(c=!1);c=c?a.settings.TemplateFromPlanner:a.settings.TemplateFromCourse;$("."+a.settings.CssClasses.TemplateId).val(b.toString());$("."+a.settings.CssClasses.TemplateType).val(c.toString());a.advancedOptionsTemplates.hide();a.buttonSubmit.trigger("buttonSubmitDisable");$.ajax({url:a.settings.Urls.SetTemplate,type:"POST",cache:!1,data:{templateId:b,templateType:c}}).done(function(b){a.courseTemplateHolder.html(b);
a.courseTemplateHolder.show();a.scrollable.perfectScrollbar("update")});delete window.parent.selectCourseTemplate};this.advancedOptionsTemplates.show()};return d}();e.AddCourse=f})(f.Courses||(f.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;e.enrolInCoursesInstance=this;this.coursesTableSelector=a.CoursesTableSelector;this.checkboxColumnSelector=a.CheckboxColumnSelector;this.alertMessageText=a.AlertMessageText;$(a.ToolbarSelector+" a").click(function(a){return b.checkBeforeEnrolWithdraw(a)})}d.prototype.isAnyCourseSelected=function(){return 0<$(this.coursesTableSelector+" "+this.checkboxColumnSelector+" input:checked").length};d.prototype.checkBeforeEnrolWithdraw=function(a){if(!this.isAnyCourseSelected())return a.preventDefault(),
jAlert(this.alertMessageText),!1};return d}();e.EnrolInCourses=f})(f.Courses||(f.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.isTopicSelected=function(){return parseInt(c.topicPickerInstance.getSelectedItem().id,10)>c.settings.NotChosenOptionValue};this.settings=a;this.controls=b;$(function(){c.showInPlanner=window[c.settings.ClientInstanceNames.ShowInPlanner];c.showInPlanner.setOnChangeCallback(function(){var a=c.showInPlanner.isChecked();a||(c.topicPickerInstance.closeMenu(),c.planPickerInstance.closeMenu());c.controls.TopicPlanPanel.toggle(a)});
c.settings.UseTopics&&(c.planPickerInstance.toggleEnabled(c.isTopicSelected()&&c.showInPlanner.isEnabled()),c.topicPickerInstance.onchange(function(){c.planPickerInstance.toggleEnabled(!1);c.isTopicSelected()||!c.planPickerInstance.hasAnyItems()?(c.topicPickerInstance.toggleEnabled(!1),c.controls.PlanPicker.hide(),c.controls.NoPlansLabel.hide(),c.controls.Loader.show(),$.ajax({type:"GET",url:c.settings.Actions.GetPlansForCourseAndTopic,data:{courseId:c.settings.CourseId,topicId:c.topicPickerInstance.getSelectedItem().id,
selectPlanLabel:c.settings.Resources.SelectPlan}}).always(function(){c.controls.Loader.hide();c.planPickerInstance.toggleEnabled(c.isTopicSelected());c.topicPickerInstance.toggleEnabled(!0)}).done(function(a){var b=1<a.length||!c.isTopicSelected();c.planPickerInstance.loadMenu(a);c.planPickerInstance.selectItem(2===a.length?a[1].id:c.settings.NotChosenOptionValue);c.controls.PlanPicker.toggle(b);c.controls.NoPlansLabel.toggle(!b);c.planPickerInstance.resizeComponent()})):(c.planPickerInstance.selectItem(c.settings.NotChosenOptionValue),
c.controls.PlanPicker.show(),c.controls.NoPlansLabel.hide(),c.planPickerInstance.resizeComponent())}))})}Object.defineProperty(d.prototype,"topicPickerInstance",{get:function(){return"undefined"===typeof this.topicPickerInstanceValue?this.topicPickerInstanceValue=window[this.settings.ClientInstanceNames.Topic]:this.topicPickerInstanceValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"planPickerInstance",{get:function(){return"undefined"===typeof this.planPickerInstanceValue?
this.planPickerInstanceValue=window[this.settings.ClientInstanceNames.Plan]:this.planPickerInstanceValue},enumerable:!0,configurable:!0});return d}();e.ElementPlanPicker=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var a=this;this.findSectionOrMeasurement=function(b,c){$.getJSON(a.settings.FindSectionOrMeasurementUrl,{search:b.term},function(a){c($.map(a,function(a){return{value:a.Name,isMeasurement:a.IsMeasurement,id:a.Id}}))})};this.renderSearchBoxItem=function(a,c){return $("<li/>").append("<span "+(c.isMeasurement?"":"class='h-fnt-bd'")+">"+c.value+"</span>").appendTo(a)};this.selectSearchBoxItem=function(b,c){a.searchKpiContent(c.item.value,
c.item.id)};this.searchKpiContent=function(b,c){window.location.search="?"+a.settings.SearchStringParamName+"="+b+"&"+a.settings.SearchValueParamName+"="+(c?c:"")};e.measureFilterInstance=this;this.settings=d;this.settings.Controls.SearchBoxContainer.on(this.settings.TextSearchEvent,function(b,c){return a.searchKpiContent(c,null)})}}();e.MeasureFilter=f})(f.FeatureAdoption||(f.FeatureAdoption={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e;(function(d){d[d.Initial=0]="Initial";d[d.Started=1]="Started";d[d.StoppingInProcess=2]="StoppingInProcess";d[d.Stopped=3]="Stopped";d[d.Preview=4]="Preview";d[d.Paused=5]="Paused";d[d.Delete=6]="Delete";d[d.Upload=7]="Upload"})(e||(e={}));var k=function(){function d(a,b){this.timeout=0;this.updateProgressEvent=null;this.currentRecordDuration=0;this.currentState=e.Initial;window[a]=this;this.settings=b;this.eventNames=b.EventNames;this.initialize()}d.prototype.initialize=function(){var a=
this;this.$mainPanel=$("#"+this.settings.MainPanelClientId);this.$startRecordingButton=$("#"+this.settings.StartResumeButtonClientId);this.$stopRecordingButton=$("#"+this.settings.StopButtonClientId);this.$stopRecordingButton.hide();this.$currentTimeLabel=$("#"+this.settings.CurrentTimeLabelClientId);this.$playPausePreviewButton=$("#"+this.settings.PlayRecordButtonClientId);this.$recordingLight=$("#"+this.settings.RecordingLightClientId);this.$progressBar=$("#"+this.settings.ProgressBarClientId);
this.isPreviewSessionStarted=!1;this.recorder=window[this.settings.RecorderClientInstanceName];this.timeout=this.settings.ShouldRecordVideo?this.settings.MaxSecondsVideo:this.settings.MaxSecondsAudio;$(document).on(this.eventNames.RecordingStoppedEventName,function(){if(a.currentState===e.Delete)a.onDeleteRecord();else a.currentState!==e.Initial&&a.currentState!==e.Started&&a.getRecorder().preparePreview()});$(document).on(this.eventNames.PreviewPreparedEventName,function(){a.currentRecordDuration=
a.getRecorder().getDuration();a.currentState!==e.Initial&&a.currentState!==e.Started&&(a.setProgress(0,a.currentRecordDuration,!1),a.getRecorder().supportsSeek()&&(a.$progressBar.on("click",function(b){a.seekInPlayback(b)}),a.$progressBar.css("cursor","pointer")),a.currentState===e.Upload?(a.updateControls(e.Stopped),$(document).trigger(a.eventNames.UploadPreparedEventName)):a.setState(e.Stopped))});$(document).on(this.eventNames.PreviewPreparedFailedEventName,function(){a.onDeleteRecord()});$(document).on(this.eventNames.RecordingPlaybackEndedEventName,
function(){clearTimeout(a.updateProgressEvent);a.setProgress(a.currentRecordDuration,a.currentRecordDuration,!1);a.setState(e.Stopped);a.isPreviewSessionStarted=!1});$(document).on(this.eventNames.HasUserMediaAccessEventName,function(){$(document).trigger(a.eventNames.RecordingStartedEventName);clearTimeout(a.updateProgressEvent);a.updateProgressEvent=setInterval(function(){a.updateProgress(a.timeout,!0)},100);a.setState(e.Started)});$(document).on(this.eventNames.RecordingInteruptedEventName,function(){a.onDeleteRecord();
a.closeRecordingSession()});$(document).on(this.eventNames.SwitchToAudioRecorderEventName,function(){a.settings.ShouldRecordVideo=!1;a.timeout=a.settings.MaxSecondsAudio;a.setProgress(0,a.timeout,!0);a.$mainPanel.removeClass(a.settings.CssMainContainerVideo);a.$mainPanel.addClass(a.settings.CssMainContainerAudio)});$(document).on(this.eventNames.UpdateMaximumRecordingLength,function(b,c){a.timeout=Math.min(c,a.settings.ShouldRecordVideo?a.settings.MaxSecondsVideo:a.settings.MaxSecondsAudio);a.setProgress(0,
a.timeout,!0)});this.setProgress(0,this.timeout,!0);this.setState(e.Initial)};d.prototype.startRecording=function(){var a=this.getRecorder();a&&this.currentState!==e.Started&&a.startRecording()};d.prototype.stopRecording=function(){this.stopRecorderAndUpdateState(e.StoppingInProcess)};d.prototype.deleteRecording=function(){if(this.getRecorder())if(this.currentState===e.Started)this.stopRecorderAndUpdateState(e.Delete);else this.onDeleteRecord()};d.prototype.onDeleteRecord=function(){clearTimeout(this.updateProgressEvent);
var a=this.getRecorder();a&&(this.currentRecordDuration=0,this.setProgress(0,this.timeout,!1),$(document).trigger(this.eventNames.RecordingDeletedEventName),a.deleteRecord(),this.setState(e.Initial))};d.prototype.stopRecorderAndUpdateState=function(a){var b=this.getRecorder();b&&this.currentState===e.Started&&(clearTimeout(this.updateProgressEvent),this.setState(a),b.stopRecording())};d.prototype.closeRecordingSession=function(){try{var a=this.getRecorder();a&&(clearTimeout(this.updateProgressEvent),
a.closeRecordingSession())}catch(b){}};d.prototype.previewRecording=function(){var a=this;this.getRecorder().previewRecord();clearTimeout(this.updateProgressEvent);this.updateProgressEvent=setInterval(function(){a.updateProgress(a.currentRecordDuration,!1)},100);this.isPreviewSessionStarted=!0;this.setState(e.Preview)};d.prototype.pauseResumePreview=function(a){var b=this.getRecorder();b&&(b.pauseResumePreview(a),this.setState(a?e.Paused:e.Preview))};d.prototype.prepareUpload=function(){this.currentState===
e.Started?(this.updateControls(e.StoppingInProcess),this.stopRecorderAndUpdateState(e.Upload)):(this.currentState===e.Preview&&this.pauseResumePreview(!0),$(document).trigger(this.eventNames.UploadPreparedEventName))};d.prototype.uploadRecord=function(a){var b=this.getRecorder();b&&b.uploadRecord(this.settings.UploadProxyUrl,a)};d.prototype.seekInPlayback=function(a){var b=$(a.currentTarget),c=b.offset();a=this.currentRecordDuration*(a.pageX-c.left)/b.width();this.getRecorder().seek(a);this.currentState===
e.Stopped&&this.updateProgress(this.currentRecordDuration,!1)};d.prototype.getRecorder=function(){this.recorder||(this.recorder=window[this.settings.RecorderClientInstanceName]);return this.recorder};d.prototype.setState=function(a){this.currentState=a;this.updateControls(a)};d.prototype.updateControls=function(a){var b=this;switch(a){case e.Initial:this.$stopRecordingButton.removeClass(this.settings.CssStateStopping).hide();this.$startRecordingButton.show();this.$playPausePreviewButton.hide();this.$progressBar.off("click");
this.$progressBar.css("cursor","default");this.$recordingLight.hide();clearTimeout(this.updateProgressEvent);break;case e.Started:this.$stopRecordingButton.on("click",function(){b.stopRecording()});this.$stopRecordingButton.show();this.$startRecordingButton.hide();this.$recordingLight.show().css("display","inline-block");break;case e.Delete:case e.StoppingInProcess:this.$mainPanel.removeClass(this.settings.CssStatePlaying);this.$stopRecordingButton.addClass(this.settings.CssStateStopping);this.$stopRecordingButton.off("click");
this.$recordingLight.hide();break;case e.Stopped:this.$mainPanel.removeClass(this.settings.CssStatePlaying);this.$stopRecordingButton.removeClass(this.settings.CssStateStopping);this.$stopRecordingButton.hide();this.$playPausePreviewButton.show();this.$playPausePreviewButton.attr("title",this.settings.PlayPreviewButtonTooltip);this.$playPausePreviewButton.off("click");this.$playPausePreviewButton.on("click",function(){b.previewRecording()});break;case e.Preview:this.$mainPanel.addClass(this.settings.CssStatePlaying);
this.$playPausePreviewButton.attr("title",this.settings.PausePreviewButtonTooltip);this.$playPausePreviewButton.off("click");this.$playPausePreviewButton.on("click",function(){b.pauseResumePreview(!0)});break;case e.Paused:this.$mainPanel.removeClass(this.settings.CssStatePlaying),this.$playPausePreviewButton.attr("title",this.settings.PlayPreviewButtonTooltip),this.$playPausePreviewButton.off("click"),this.$playPausePreviewButton.on("click",function(){b.pauseResumePreview(!1)})}};d.prototype.updateProgress=
function(a,b){var c=this.getRecorder();c&&(c=c.getCurrentTime())&&this.setProgress(c,a,b)};d.prototype.setProgress=function(a,b,c){c?0>=Math.floor(10*(b-a))?(a=this.convertTime(b),this.stopRecorderAndUpdateState(e.StoppingInProcess)):a=this.convertTime(a):(this.updateProgressBar(a,b),a=this.convertTime(a));a+=" / "+this.convertTime(b);this.$currentTimeLabel.text(a)};d.prototype.convertTime=function(a){a=Math.round(a);var b=Math.floor(a/60);a=Math.floor(a-60*b);return(10<=b?"":"0")+b+":"+((10<=a?"":
"0")+a)};d.prototype.updateProgressBar=function(a,b){var c=$("."+this.settings.CssPlayBar);c&&c.width(100*a/b+"%")};return d}();f.MediaRecorderControl=k})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){function e(d,a){this.flashId="FlashRecorder";window[d]=this;this.settings=a;this.eventNames=a.EventNames;this.name=d;this.initialize()}e.prototype.initialize=function(){var d={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent"},a={id:this.flashId,name:"FlashRecorder",align:"middle",wmode:"transparent"};this.settings.RequestMediaResourcesOnLoad&&(swfobject.embedSWF("flash/FlashRecorder.swf","flashContent",545,220,"11.4.0",
"playerProductInstall.swf",{},d,a,this.flashReady(this)),swfobject.createCSS("#flashContent","display:block;text-align:left;"))};e.prototype.startRecording=function(){this.flash.startRecording()};e.prototype.stopRecording=function(){this.flash.stopRecording(this.eventNames.RecordingStoppedEventName)};e.prototype.preparePreview=function(){raiseEvent(this.eventNames.PreviewPreparedEventName,"","")};e.prototype.pauseResumePreview=function(d){this.flash.pauseResumePlayback(d)};e.prototype.getCurrentTime=
function(){return this.flash.getCurrentTime()};e.prototype.getDuration=function(){return this.flash.getDuration()};e.prototype.previewRecord=function(){this.flash.previewRecord()};e.prototype.deleteRecord=function(){this.flash.resetRecording()};e.prototype.uploadRecord=function(d,a){this.flash.saveRecording(a,d)};e.prototype.flashReady=function(d){var a=this;setTimeout(function(){d.flash=document.getElementById(d.flashId);if(d.flash){var b=$(d.flash).parent().width(),c=$(d.flash).parent().height();
$(d.flash).width(b).height(c);window.top.onresize=function(){var a=$(d.flash).parent().width();$(d.flash).width(a).height(c)};d.flash.init(d.flashId,b,c,d.settings.ShouldRecordVideo,a.eventNames.HasUserMediaAccessEventName,a.eventNames.RecordingPlaybackEndedEventName,a.eventNames.RecordingUploadCompletedEventName,a.name,a.settings.ShouldRecordVideo?a.settings.MaxSecondsVideo:a.settings.MaxSecondsAudio)}else $("."+a.settings.RecorderControlsClassName).hide()},750)};e.prototype.closeRecordingSession=
function(){this.flash.closeRecordingSession()};e.prototype.seek=function(d){this.flash.seek(d)};e.prototype.supportsSeek=function(){return!0};e.prototype.showAccessDenied=function(){window.top.jAlert?window.top.jAlert(this.settings.AccessDeniedErrorMessage,"",null):jAlert(this.settings.AccessDeniedErrorMessage,"",null)};e.prototype.confirmSwitchToAudio=function(){var d=this;this.showConfirmAudioSwitch(this.settings.ChangeToAudioRecorderMessage,function(a){a?(d.settings.ShouldRecordVideo=!1,d.flash.switchToAudio(),
$(document).trigger(d.eventNames.SwitchToAudioRecorderEventName)):$(document).trigger(d.eventNames.SwitchToUploadTabEventName)})};e.prototype.showConfirmAudioSwitch=function(d,a){var b=this.settings.UploadFileButtonText.replace(/(["])/g,"&quot;");window.top.jConfirm?(window.top.$.alerts.cancelButton=b,window.top.jConfirm(d,"",a)):($.alerts.cancelButton=b,jConfirm(d,"",a))};e.prototype.updateMaximumRecordingLength=function(d){$(document).trigger(this.eventNames.UpdateMaximumRecordingLength,d)};return e}();
f.FlashRecorder=e})(ItslearningWeb||(ItslearningWeb={}));function raiseEvent(f,e,k){$(document).trigger(f,[e,k])}function resizeAudioPlayer(f){$("#"+f).width(1).height(1)}function showAccessDenied(f){window[f].showAccessDenied()}function confirmSwitchToAudio(f){window[f].confirmSwitchToAudio()}function updateMaximumRecordingLength(f,e){window[f].updateMaximumRecordingLength(e)}
(function(f){(function(e){(function(e){e[e.SingleFile=1]="SingleFile";e[e.MultipleFiles=2]="MultipleFiles";e[e.MultipleFilesAndFolders=3]="MultipleFilesAndFolders"})(e.UploadType||(e.UploadType={}));(function(e){e[e.Pending=1]="Pending";e[e.InProgress=2]="InProgress";e[e.Success=3]="Success";e[e.Error=4]="Error";e[e.PartialSuccess=5]="PartialSuccess"})(e.UploadStatus||(e.UploadStatus={}))})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a,b){var c=this;this.settings=d;this.summaryParser=a;this.feedbackManager=b;this.handleInitialUploadSummary=function(a){a.IsProcessingInProgress?(c.feedbackManager.showInformationFeedback(c.settings.uploadInProgressMessage),c.wasPollingStarted=!0,c.checkStatusAfterInterval()):c.handleUploadsFinished(a)};this.checkStatusAfterInterval=function(){setTimeout(c.checkUploadStatus,c.settings.pollingIntervalInMilliseconds)};this.checkUploadStatus=
function(){$.getJSON(c.settings.statusServiceUrl,{folderId:c.settings.folderId}).then(c.handleSubsequentUploadSummary).fail(c.handleErrorResponse)};this.handleSubsequentUploadSummary=function(a){a.IsProcessingInProgress?c.checkStatusAfterInterval():c.handleUploadsFinished(a)};this.handleUploadsFinished=function(a){c.feedbackManager.hideInformationFeedback();c.summaryParser.isThereOnlyOneSingleFileUpload(a)?c.handleOneSingleFileUploadFinished(a):c.summaryParser.areThereAnyUploadsToHandle(a)&&c.handleManyFileUploadsFinished(a)};
this.handleOneSingleFileUploadFinished=function(a){c.summaryParser.areAllUploadsFinishedWithSuccess(a)?(a=c.summaryParser.getFileNamesForSingleFileUploads(a)[0],a=CCL.CommonFunctions.htmlEncode(a),a=c.settings.singleFileXUploadSuccessMessage.replace("{0}","<strong>"+a+"</strong>"),c.feedbackManager.showInformationFeedback(a),c.refreshTreeMenuIfNeeded()):c.feedbackManager.showErrorFeedback(c.settings.singleFileUploadErrorMessage)};this.handleManyFileUploadsFinished=function(a){c.summaryParser.areAllUploadsFinishedWithSuccess(a)?
c.displayMessageWithRefreshInstructionsIfNeeded(c.settings.multipleFileUploadSuccessMessage):c.summaryParser.areUploadsFinishedWithPartialSuccess(a)?c.displayMessageWithRefreshInstructionsIfNeeded(c.settings.partialSuccessMessage):c.feedbackManager.showErrorFeedback(c.settings.multipleFileUploadErrorMessage)};this.displayMessageWithRefreshInstructionsIfNeeded=function(a){c.shouldDisplayRefreshButton()?c.feedbackManager.showInformationFeedback("<strong>"+a+"</strong> "+c.settings.pleaseRefreshThePageToSeeThemMessage,
c.refreshElementsList):(c.refreshTreeMenuIfNeeded(),c.feedbackManager.showInformationFeedback(a))};this.shouldDisplayRefreshButton=function(){return c.wasPollingStarted};this.handleErrorResponse=function(a){401===a.status?c.redirectToLogOutPage():c.checkStatusAfterInterval()};this.redirectToLogOutPage=function(){window.top.location.replace(c.settings.logOutPageUrl)};this.refreshElementsList=function(){c.refreshTreeMenuIfNeeded();c.refreshWindow()};this.refreshTreeMenuIfNeeded=function(){if(c.settings.isTreeMenuRendered){var a=
new CCL.CommonWindowMessages.GenericMessage(c.settings.refreshTreeMenuPostMessageName);CCL.CommonFunctions.makePostMessageCall(window.parent,a)}};this.refreshWindow=function(){location.reload()};a.areThereAnyUploadsToHandle(d.initialSummary)&&this.handleInitialUploadSummary(d.initialSummary)}}();e.UploadStatusChecker=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a,b){var c=this;this.refreshButtonText=b;this.showInformationFeedback=function(a,b){var g={disableAutomaticHiding:!0};b&&(g.extraButtonName=c.refreshButtonText,g.extraButtonCallback=b);CCL.InformationFeedback.showFeedback(c.informationFeedbackContainer,a,g)};this.showErrorFeedback=function(a){CCL.CommonFunctions.isMobileDevice()?CCL.ErrorFeedback.showFeedback(c.errorFeedbackContainer,a,function(){}):(c.hideBottomNavigationBar(),CCL.ErrorFeedback.showFeedback(c.errorFeedbackContainer,
a,c.showBottomNavigationBar))};this.hideInformationFeedback=function(){CCL.InformationFeedback.hideFeedback(c.informationFeedbackContainer)};this.showBottomNavigationBar=function(){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.showBottomNavigationBar))};this.hideBottomNavigationBar=function(){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.hideBottomNavigationBar))};
this.informationFeedbackContainer=$("#"+d);this.errorFeedbackContainer=$("#"+a);if(!CCL.CommonFunctions.isMobileDevice())$(window).on("beforeunload",function(){c.showBottomNavigationBar()})}}();e.UploadStatusFeedbackManager=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){var d=this;this.areThereAnyUploadsToHandle=function(a){return a&&(a.IsProcessingInProgress||a.UploadInfos&&0<a.UploadInfos.length)};this.isThereOnlyOneSingleFileUpload=function(a){return a&&a.UploadInfos&&1===a.UploadInfos.length&&a.UploadInfos[0].UploadType===e.UploadType.SingleFile};this.areAllUploadsFinishedWithSuccess=function(a){return a&&a.UploadInfos&&0<a.UploadInfos.length&&a.UploadInfos.every(function(a){return a.Status===e.UploadStatus.Success})};
this.areUploadsFinishedWithPartialSuccess=function(a){return a&&a.UploadInfos&&(a.UploadInfos.some(function(a){return a.Status===e.UploadStatus.PartialSuccess})||a.UploadInfos.some(function(a){return a.Status===e.UploadStatus.Success})&&a.UploadInfos.some(function(a){return a.Status===e.UploadStatus.Error}))};this.getFileNamesForSingleFileUploads=function(a){return a&&a.UploadInfos?a.UploadInfos.filter(function(a){return a.UploadType===e.UploadType.SingleFile}).map(d.getSingleFileUploadFileName):
[]};this.getSingleFileUploadFileName=function(a){return a.Details&&a.Details.Name?a.Details.Name:""}}}();e.UploadSummaryParser=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){this.settings=a;this.elementLinkDialogManagerInstance=f.ElementLinkDialog.elementLinkDialogManagerInstance;e.learningObjectiveStateRepositoryManagerInstance=this;this.hasAnyChanges=!1}d.prototype.openDialog=function(a,b){var c=this,g=[];b={elementStates:this.getElementStates(b),disabledElementIds:b,showAll:!0,header:this.settings.Terms.Header,elementType:f.ElementLinkDialog.ContentElementType.LearningObjectives,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,
afterOkClickCallback:function(b){b&&(b.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||g.push(b)}),0<g.length&&(c.hasAnyChanges=!0,c.connectElementsToState(g,a)))},afterCloseDialogCallback:function(){c.hasAnyChanges&&setTimeout(function(){location.reload()},100)}};this.elementLinkDialogManagerInstance.openDialog(b,{countryCode:this.settings.CountryCode})};d.prototype.deleteLearningObjectivesFromState=function(a,b){$.ajax({type:"DELETE",
url:this.settings.Urls.DeleteLearningObjectivesFromState,data:{learningObjectiveId:a,stateId:b},dataType:"html"}).done(function(){location.reload()})};d.prototype.connectElementsToState=function(a,b){$.ajax({type:"PUT",url:this.settings.Urls.AddLearningObjectivesToState,data:{learningObjectiveIds:a,stateId:b},dataType:"html"}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.getElementStates=function(a){var b=new Map;$.each(a,function(a,g){b.set(g,f.CheckboxStateMachine.State.AttachedByUser)});
return b};return d}();e.LearningObjectiveStateRepositoryManager=k})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.dialogSelfClickHandler=function(a){a.stopPropagation();b.contextDialog.isOpened()&&window.setTimeout(function(){b.contextDialog.closeDialog()},100)};this.contextDialogControlId="#"+a.ContextDialogControlId;this.alignmentReportItemSelector=$(a.ReportItemSelector);this.contextDialogActivatorSelector=$(a.ContextDialogActivatorSelector);this.activeItemClassName=a.ActiveItemClassName;this.contextDialogContentContainerSelector=a.ContextDialogContentContainerSelector;
this.filterContainer=$(a.FilterContainerSelector);this.filterDataAttributeSuffix=a.FilterDataAttributeSuffix;this.itemsContainer=$(a.ItemsContainerSelector);this.measureViewAlignedUrl=a.MeasureViewAlignedUrl;this.measureViewNotAlignedUrl=a.MeasureViewNotAlignedUrl;this.measureViewAttachedDataUrl=a.MeasureViewAttachedDataUrl;this.initContextDialog();this.initReportItem();this.initFilter()}d.prototype.openContextDialog=function(a){this.contextDialog.isOpened()&&this.contextDialog.closeDialog();this.contextDialog.openDialogAt(a.x,
a.y)};d.prototype.initReportItem=function(){var a=this;this.contextDialogActivatorSelector.on("click",function(b){var c=$(b.currentTarget);c.addClass(a.activeItemClassName);var g=c.find(a.contextDialogContentContainerSelector).html();a.contextDialog.setContent(g);c=c.position();a.openContextDialog({x:c.left,y:c.top});a.contextDialog.setBeforeCloseDialog(function(){$(b.currentTarget).removeClass(a.activeItemClassName)});$.ajax(a.measureViewAttachedDataUrl)})};d.prototype.initContextDialog=function(){var a=
this;this.contextDialog=new ContextDialog(this.contextDialogControlId,{showHeader:!1,blackThemeActivated:!1,showCloseLink:!0,width:"404px",scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!0,marginTop:35,marginLeft:-2,marginRight:0,marginBottom:0,cssClass:"itsl-lo-alignment-report-context-dialog"});$(document).on({"contextdialog:show":function(){window.setTimeout(function(){a.contextDialog.mainContainer.on("click",a.dialogSelfClickHandler)},100)},"contextdialog:close":function(){a.contextDialog.mainContainer.off("click",
a.dialogSelfClickHandler)}})};d.prototype.initFilter=function(){var a=this,b=this.filterContainer.find("a[data-"+this.filterDataAttributeSuffix+"]"),c=b.map(function(b,c){return $(c).data(a.filterDataAttributeSuffix)}).get().join(" ");b.click(function(g){g=$(g.target);b.removeClass(a.activeItemClassName);g.addClass(a.activeItemClassName);g=g.data(a.filterDataAttributeSuffix);a.itemsContainer.removeClass(c).addClass(g);"filter-aligned"===g?$.ajax(a.measureViewAlignedUrl):"filter-not-aligned"===g&&
$.ajax(a.measureViewNotAlignedUrl)})};return d}();e.AlignmentReport=f})(f.LearningObjective||(f.LearningObjective={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this._settings=a;this._parameters=a.ParametersNames}d.prototype.browseLibrary=function(a){this.navigateTo(this._settings.BrowseLibraryUrl,a.RelatedEntityId,a.ElementCategory,a.CustomId,a.FolderId,a.LearningObjectivesIds)};d.prototype.navigateTo=function(a,b,c,g,d,e){void 0===d&&(d=0);void 0===e&&(e=[]);var h=window[this._settings.ModalId];b&&(a+="&"+this._parameters.RelatedEntityId+"="+b);c&&(a+="&"+this._parameters.ElementType+"="+c);g&&(a+=
"&"+this._parameters.CustomId+"="+g);e&&0<e.length&&(a+="&"+this._parameters.LearningObjectiveId+"="+e.join(","));d&&(a+="&"+this._parameters.FolderId+"="+d);h.setIframeUrl(a,!0);h.openDialog()};return d}();e.LibraryBrowser=f})(f.Library||(f.Library={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.settings=a;this.iframeHolders=$();this.loadEmbedContentDebouncer=new CCL.CallbackDebouncer(function(){return b.loadEmbedContentAsync()});this.loadEmbedContentTimeoutInMilliseconds=300;this.embedConsideredVisibleRatio=.2;this.loadEmbedContentAftercallTimes=5;this.embedIframeShowAnimationSpeedInMilliseconds=500;$(window).on(this.settings.isIosDevice?"touchmove":"scroll",function(){return b.loadEmbedContentDebouncer.invokeCallback(0,
b.loadEmbedContentTimeoutInMilliseconds)})}d.prototype.loadEmbedContentAsync=function(a){var b=this;void 0===a&&(a=-1);var c=this.getPendingIframeHolder();if(c){var g=this.createAjaxLoader();-1<a&&g.height(a);var d=this.createIframe(this.getEmbedIframeUrl(c),!1);this.findClosestEmbedBox(c).append(g);c.append(d);d.one("load",function(){d.fadeIn(b.embedIframeShowAnimationSpeedInMilliseconds);b.loadEmbedContentAftercallIterationNumber=1;b.loadEmbedContentDebouncer.invokeCallback(0,b.loadEmbedContentTimeoutInMilliseconds)})}else 0<
this.loadEmbedContentAftercallIterationNumber&&(this.loadEmbedContentDebouncer.invokeCallback(0,this.loadEmbedContentAftercallIterationNumber*this.loadEmbedContentTimeoutInMilliseconds),this.loadEmbedContentAftercallIterationNumber+=1,this.loadEmbedContentAftercallIterationNumber>this.loadEmbedContentAftercallTimes&&(this.loadEmbedContentAftercallIterationNumber=0))};d.prototype.findIframeHolders=function(a){return a.find("[data-"+this.settings.dataAttributes.embedIframeUrl+"]")};d.prototype.appendIframeHolders=
function(a){this.iframeHolders=this.iframeHolders.add(this.findIframeHolders(a))};d.prototype.getEmbedIframeUrl=function(a){return a.data(this.settings.dataAttributes.embedIframeUrl)};d.prototype.createAjaxLoader=function(){return $("<div class='"+this.settings.cssClasses.ajaxLoader+"'></div>")};d.prototype.createIframe=function(a,b){return $("<iframe src='"+a+"' width='100%' height='100%' scrolling='no' class='"+this.settings.cssClasses.noBorder+"' allowfullscreen "+(b?"":"style='display:none'")+
"></iframe>")};d.prototype.removeAjaxLoader=function(a){a.find("."+this.settings.cssClasses.ajaxLoader).remove()};d.prototype.isEmbedInProgress=function(a){return 0<a.find("."+this.settings.cssClasses.ajaxLoader).length};d.prototype.getPendingIframeHolder=function(){for(var a=0;a<this.iframeHolders.length;a++){var b=this.iframeHolders.eq(a),c=this.findClosestBulletinItem(b);if(!this.isEmbedInProgress(b)&&!d.isEmbedFinished(b)&&!this.isEmbedError(c)&&this.isOnScreen(c))return b}};d.isEmbedFinished=
function(a){return 0<a.find("iframe").length};d.prototype.isEmbedError=function(a){return 0<a.find("."+this.settings.cssClasses.oembedError).length};d.prototype.isOnScreen=function(a){return CCL.CommonFunctions.isOnScreen(a,this.embedConsideredVisibleRatio,this.embedConsideredVisibleRatio,this.settings.isIosDevice?window.parent:window)};d.prototype.findClosestEmbedBox=function(a){return a.closest(this.settings.selectors.embedBox)};d.prototype.findClosestBulletinItem=function(a){return a.closest(this.settings.selectors.bulletinItem)};
return d}();e.EmbedAsynchronousLoader=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=f.Controls.Validation.ValidatorFactory,d=f.Controls.Validation.DateTimePickerValidatorFactory,a=function(){function a(a){var b=this;this.utility=a;a=function(){return b.activeFrom.setDateTime(b.currentStrategyValue.activeFromDate)};this.runCheckOnBlurEvent(this.activeFrom,k.until(d.invalidDateDenyEmptyNoHighlight(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat,a),k.checkNoHighlight(this.activeFrom,function(){return b.activeFrom.getDateTime()<b.activeFrom.minDate},
"",a)));this.runCheckOnBlurEvent(this.activeTo,k.until(d.invalidDateAllowEmptyNoHighlight(this.activeTo,this.utility.settings.Resources.InvalidDateFormat,function(){return b.activeTo.setDateTime(b.currentStrategyValue.activeToDate&&b.currentStrategyValue.activeToDate<b.activeTo.minDate?b.activeTo.minDate:b.currentStrategyValue.activeToDate)}),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeTo.minDate},this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate,
void 0)))}Object.defineProperty(a.prototype,"currentStrategy",{set:function(a){this.currentStrategyValue=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeFrom",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeTo",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},enumerable:!0,configurable:!0});a.prototype.validateDates=function(){return k.all(d.invalidDateDenyEmpty(this.activeFrom,
this.utility.settings.Resources.InvalidDateFormat),k.until(d.invalidDateAllowEmpty(this.activeTo,this.utility.settings.Resources.InvalidDateFormat),d.compareDates(k.lessThanOrEqual,this.activeTo,this.activeFrom.getDateTime(),this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate)))()};a.prototype.runCheckOnBlurEvent=function(a,b){$(a).on("blur",function(){return b()})};return a}();e.ScheduleDialogInputValidator=a})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var f=function(){function d(a,b){this.inputValidator=b;this.utilityValue=a;this.activeFromPickerInstance.dependentPicker=this.activeToPickerInstance}Object.defineProperty(d.prototype,"activeFromDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeToDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"strategicData",
{get:function(){return this.strategicDataValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"utility",{get:function(){return this.utilityValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeFromPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeToPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},
enumerable:!0,configurable:!0});d.prototype.loadDialogState=function(a,b){this.strategicDataValue=b;this.inputValidator.currentStrategy=this;this.utility.syncronizeDateTimePicker(this.activeFromPickerInstance);this.activeFromPickerInstance.toggleValidationError({isInvalid:!1});this.activeToPickerInstance.toggleValidationError({isInvalid:!1});this.loadDialogStateDone(a)};d.prototype.persistDialogState=function(){this.inputValidator.validateDates()&&(this.persistValidatedDialogState(),this.inputValidator.currentStrategy=
void 0)};d.prototype.loadDialogStateDone=function(a){throw Error("Abstract method should be overriden");};d.prototype.persistValidatedDialogState=function(){throw Error("Abstract method should be overriden");};return d}();e.ScheduleDialogBaseStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){d.call(this,a,c);this.resetStorage()}__extends(a,d);Object.defineProperty(a.prototype,"activeFromDate",{get:function(){return this.storage.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeToDate",{get:function(){return this.storage.activeTo},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeFrom",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom)},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeTo",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)},enumerable:!0,configurable:!0});a.prototype.resetStorage=function(){this.storage={activeFrom:void 0,activeTo:void 0}};a.prototype.loadDialogStateDone=function(a){a.OkButton.val(this.utility.settings.Resources.ApplyButtonText);a=this.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;this.storage.activeFrom=!this.storage.activeFrom||
this.storage.activeFrom<a?a:this.storage.activeFrom;this.activeFromPickerInstance.minDate=a;this.activeFromPickerInstance.setDateTime(this.storage.activeFrom);this.activeToPickerInstance.setDateTime(this.storage.activeTo)};a.prototype.persistValidatedDialogState=function(){this.storage={activeFrom:this.activeFromPickerInstance.getDateTime(),activeTo:this.activeToPickerInstance.getDateTime()};this.storage.activeFrom||this.storage.activeTo?this.utility.ajaxClient.getTimeSpan({ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom),
ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)}).done(this.strategicData.onSuccess).always(CssModal.closeDialog):CssModal.closeDialog()};return a}(e.ScheduleDialogBaseStorageStrategy);e.ScheduleDialogTemporaryStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function a(a,c){d.call(this,a,c)}__extends(a,d);Object.defineProperty(a.prototype,"activeFromDate",{get:function(){return this.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeToDate",{get:function(){return this.activeTo},enumerable:!0,configurable:!0});a.prototype.loadDialogStateDone=function(a){var b=this;a.OkButton.val(this.utility.settings.Resources.OkButtonText);this.activeFromPickerInstance.setDateTime(void 0);this.activeToPickerInstance.setDateTime(void 0);
this.activeTo=this.activeFrom=void 0;this.utility.ajaxClient.getSchedule(this.strategicData.lightBulletinId).done(function(a){b.activeFrom=CCL.SerializableDateTimeConverter.toDate(a.ActiveFrom);b.activeTo=CCL.SerializableDateTimeConverter.toDate(a.ActiveTo);b.activeFromPickerInstance.setDateTime(b.activeFrom);b.activeFromPickerInstance.minDate=CCL.SerializableDateTimeConverter.toDate(a.Created);b.activeToPickerInstance.setDateTime(b.activeTo)})};a.prototype.persistValidatedDialogState=function(){this.utility.ajaxClient.updateSchedule(this.strategicData.lightBulletinId,
{ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.activeFromPickerInstance.getDateTime()),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.activeToPickerInstance.getDateTime())},this.strategicData.bulletinsDisplayMode).done(this.strategicData.onSuccess).always(CssModal.closeDialog)};return a}(e.ScheduleDialogBaseStorageStrategy);e.ScheduleDialogAjaxStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a}Object.defineProperty(d.prototype,"areCommentsDisabledForNewBulletins",{get:function(){return this.areCommentsDisabledForNewBulletinsValue},set:function(a){this.areCommentsDisabledForNewBulletinsValue=a;this.utility.controls.AddMenu.ToggleCommentsOptionSpan.text(this.getToggleCommentsTerm(a));this.utility.controls.CommentsAvailabilityStatusPlaceHolder.toggle(a)},enumerable:!0,configurable:!0});d.prototype.resetCommentsDisabledForNewBulletins=
function(){this.areCommentsDisabledForNewBulletins=this.utility.settings.DisableLightBulletinCommentsDefaultValue};d.prototype.togglePossibilityToAddComments=function(a,b){CCL.DomElementClass.GetInstanceForElement(a.CommentControlClientInstanceName).togglePossibilityToAddComments(!a.DisableComments);b.text(this.getToggleCommentsTerm(a.DisableComments))};d.prototype.getToggleCommentsTerm=function(a){return a?this.utility.settings.Resources.EnableComments:this.utility.settings.Resources.DisableComments};
return d}();e.LightBulletinCommentToggler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.scrollTopTimeoutMilliseconds=200;this.animationTimeInMilliseconds=a.animationTimeInMilliseconds}d.prototype.animateShow=function(a,b){a.slideDown(this.animationTimeInMilliseconds,function(){b&&b();a.css("overflow","")})};d.prototype.animateHideAndRemove=function(a,b){this.animateHide(a,function(){a.remove();b&&b()})};d.prototype.animateScrollTop=function(a,b,c){var g=this;void 0===c&&(c=!1);setTimeout(function(){$("html, body").animate({scrollTop:a},
{duration:c?0:g.animationTimeInMilliseconds,complete:b})},this.scrollTopTimeoutMilliseconds)};d.prototype.animateHide=function(a,b){a.slideUp(this.animationTimeInMilliseconds,b)};return d}();e.LightBulletinAnimator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LightBulletin||(f.LightBulletin={});f=f.LightBulletinConstants||(f.LightBulletinConstants={});f.maxCountOfAddedElements=50;f.animationTimeInMilliseconds=250;f.watchEmbedsPasteTimeoutInMilliseconds=50;f.watchEmbedsKeyUpTimeoutInMilliseconds=1500;f.renderShowMoreDelayInMilliseconds=500;f.domainPartOfEmailRegexParams={regex:/(^|\s)[^a-z0-9._%+-]*(@[a-z0-9.-]+\.[a-z]{2,3})/ig,replaceGroupIndex:1}})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a){this.utility=a;this.elementStates=new Map;this.settings=a.settings;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.newsContentBlock=this.utility.controls.Container.parents("."+this.settings.CssClasses.WidgetCbNews)}d.prototype.onResourceButtonClick=function(a,b,c,g,d){var h=this,m=this.elementStates.has(a)?this.elementStates.get(a):this.initiallyLoadElementStatesFromUi(a,b),k={locationId:this.settings.CourseId,locationType:this.settings.LocationTypeCourse};
f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog({elementStates:f.MapUtils.makeCopy(m),afterOkClickCallback:function(e){return h.onDialogAddButtonClick(a,b,f.MapUtils.makeCopy(e),c,g,d)},afterCloseDialogCallback:function(){h.utility.animator.animateScrollTop(0<a?b.offset().top:h.newsContentBlock.offset().top,function(){return b.find("."+h.settings.CssClasses.EditorTextarea).focus()},h.settings.IsIeBrowser)},maxCountOfAddedElements:e.LightBulletinConstants.maxCountOfAddedElements,elementType:f.ElementLinkDialog.ContentElementType.All,
showAll:!0,header:this.settings.Resources.ElementLinkDialogHeader,allowFolderSelection:!0},k)};d.prototype.onDetachResourceButtonClick=function(a,b,c,g){var d=c.data(this.settings.DataAttributes.ElementLinkElementId);this.elementStates.has(a)||this.elementStates.set(a,this.initiallyLoadElementStatesFromUi(a,b));var e=this.elementStates.get(a),m=e.get(d);m=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,m);e.set(d,m);m===f.CheckboxStateMachine.State.Empty?(c.remove(),g()):m===
f.CheckboxStateMachine.State.DetachedByUser&&this.hideWhenEditOrRemoveWhenNew(a,c,g);this.toggleDetailedView(this.utility.getElementLinkList(this.utility.getCurrentBulletinItemOrNew(b)))};d.prototype.resetUnsavedElementLinks=function(a,b){if(this.elementStates.has(a)){var c=this.utility.getElementLinkList(b),g=[],d=[];this.forEachElementState(a,function(a,b){a===f.CheckboxStateMachine.State.AttachedByUser?g.push(b):a===f.CheckboxStateMachine.State.DetachedByUser&&d.push(b)});a=this.elementStates.get(a);
var e=void 0;for(e=0;e<g.length;e++){var m=g[e];c.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+m+'"]').remove();a.delete(m)}for(e=0;e<d.length;e++)m=d[e],this.utility.animator.animateShow(c.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+m+'"]')),a.set(m,f.CheckboxStateMachine.State.Saved);this.toggleDetailedView(this.utility.getElementLinkList(b))}};d.prototype.getElementIdsForBulletin=function(a){var b=[],c=[];this.forEachElementState(a,function(a,d){a===
f.CheckboxStateMachine.State.AttachedByUser?b.push(d):a===f.CheckboxStateMachine.State.DetachedByUser&&c.push(d)});return{elementsToAttach:b,elementsToDetach:c}};d.prototype.cleanAppendData=function(a,b){var c=this;if(0===a)this.elementStates.delete(a);else{var g=this.elementStates.get(a),d=[];this.forEachElementState(a,function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.DetachedByUser||d.push(b)});var e=this.utility.getElementLinkList(b);d.forEach(function(a){var b=
c.checkboxStateMachine.transferElementStateAfterSave(g.get(a));g.set(a,b);b===f.CheckboxStateMachine.State.Empty&&e.find("[data-"+c.settings.DataAttributes.ElementLinkElementId+'="'+a+'"]').remove()})}};d.prototype.onDialogAddButtonClick=function(a,b,c,g,d,l){var h=this;d();this.elementStates.set(a,c);var k=this.utility.getElementLinkList(b);0===k.length&&(k=$(this.utility.controls.Container.data(this.settings.DataAttributes.ElementLinkList)),b.find("[data-"+this.settings.DataAttributes.ElementLinkAppendTarget+
"]").append(k));var p=[],n=[];this.forEachElementState(a,function(b,c){var g=k.find("[data-"+h.settings.DataAttributes.ElementLinkElementId+'="'+c+'"]');switch(b){case f.CheckboxStateMachine.State.Empty:g.remove();break;case f.CheckboxStateMachine.State.AttachedByUser:0===g.length?n.push(c):p.push(c);break;case f.CheckboxStateMachine.State.Saved:h.utility.animator.animateShow(g);p.push(c);break;case f.CheckboxStateMachine.State.DetachedByUser:h.hideWhenEditOrRemoveWhenNew(a,g)}});0<n.length?this.utility.ajaxClient.elementLinkItemsContent(n).done(function(a){a&&
(k.append($(a)),h.sortElementLinks(k),h.toggleDetailedView(k),b.find("."+h.settings.CssClasses.ElementLinkDelete).show(),l&&l())}).fail(function(a,b,c){g();CCL.CommonFunctions.alertAjaxError(a,b,c)}):this.toggleDetailedView(k);n.length+p.length>=e.LightBulletinConstants.maxCountOfAddedElements&&this.utility.toggler.toggleResourceButton(b,!1)};d.prototype.sortElementLinks=function(a){var b=this;a.children("li").get().sort(function(a,g){var c=b.settings.IsElementListSortOrderAscending?g:a,d="data-"+
b.settings.DataAttributes.ElementLinkListItemSortExpression;return $(b.settings.IsElementListSortOrderAscending?a:g).attr(d).localeCompare($(c).attr(d))}).forEach(function(b){a.append(b)})};d.prototype.toggleDetailedView=function(a){a=a.children("li").removeClass(this.settings.CssClasses.ElementLinkListItemDetailedView).filter(":visible");1===a.length&&a.addClass(this.settings.CssClasses.ElementLinkListItemDetailedView)};d.prototype.initiallyLoadElementStatesFromUi=function(a,b){var c=this,g=new Map;
this.utility.getElementLinkList(b).children("li").each(function(a,b){a=$(b).data(c.settings.DataAttributes.ElementLinkElementId);g.set(a,f.CheckboxStateMachine.State.Saved)});this.elementStates.set(a,g);return g};d.prototype.forEachElementState=function(a,b){(a=this.elementStates.get(a))&&a.forEach(b)};d.prototype.hideWhenEditOrRemoveWhenNew=function(a,b,c){0===a?b.remove():b.hide();"function"===typeof c&&c()};return d}();e.ElementLinkBuilder=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.oembedErrorCssClasses=a;this.oembedErrorResources=b;this.linkParser=new CCL.LinkParser}d.prototype.hasOembedError=function(a){return 0!==a.find("."+this.oembedErrorCssClasses.OembedBoxError).length};d.prototype.generateOembedError=function(a,b,c,g){var d=this;a.oembedPlaceHolder.find("iframe").remove();var e=$("<a>").prop("target","_blank").prop("href",a.originalEmbedCode).text(this.linkParser.getDomain(a.originalEmbedCode));e=CCL.CommonFunctions.formatString(this.oembedErrorResources.OembedErrorMessage,
e.get(0).outerHTML);e=$('<div class="'+this.oembedErrorCssClasses.OembedErrorContentBlock+'"></div>').append('<p class="'+this.oembedErrorCssClasses.OembedErrorTitle+'">'+this.oembedErrorResources.OembedErrorTitle+"</p>").append('<span class="'+this.oembedErrorCssClasses.OembedErrorMessage+'">'+e+"</span>").append("<br />").append($('<a href="javascript:void(0);" class="'+this.oembedErrorCssClasses.OembedErrorTryAgain+'">'+this.oembedErrorResources.OembedErrorTryAgain+"</a>").on("click",function(h){var e=
"function"===typeof c?c():0,f=a.oembedPlaceHolder.find("."+d.oembedErrorCssClasses.OembedBoxError),l=f.outerHeight();f.remove();a.oembedPlaceHolder.find("iframe").remove();b.loadEmbedContentAsync(l+e);"function"===typeof g&&g();h.preventDefault()}));return $('<div class="'+this.oembedErrorCssClasses.OembedBoxError+" "+this.oembedErrorCssClasses.Clearfix+'"></div>').append('<span class="'+this.oembedErrorCssClasses.OembedErrorImageBox+'"></span>').append(e)};return d}();e.EmbedError=f})(f.LightBulletin||
(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a;this.settings=a.settings;this.controls=a.controls}d.prototype.getBulletinEditor=function(a){return this.utility.isAddMode(a)?this.controls.NewBulletinText:a.data(d.bulletinEditorDataAttribute)};d.prototype.getBulletinEditorInstance=function(a){return a.data(d.bulletinEditorInstanceDataAttribute)};d.prototype.makeEditorAutoResizable=function(a){setTimeout(function(){return a.autogrow()})};d.prototype.createBulletinEditor=function(a){var b=
new e.LightBulletinEditorInstance(this.utility,a);a.data(d.bulletinEditorInstanceDataAttribute,b);return b};d.prototype.removeBulletinEditorInstanceDataAttribute=function(a){a.removeData(d.bulletinEditorInstanceDataAttribute)};d.prototype.resetEditor=function(a,b){a.removeAttr("style");b&&a.focus();this.utility.watchEmbeds.watchEmbeds(a)};d.bulletinEditorDataAttribute="bulletinEditor";d.bulletinEditorInstanceDataAttribute="bulletinEditorInstance";return d}();e.LightBulletinEditor=f})(f.LightBulletin||
(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.utility=a;this.bulletinItem=b;a=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorButtonsTemplate));this.editor=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorTemplate));this.editorButtons=a;this.cancelButton=a.find(this.utility.selectors.cancelEditAction);this.applyButton=a.find(this.utility.selectors.applyEditAction);this.bulletinId=
this.utility.getBulletinId(b)}d.prototype.removeBulletinEditor=function(){this.bulletinItem.find("[data-"+this.utility.settings.DataAttributes.BulletinItemEditorTarget+"]").children().remove();this.editorButtons.remove()};return d}();e.LightBulletinEditorInstance=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a}d.prototype.applyNewImageLoadingComplete=function(a){var b=this,c=this.filterNewImageBoxes(this.utility.getImageBox(a));this.utility.getImage(c).one("load",function(){return c.removeClass(b.utility.settings.CssClasses.ImageBoxLoading)})};d.prototype.hideOrRemoveImageBoxFromContainer=function(a){this.hideOrRemoveImageBox(this.utility.getImageBox(a))};d.prototype.hideOrRemoveImageBox=function(a){this.filterNewImageBoxes(a).remove();
this.filterNotNewImageBoxes(a).hide()};d.prototype.resetUnsavedImage=function(a){var b=this.utility.getImageBox(a);this.filterNewImageBoxes(b).remove();this.filterNotNewImageBoxes(b).show();this.removeImageError(a);this.clearAddImageButtonFileInputValue(a)};d.prototype.getParsedUploadResult=function(a){return this.parseSerialzedImageData(this.filterNewImageBoxes(this.utility.getImageBox(a)).last().find("input[type='hidden']"))};d.prototype.getDeleteAttachedImageValue=function(a){a=this.utility.getImageBox(a);
var b;return 0===this.filterNewImageBoxes(a).length&&0<(b=this.filterNotNewImageBoxes(a)).length&&b.length===b.not(":visible").length};d.prototype.applyImageEditsIfNeeded=function(a,b){var c=this.utility.getImageBox(a),g=this.filterNewImageBoxes(c);c=this.filterNotNewImageBoxes(c);var d=c.filter(":hidden");0<g.length&&(c.remove(),this.utility.setImageIsNew(g,!1),b&&g.find("[data-"+this.utility.settings.DataAttributes.BulletinAttachedImageLink+"]").prop("href",b));0<d.length&&d.remove();this.removeImageError(a)};
d.prototype.removeImageError=function(a){this.utility.getImageError(a).remove()};d.prototype.addImageButtonFileInputHasValue=function(a){return!!a.find(this.utility.selectors.addImageButtonFileInput).val()&&0<this.utility.getVisibleImageBox(a).length};d.prototype.clearAddImageButtonFileInputValue=function(a){a.find(this.utility.selectors.addImageButtonFileInput).val("")};d.prototype.filterNewImageBoxes=function(a){var b=this;return a.filter(function(a,g){return b.utility.getImageIsNew($(g))})};d.prototype.filterNotNewImageBoxes=
function(a){var b=this;return a.filter(function(a,g){return!b.utility.getImageIsNew($(g))})};d.prototype.parseSerialzedImageData=function(a){return 0<a.length?CCL.CommonFunctions.safeParseJson(a.val()):void 0};return d}();e.LightBulletinImageBox=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){this.fragments=[];this.createPlaceholder=function(a){return"@@LightBulletinTextObfuscator"+a+"@@"}}d.prototype.replaceTextFragmentsWithPlaceholders=function(a,b){var c=this;return a.replace(b.regex,function(a){for(var g=[],d=1;d<arguments.length;d++)g[d-1]=arguments[d];g=g[b.replaceGroupIndex];d=c.createPlaceholder(c.fragments.length);c.fragments.push(g);return a.replace(g,d)})};d.prototype.replacePlaceholdersWithTextFragments=function(a){var b=
this;a=this.fragments.reduce(function(a,g,d){return a.replace(b.createPlaceholder(d),g)},a);this.fragments=[];return a};return d}();e.LightBulletinTextObfuscator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.utility=a;this.watchEmbedsDebouncer=new CCL.CallbackDebouncer(function(a){return b.switchWatchEmbeds(a.element,a.enabled)});this.initContextDialog()}d.prototype.toggleOembedEditClasses=function(a,b){a.find("."+this.utility.settings.CssClasses.OembedBoxHeader).toggle(!b.isViewMode);this.utility.getVisibleOembedBox(a).toggleClass(this.utility.settings.CssClasses.OembedBoxEditMode,!b.isViewMode&&!b.isEmbedInProgress)};d.prototype.toggleAddBulletinMenu=
function(a){this.utility.controls.AddMenu.LinkContainer.toggle(a)};d.prototype.switchWatchEmbeds=function(a,b){this.utility.watchEmbeds.switchWatchEmbedsInBulletinItem(a,b)};d.prototype.togglePostNewBulletinTooltip=function(a,b){var c=this,g,d,e=function(a){clearTimeout(d);clearTimeout(g);d=setTimeout(function(){c.toolTip.isTooltipOpened()&&c.toolTip.closeTooltip()},a)},f=function(b){clearTimeout(d);clearTimeout(g);g=setTimeout(function(){c.toolTip.isTooltipOpened()||c.toolTip.openTooltip(a,{my:"center bottom",
at:"center top-10",arrow:"top"})},b)};if(b)a.parent().on("mouseover",function(){return f(300)}).on("mouseleave",function(){return e(300)});else e(0),a.parent().off("mouseover mouseleave")};d.prototype.toggleResourceButton=function(a,b){this.utility.getCurrentBulletinItemOrNew(a).find(this.utility.selectors.addResourceAction).toggleHyperlink(b)};d.prototype.toggleAddEditButton=function(a,b){this.utility.getAddEditButton(a).toggleHyperlink(b)};d.prototype.toggleAddImageButton=function(a,b){a=this.utility.getAddImageButton(a);
a.toggleHyperlink(b);a.find(this.utility.selectors.addImageButtonFileInput).toggle(b)};d.prototype.toggleControlsInBulletin=function(a,b){var c=this.utility.getAddEditButton(a);this.utility.isAddMode(a)?(c.toggleHyperlink(b.canBePosted),this.togglePostNewBulletinTooltip(c,!b.passedEmptyTextValidation)):c.toggleHyperlink(!b.isEmbedInProgress);this.toggleAttachingActionsToBulletin(a,b)};d.prototype.toggleAttachingActionsToBulletin=function(a,b){a=this.utility.getCurrentBulletinItemOrNew(a);this.toggleResourceButton(a,
!(b.hasVisibleOembedBox||b.isEmbedInProgress||b.maxCountOfAddedElementsReached||b.hasVisibleImage));var c=b.hasVisibleOembedBox||b.isEmbedInProgress||b.hasAttachedElementLinks||b.hasVisibleImage;this.toggleAddImageButton(a,!(b.hasVisibleOembedBox||b.isEmbedInProgress||b.hasAttachedElementLinks));this.watchEmbedsDebouncer.invokeCallback({element:a,enabled:!c},500)};d.prototype.toggleBulletinAttachmentButtons=function(a,b){this.toggleResourceButton(a,b);this.toggleAddImageButton(a,b)};d.prototype.initContextDialog=
function(){this.toolTip=new CCL.CustomToolTip("lightBulletinToolTip",{contentContainer:this.utility.controls.CustomTooltip,zIndex:1},this.utility.settings.CustomTooltipCssClasses);this.utility.controls.CustomTooltip.show()};return d}();e.LightBulletinToggler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){f.linkifyNodes=function(d){var a=new e.LightBulletinTextObfuscator;d.each(function(b,c){c.innerHTML=a.replaceTextFragmentsWithPlaceholders(c.innerHTML,e.LightBulletinConstants.domainPartOfEmailRegexParams);c.innerHTML=linkifyHtml(c.innerHTML);c.innerHTML=a.replacePlaceholdersWithTextFragments(c.innerHTML)})}})(e.LightBulletinLinkifyWrapper||(e.LightBulletinLinkifyWrapper={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b,c,g){this.controls=a;this.settings=b;this.initSelectors();this.initClasses(c,g)}d.prototype.syncronizeDateTimePicker=function(a){var b=this;a.dateTimeSynchronizer=this.dateTimeSynchronizer;this.dateTimeSynchronizer.isSynchronizeNeeded&&this.ajaxClient.getCurrentDateTime().done(function(a){return b.dateTimeSynchronizer.synchronize(CCL.SerializableDateTimeConverter.toDateWithSeconds(a))})};d.prototype.validateBulletinAndToggleControls=function(a){var b=
this.textValidator.validateBulletin(this.editor.getBulletinEditor(a),this.getCurrentBulletinItemOrNew(a));this.toggler.toggleControlsInBulletin(a,b);this.isAddMode(a)&&this.toggler.toggleAddBulletinMenu(b.passedEmptyTextValidation);return b};d.prototype.linkifyTextNodes=function(a){this.linkifyNodes(a.find("[data-"+this.settings.DataAttributes.Text+"]"))};d.prototype.linkifyNodes=function(a){e.LightBulletinLinkifyWrapper.linkifyNodes(a)};d.prototype.isAddMode=function(a){return 0===a.length||a.get(0)===
this.controls.NewBulletinItem.get(0)};d.prototype.isViewMode=function(a){return 0===this.getAddEditButton(a).length};d.prototype.getBulletinId=function(a){return a.data(this.settings.DataAttributes.BulletinId)||0};d.prototype.getBulletinById=function(a){return this.controls.Container.find("[data-"+this.settings.DataAttributes.BulletinId+"='"+a+"']")};d.prototype.findBulletinItemByChild=function(a){return a.closest(this.selectors.bulletinItem)};d.prototype.getCurrentBulletinItemOrNew=function(a){return this.isAddMode(a)?
this.controls.NewBulletinItem:a};d.prototype.getAddEditButton=function(a){return this.isAddMode(a)?this.controls.PostNewBulletin:a.find(this.selectors.applyEditAction)};d.prototype.getAddImageButton=function(a){return this.getCurrentBulletinItemOrNew(a).find(this.selectors.addImageButton)};d.prototype.removeBulletin=function(a){this.animator.animateHideAndRemove(a.closest("li"))};d.prototype.getOembedBox=function(a){return a.find("."+this.settings.CssClasses.OembedBox)};d.prototype.getVisibleOembedBox=
function(a){return this.getOembedBox(a).filter(":visible")};d.prototype.hasVisibleOembedBox=function(a){return 0<this.getVisibleOembedBox(a).length};d.prototype.getHiddenOembedBox=function(a){return this.getOembedBox(a).filter(":hidden")};d.prototype.getImageBox=function(a){return a.find("."+this.settings.CssClasses.ImageBox)};d.prototype.getImageError=function(a){return a.find("."+this.settings.CssClasses.ImageError)};d.prototype.getVisibleImageBox=function(a){return this.getImageBox(a).filter(":visible")};
d.prototype.hasVisibleImage=function(a){return 0<this.getVisibleImageBox(a).length};d.prototype.getHiddenImageBox=function(a){return this.getImageBox(a).filter(":hidden")};d.prototype.hasHiddenImage=function(a){return 0<this.getHiddenImageBox(a).length};d.prototype.getImageIsNew=function(a){return a.data(this.settings.DataAttributes.ImageIsNew)};d.prototype.setImageIsNew=function(a,b){a.data(this.settings.DataAttributes.ImageIsNew,b)};d.prototype.getImage=function(a){return a.find("[data-"+this.settings.DataAttributes.BulletinAttachedImage+
"]")};d.prototype.getTimeSpan=function(a){return a.find("."+this.settings.CssClasses.TimeSpan)};d.prototype.getAuthorContainer=function(a){return a.find("."+this.settings.CssClasses.Author)};d.prototype.hasOembedAttachedOrLoading=function(a,b){a=this.getCurrentBulletinItemOrNew(a);return this.hasVisibleOembedBox(a)||b.isEmbedInProgress(a)};d.prototype.getElementLinkList=function(a){return a.find("[data-"+this.settings.DataAttributes.ElementLinkList+"]")};d.prototype.countResourcesOnUi=function(a){return this.getElementLinkList(this.getCurrentBulletinItemOrNew(a)).find("li").filter(":visible").length};
d.prototype.initSelectors=function(){this.selectors={applyEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionApplyEditValue+'"]',addResourceAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionAddResourceValue+'"]',cancelEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionCancelEditValue+'"]',bulletinItem:"[data-"+this.settings.DataAttributes.BulletinId+
"]",mediaAppendTarget:"[data-"+this.settings.DataAttributes.MediaAppendTarget+"]",addImageButton:"."+this.settings.CssClasses.AddImageButton,addImageButtonFileInput:"."+this.settings.CssClasses.AddImageButtonFileInput,lightBulletinActionDropDownItem:"[data-"+this.settings.SingleItemDataDataAttributes.LightBulletinActionDropDownItem+"]"}};d.prototype.initClasses=function(a,b){this.editor=new e.LightBulletinEditor(this);this.watchEmbeds=new e.LightBulletinWatchEmbeds(a,this);this.imageBox=new e.LightBulletinImageBox(this);
this.toggler=new e.LightBulletinToggler(this);this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.embedAsynchronousLoader=new e.EmbedAsynchronousLoader({isIosDevice:this.settings.IsIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+this.settings.CssClasses.OembedBox+":visible",bulletinItem:this.selectors.bulletinItem},
dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.textValidator=new e.LightBulletinTextValidator(this);this.ajaxClient=new e.LightBulletinAjaxClient(this.settings,b);this.animator=new e.LightBulletinAnimator({animationTimeInMilliseconds:e.LightBulletinConstants.animationTimeInMilliseconds});this.commentToggler=new e.LightBulletinCommentToggler(this);this.elementLinkBuilder=new e.ElementLinkBuilder(this);this.oembedError=new e.EmbedError(this.settings.OembedErrorCssClasses,
this.settings.OembedErrorResources);this.linkParser=new CCL.LinkParser;this.dateTimeSynchronizer=new f.Controls.DateTimeSynchronizer(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.settings.Today));this.singleItemDataManager=new e.LightBulletinSingleItemDataManager(this.settings.SingleItemDataDataAttributes,this.settings.SingleItemDataResources)};return d}();e.LightBulletinUtility=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.utility=b;this.tryAgainBulletinIds=[];this.watchEmbedsPasteHandler=function(a){c.embedCallbackDebouncer.invokeCallback($(a.currentTarget),e.LightBulletinConstants.watchEmbedsPasteTimeoutInMilliseconds)};this.watchEmbedsKeyUpHandler=function(a){var b=$(a.currentTarget);a.which===CCL.CommonConstants.keyCodes.space||a.which===CCL.CommonConstants.keyCodes.enter?c.embedCallbackDebouncer.invokeCallback(b,0):c.embedCallbackDebouncer.invokeCallback(b,
e.LightBulletinConstants.watchEmbedsKeyUpTimeoutInMilliseconds)};this.embedCallbackDebouncer=new CCL.CallbackDebouncer(a)}d.prototype.switchWatchEmbedsInBulletinItem=function(a,b){b?this.watchEmbedsInBulletinItem(a):this.stopWatchEmbedsInBulletinItem(a)};d.prototype.watchEmbedsInBulletinItem=function(a){a=this.utility.editor.getBulletinEditor(a);this.watchEmbeds(a)};d.prototype.watchEmbeds=function(a){a&&(this.stopWatchEmbeds(a),a.on("paste",this.watchEmbedsPasteHandler).keyup(this.watchEmbedsKeyUpHandler))};
d.prototype.stopWatchEmbedsInBulletinItem=function(a){a=this.utility.editor.getBulletinEditor(a);this.stopWatchEmbeds(a)};d.prototype.stopWatchEmbeds=function(a){a.off("paste",this.watchEmbedsPasteHandler).off("keyup",this.watchEmbedsKeyUpHandler)};d.prototype.shouldAppendOembedError=function(a){var b=a.oembedPlaceHolder;if(this.utility.oembedError.hasOembedError(a.oembedPlaceHolder))return!1;a=this.utility.findBulletinItemByChild(b);var c=this.utility.getBulletinId(a);return-1===this.tryAgainBulletinIds.indexOf(c)&&
(this.utility.isAddMode(a)||b.data(this.utility.settings.DataAttributes.OembedIsNew))?(b.remove(),!1):0>=this.utility.countResourcesOnUi(a)};d.prototype.appendOembedError=function(a){var b=this,c=a.oembedPlaceHolder,g=this.utility.findBulletinItemByChild(c),d=this.utility.getBulletinId(g),e=this.tryAgainBulletinIds.indexOf(d);-1!==e&&(c.data(this.utility.settings.DataAttributes.OembedIsNew,!1),this.tryAgainBulletinIds.splice(e,1));c.append(this.utility.oembedError.generateOembedError(a,this.utility.embedAsynchronousLoader,
function(){b.tryAgainBulletinIds.push(d);var c=a.oembedPlaceHolder.outerHeight();b.utility.toggler.toggleOembedEditClasses(g,{isViewMode:b.utility.isViewMode(g),isEmbedInProgress:!0});c-=a.oembedPlaceHolder.outerHeight();b.utility.linkParser.removeFromSkipUrl(a.originalEmbedCode);return c},function(){b.utility.isViewMode(g)||b.utility.validateBulletinAndToggleControls(g)}));c.removeClass(this.utility.settings.CssClasses.OembedBoxLoading)};return d}();e.LightBulletinWatchEmbeds=f})(f.LightBulletin||
(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.modalDialog=window[this.dialogId];this.controls.OkButton.click(function(a){a.preventDefault();b.currentStrategy.persistDialogState()})}Object.defineProperty(a.prototype,"dialogId",{get:function(){return this.controls.Container.prop("id")},enumerable:!0,configurable:!0});a.prototype.openDialog=function(a){this.currentStrategy=a.strategy;this.modalDialog.openDialog(!1);this.modalDialog.setPreferredSize(this.settings.PreferredWidth,
this.settings.PreferredHeight);this.currentStrategy.loadDialogState(this.controls,a.strategicData)};return a}();e.ScheduleDialogManager=d})(e.ScheduleDialog||(e.ScheduleDialog={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.settings=a;this.textExpander=b}d.prototype.renderShowMoreLink=function(a,b){var c=this;a.each(function(a,d){a=$(d);c.textExpander.renderShowMoreTextSection(c.findClickablePlaceholder(a),c.findCollapsibleTextContainer(a),c.findContent(a),b)})};d.prototype.renderShowMoreLinkOnEmbedResize=function(a){a=a.closest("[data-"+this.settings.DataAttributes.BulletinId+"]");0===a.find("."+this.settings.CssClasses.EditorTextarea).length&&this.renderShowMoreIfNeeded(a)};
d.prototype.renderShowMoreWithImagesHack=function(a,b,c){var g=this;a.find(b).one("load",function(a){return g.renderShowMoreIfNeeded($(a.currentTarget).closest(c))});this.renderShowMoreLink(a,!1)};d.prototype.findClickablePlaceholder=function(a){return this.findByDataAttribute(a,this.settings.DataAttributes.ClickablePlaceholder)};d.prototype.findCollapsibleTextContainer=function(a){return this.findByDataAttribute(a,this.settings.DataAttributes.CollapsibleTextContainer)};d.prototype.renderShowMoreIfNeeded=
function(a){var b=this.findClickablePlaceholder(a);b.is(":visible")&&!this.textExpander.isCollapsed(b)&&this.textExpander.hasEnoughHeightForRenderingShowMore(this.findContent(a))||this.renderShowMoreLink(a,!1)};d.prototype.findContent=function(a){return this.findByDataAttribute(a,this.settings.DataAttributes.Content)};d.prototype.findByDataAttribute=function(a,b){return a.find("[data-"+b+"]")};return d}();e.ShowMoreLinkRenderer=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a;this.settings=a.settings;this.modernInput=new CCL.ModernInput(this.settings.ModernInputCssClasses,this.settings.ModernInputDataAttributes)}d.prototype.validateEditorTextMaxLength=function(a,b){a=a.length;var c=a<=this.settings.TextMaxLength;this.modernInput.toggleTextError(b,this.createTextTooLongMessage(a),!c);return c};d.prototype.validateBulletin=function(a,b){var c=this.utility.embedAsynchronousLoader.isEmbedInProgress(b);a=
this.checkNotEmpty(a.val());var g=this.utility.hasVisibleOembedBox(b),d=this.utility.countResourcesOnUi(b);return{canBePosted:!c&&(a||g),passedEmptyTextValidation:a||g&&!c,isEmbedInProgress:c,hasVisibleOembedBox:g,maxCountOfAddedElementsReached:d===e.LightBulletinConstants.maxCountOfAddedElements,hasAttachedElementLinks:0<d,hasVisibleImage:this.utility.hasVisibleImage(b)}};d.prototype.toggleNoTextYetErrorMessage=function(a,b){this.modernInput.toggleTextError(a,this.settings.Resources.NoTextYetError,
!b.passedEmptyTextValidation)};d.prototype.checkNotEmpty=function(a){return 0<$.trim(a).length};d.prototype.createTextTooLongMessage=function(a){return CCL.CommonFunctions.formatString(this.settings.Resources.TextTooLongError,this.settings.TextMaxLength,a)};return d}();e.LightBulletinTextValidator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a,c){d.call(this,a.Urls.CheckSession,a.Resources.AnErrorOccurred,c);this.settings=a}__extends(a,d);a.prototype.page=function(a,c,g){return $.ajax({type:"GET",url:this.settings.Urls.Page,data:{courseId:this.settings.CourseId,boundaryLightBulletinId:a,boundaryLightBulletinActiveFromTicks:c,displayMode:g}})};a.prototype.createLightBulletin=function(a){return $.ajax({type:"POST",url:this.settings.Urls.CreateLightBulletin,data:{inputData:a},dataType:"html"})};
a.prototype.updateLightBulletin=function(a){return $.ajax({type:"PUT",url:this.settings.Urls.UpdateLightBulletin,data:{inputData:a},dataType:"json"})};a.prototype.getSchedule=function(a){return $.ajax({type:"POST",url:this.settings.Urls.GetSchedule,data:{lightBulletinId:a},dataType:"json"})};a.prototype.getCurrentDateTime=function(){return $.ajax({type:"POST",url:this.settings.Urls.GetCurrentDateTime,dataType:"json"})};a.prototype.getTimeSpan=function(a){return $.ajax({type:"POST",url:this.settings.Urls.GetTimeSpan,
data:{schedule:a},dataType:"html"})};a.prototype.updateSchedule=function(a,c,g){return $.ajax({type:"PUT",url:this.settings.Urls.UpdateSchedule,data:{lightBulletinId:a,schedule:c,bulletinsDisplayMode:g},dataType:"html"})};a.prototype.deleteLightBulletinPermanently=function(a){return $.ajax({type:"DELETE",url:this.settings.Urls.DeleteLightBulletinPermanently,data:{bulletinId:a}})};a.prototype.setBulletinCommentsAvailability=function(a,c){return $.ajax({type:"PUT",url:this.settings.Urls.SetBulletinCommentsAvailability,
data:{bulletinId:a,disableComments:c}})};a.prototype.toggleLightBulletinSubscriptionForPerson=function(a,c){return $.ajax({type:"PUT",url:this.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,subscribe:c}})};a.prototype.embed=function(a){return $.ajax({type:"POST",url:this.settings.Urls.Embed,data:{embedUrl:a},dataType:"html"})};a.prototype.elementLinkItemsContent=function(a){return $.ajax({type:"POST",url:this.settings.Urls.ElementLinkItemsContent,data:JSON.stringify({elementIds:a}),
dataType:"html",contentType:"application/json"})};a.prototype.getBulletinElementLinksAnnouncementCompleted=function(a){return $.get(this.settings.Urls.IsBulletinElementLinksAnnouncementCompletedUrl+"?courseId="+a)};a.prototype.uploadImage=function(a,c,g){return $.ajax({type:"PUT",url:this.settings.Urls.UploadImage+"?courseId="+a+"&lightBulletinId="+c,contentType:!1,processData:!1,dataType:"html",data:g})};a.prototype.callInsertOrUpdatePersonSettingService=function(a,c){return $.ajax({type:"POST",
url:this.settings.Urls.InsertOrUpdateSetting,data:{settingName:a,settingValue:c}})};return a}(f.CommonAjaxClient);e.LightBulletinAjaxClient=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.listenToEmbedSizePostmessages=function(a,b,c,g,d){CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentSize,function(h){var e=a.find("#"+h.oembedPlaceHolderId),f=e.hasClass(b)?e:e.find("."+b);h.height&&(f.css("height",h.height),c.renderShowMoreLinkOnEmbedResize(e),g.removeAjaxLoader(e.parent()),d&&d(e))})};return d}();e.EmbedResizer=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.tryAgainBulletinIds=[];this.embedBufferMap=new Map;this.renderShowMoreCallbackDebouncer=new CCL.CallbackDebouncer(function(a){return c.renderShowMoreInAddMode(a)});this.uploadImagePromiseQueue=new CCL.PromiseQueue;this.afterAddingComment=function(a){a=a.userData.sourceId;var b=c.utility.getBulletinById(a);c.singleItemDataManager.subscribeToCommentsIfNeeded(b,a)};this.lightBulletinMenuClicked=function(a){var b=
c.singleItemDataManager.getLightBulletinActionDropDownItem(a),g=c.utility.getBulletinById(b.LightBulletinId);switch(b.ActionType){case e.LightBulletinDropDownMenuActionType.Edit:c.appendBulletinEditor(c.editor.createBulletinEditor(g));c.toggleViewEditMode(g,!1);break;case e.LightBulletinDropDownMenuActionType.SetCommentsAvailability:var d=!c.singleItemDataManager.getSingleItemData(g).DisableComments;c.ajaxClient.setBulletinCommentsAvailability(b.LightBulletinId,d).done(function(){var b=c.singleItemDataManager.refreshSingleItemData(g,
function(a){return a.DisableComments=d});c.commentToggler.togglePossibilityToAddComments(b,a)}).fail(c.ajaxClient.handleAjaxError);break;case e.LightBulletinDropDownMenuActionType.ScheduleBulletin:e.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:c.ajaxStorageStrategy,strategicData:{lightBulletinId:b.LightBulletinId,bulletinsDisplayMode:c.activationFilterCurrentValue,onSuccess:function(a){a=$(a);a.hasClass(c.settings.CssClasses.TimeSpan)?c.utility.getTimeSpan(g).replaceWith(a):
(c.utility.removeBulletin(g),c.showInformationFeedback(a,c.settings.Resources.BulletinHasBeenEditedButDoesNotMatchFilter))}}});break;case e.LightBulletinDropDownMenuActionType.Delete:confirm(c.settings.Resources.DeleteConfirmationText)&&c.ajaxClient.deleteLightBulletinPermanently(b.LightBulletinId).done(function(){return c.utility.removeBulletin(g)}).fail(c.ajaxClient.handleAjaxError);break;case e.LightBulletinDropDownMenuActionType.ToggleSubscription:var f=c.singleItemDataManager.getSingleItemData(g).SubscriptionStatus!==
e.PersonSubscriptionStatus.Subscribed;c.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,f).done(function(){c.singleItemDataManager.updateSubscriptionStatus(g,a,f)}).fail(c.ajaxClient.handleAjaxError)}};this.onDeleteImageButtonClick=function(a){a=$(a.target);var b=c.utility.getCurrentBulletinItemOrNew(c.utility.findBulletinItemByChild(a));c.utility.imageBox.hideOrRemoveImageBox(a.closest("."+c.settings.CssClasses.ImageBox));c.utility.imageBox.clearAddImageButtonFileInputValue(b);
c.focusOnTextArea(b);c.utility.validateBulletinAndToggleControls(b)};this.checkInputForEmbedUrl=function(a){c.watchEmbeds.stopWatchEmbeds(a);var b=c.utility.findBulletinItemByChild(a),g=c.utility.getCurrentBulletinItemOrNew(b),d=c.utility.isAddMode(b)?a.closest(c.selectors.mediaAppendTarget):b.find(c.selectors.mediaAppendTarget);if(!c.utility.hasVisibleOembedBox(d)&&0===c.utility.countResourcesOnUi(b)){var e=c.utility.linkParser.getFirstLink(a.val());if(e&&e.length<=c.settings.EmbedUrlMaxLength){c.toggler.toggleBulletinAttachmentButtons(b,
!1);c.toggler.toggleAddEditButton(b,!1);c.utility.imageBox.removeImageError(g);var f=c.embedAsynchronousLoader.createAjaxLoader();d.append(f);c.ajaxClient.embed(e).done(function(a){a=$(a);d.append(a);a=c.embedAsynchronousLoader.findIframeHolders(a);var b=c.embedAsynchronousLoader.createIframe(c.embedAsynchronousLoader.getEmbedIframeUrl(a),!0);a.append(b)}).fail(function(h,l,m){f.remove();c.ajaxClient.handleAjaxError(h);c.watchEmbeds.watchEmbeds(a);c.watchEmbeds.shouldAppendOembedError({originalEmbedCode:e,
oembedPlaceHolder:d})&&c.watchEmbeds.appendOembedError({originalEmbedCode:e,oembedPlaceHolder:d});c.toggler.toggleOembedEditClasses(g,{isViewMode:!1,isEmbedInProgress:!0});c.utility.validateBulletinAndToggleControls(b)})}else c.watchEmbeds.watchEmbeds(a)}};e.lightBulletinContentBlockInstance=this;this.utility=new e.LightBulletinUtility(a,b,this.checkInputForEmbedUrl,function(){return c.formCheckBeforeUnload.DetachHandler()});this.watchEmbeds=this.utility.watchEmbeds;this.selectors=this.utility.selectors;
this.editor=this.utility.editor;this.toggler=this.utility.toggler;this.embedAsynchronousLoader=this.utility.embedAsynchronousLoader;this.textValidator=this.utility.textValidator;this.commentToggler=this.utility.commentToggler;this.ajaxClient=this.utility.ajaxClient;this.elementLinkBuilder=this.utility.elementLinkBuilder;this.singleItemDataManager=this.utility.singleItemDataManager;this.settings.CanAddNewBulletins&&(this.scheduleDialogInputValidator=new e.ScheduleDialogInputValidator(this.utility),
this.temporaryStorageStrategy=new e.ScheduleDialogTemporaryStorageStrategy(this.utility,this.scheduleDialogInputValidator),this.ajaxStorageStrategy=new e.ScheduleDialogAjaxStorageStrategy(this.utility,this.scheduleDialogInputValidator));this.boundaryLightBulletinId=this.settings.InitialPageData.BoundaryLightBulletinId;this.boundaryLightBulletinActiveFromTicks=this.settings.InitialPageData.BoundaryLightBulletinActiveFromTicks;this.activationFilterCurrentValue=this.settings.BulletinsDisplayMode;this.setupFormCheckBeforeUnload();
this.setupControls();this.setupControlsEvents();this.setupEventListeners();this.setupOnboardingFeatures();this.setupGhostBulletin()}d.prototype.onActivationFilterChanged=function(a){this.activationFilterCurrentValue=parseInt(a,10);this.ajaxClient.callInsertOrUpdatePersonSettingService(this.settings.BulletinsContentBlockDisplayModePersonSettingName,a).done(WidgetLayout._reloadWindow)};d.prototype.focusOnTextArea=function(a){this.utility.editor.getBulletinEditor(a).focus()};d.prototype.uploadImage=
function(a){var b=this,c=$(a.target).closest(this.utility.selectors.addImageButton);if(c.getIfHyperLinkEnabled()){var g=f.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a.target).formData;if(g){var d=this.utility.findBulletinItemByChild(c),e=this.utility.isAddMode(d)?c.closest(this.selectors.mediaAppendTarget):d.find(this.selectors.mediaAppendTarget),m=this.utility.getCurrentBulletinItemOrNew(d);this.utility.imageBox.hideOrRemoveImageBoxFromContainer(e);this.utility.imageBox.removeImageError(e);
this.watchEmbeds.stopWatchEmbedsInBulletinItem(d);this.toggler.toggleResourceButton(d,!1);this.toggler.toggleAddImageButton(d,!1);e.append(this.embedAsynchronousLoader.createAjaxLoader());this.uploadImagePromiseQueue.enqueue(function(){return b.ajaxClient.uploadImage(b.settings.CourseId,b.utility.getBulletinId(d),g).always(function(){b.editor.getBulletinEditor(d).focus();b.embedAsynchronousLoader.removeAjaxLoader(e)}).done(function(a){b.utility.isViewMode(m)||b.utility.hasVisibleImage(m)||(e.append($(a)),
b.utility.validateBulletinAndToggleControls(d),b.utility.imageBox.applyNewImageLoadingComplete(e),0<b.utility.getImageError(m).length&&b.utility.imageBox.clearAddImageButtonFileInputValue(m))}).fail(function(a,c,g){b.utility.validateBulletinAndToggleControls(d);b.utility.imageBox.clearAddImageButtonFileInputValue(m);b.ajaxClient.handleAjaxError(a)})})}}};d.prototype.setupEventListeners=function(){this.listenToEmbedPostmessages();this.listenToEmbedSizePostmessages()};d.prototype.setupControls=function(){var a=
this;this.loadEmbedContent(this.controls.Container);this.setupShowMoreLink();this.utility.linkifyTextNodes(this.controls.Container);this.settings.CanAddNewBulletins&&this.setupEditorAndApplyButton({editor:this.controls.NewBulletinText,applyButton:this.controls.PostNewBulletin},function(){return a.createLightBulletin()},function(){return a.resetUnsavedTextInAddMode()});this.commentToggler.resetCommentsDisabledForNewBulletins();this.utility.validateBulletinAndToggleControls(this.controls.NewBulletinItem)};
d.prototype.setupFormCheckBeforeUnload=function(){var a=this;if(this.settings.CanAddNewBulletins){CCL.DialogWhiteList.allowDialogWithId(f.ElementLinkDialog.elementLinkDialogManagerInstance.getDialogId());CCL.DialogWhiteList.allowDialogWithId(e.ScheduleDialog.ScheduleDialogManager.instance.dialogId);var b={enabled:!0,clearStateCallback:function(){a.resetUnsavedTextInAddMode();a.utility.imageBox.resetUnsavedImage(a.controls.NewBulletinItem);a.resetUnsavedEmbed(a.controls.NewBulletinItem,0,{preserveAjaxLoader:!1});
a.elementLinkBuilder.resetUnsavedElementLinks(0,a.controls.NewBulletinItem);a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);a.textValidator.validateEditorTextMaxLength("",a.controls.NewBulletinItem);a.controls.Container.find(a.selectors.bulletinItem).each(function(b,g){b=$(g);a.utility.isViewMode(b)||a.cancelEditMode(a.editor.getBulletinEditorInstance(b))})}}}else b={enabled:!1,clearStateCallback:function(){}};this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.Container.closest("form"),
this.settings.Resources.FormBeforeUnloadWarning,{callback:function(){return a.isAddingEditingBulletinsNotFinished()},whiteList:b})};d.prototype.setupShowMoreLink=function(){this.showMoreRenderer=new e.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,this.utility.textExpander);this.renderShowMoreWithImagesHack(this.controls.Container.find(this.selectors.bulletinItem))};d.prototype.renderShowMoreWithImagesHack=function(a){this.showMoreRenderer.renderShowMoreWithImagesHack(a,"[data-"+
this.settings.DataAttributes.BulletinAttachedImage+"]",this.utility.selectors.bulletinItem)};d.prototype.loadEmbedContent=function(a){this.embedAsynchronousLoader.appendIframeHolders(a);this.embedAsynchronousLoader.loadEmbedContentAsync()};d.prototype.setupControlsEvents=function(){var a=this;this.controls.ShowMoreLink.click(function(b){a.controls.ShowMoreLink.hide();a.ajaxClient.page(a.boundaryLightBulletinId,a.boundaryLightBulletinActiveFromTicks,a.settings.BulletinsDisplayMode).done(function(b){var c=
void 0;b=0<$.trim(b).length?(c=$(b)).filter("[data-"+a.settings.DataAttributes.PageData+"]"):$();if(0<b.length&&c){var d=b.data(a.settings.DataAttributes.PageData);a.utility.linkifyTextNodes(c);a.controls.Container.append(c);b.remove();a.renderShowMoreWithImagesHack(c.find(a.selectors.bulletinItem));a.boundaryLightBulletinId=d.BoundaryLightBulletinId;a.boundaryLightBulletinActiveFromTicks=d.BoundaryLightBulletinActiveFromTicks;a.controls.ShowMoreLink.toggle(d.NeedToShowMore);a.loadEmbedContent(c)}}).fail(a.ajaxClient.handleAjaxError);
b.preventDefault()});this.controls.Container.on("click","."+this.settings.CssClasses.OembedDelete,function(b){return a.lightBulletinDeleteEmbedClicked(b)});this.controls.Container.on("click",this.selectors.addResourceAction,function(b){b=$(b.target);if(b.closest(a.selectors.addResourceAction).getIfHyperLinkEnabled()){var c=a.utility.findBulletinItemByChild(b),g=a.utility.getCurrentBulletinItemOrNew(c);b=function(){a.watchEmbeds.stopWatchEmbedsInBulletinItem(c);a.toggler.toggleAddImageButton(c,!1);
a.toggler.toggleResourceButton(c,!0);var b=a.utility.getVisibleOembedBox(g);a.embedAsynchronousLoader.removeAjaxLoader(b.closest(a.selectors.mediaAppendTarget));a.removeOembedBox(b,c);a.utility.imageBox.removeImageError(g)};var d=function(){a.watchEmbeds.watchEmbedsInBulletinItem(c);a.toggler.toggleAddImageButton(c,!0)};if(!a.utility.hasVisibleOembedBox(g))a.elementLinkBuilder.onResourceButtonClick(a.utility.getBulletinId(c),g,d,b,function(){a.utility.validateBulletinAndToggleControls(c)})}});this.controls.Container.on("click",
"a."+this.settings.CssClasses.ElementLinkDelete,function(b){b=$(b.currentTarget).closest("."+a.settings.CssClasses.ElementLinkListItem);var c=a.utility.findBulletinItemByChild(b);a.elementLinkBuilder.onDetachResourceButtonClick(a.utility.getBulletinId(c),c,b,function(){a.focusOnTextArea(c);a.utility.validateBulletinAndToggleControls(c)})});this.controls.Container.on("click","."+this.settings.CssClasses.ImageDelete,this.onDeleteImageButtonClick);this.controls.Container.on("click",this.utility.selectors.addImageButtonFileInput,
function(b){var c=a.utility.getCurrentBulletinItemOrNew(a.utility.findBulletinItemByChild($(b.target)));a.utility.hasVisibleImage(c)&&!confirm(a.settings.Resources.ReloadImageConfirmation)&&b.preventDefault()});this.controls.Container.on("change",this.utility.selectors.addImageButtonFileInput,function(b){return a.uploadImage(b)});this.controls.Container.on("keyup",this.utility.selectors.addImageButton,function(b){var c=$(b.target);b.which===CCL.CommonConstants.keyCodes.enter&&c.getIfHyperLinkEnabled()&&
c.find(a.utility.selectors.addImageButtonFileInput).click();b.preventDefault()});this.utility.controls.AddMenu.Menu.on(this.utility.settings.IsIosDevice?"touchstart":"click","a",function(b){b.preventDefault();b=b.currentTarget;b===a.utility.controls.AddMenu.ToggleCommentsOptionLink.get(0)?a.commentToggler.areCommentsDisabledForNewBulletins=!a.commentToggler.areCommentsDisabledForNewBulletins:b===a.utility.controls.AddMenu.ScheduleOptionLink.get(0)&&e.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:a.temporaryStorageStrategy,
strategicData:{onSuccess:function(b){a.utility.getTimeSpan(a.utility.controls.NewBulletinItem).remove();a.utility.getAuthorContainer(a.utility.controls.NewBulletinItem).append($(b))}}})});this.singleItemDataManager.registerDropDownMenuClickHandler(this.utility.settings.IsIosDevice,this.lightBulletinMenuClicked)};d.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var c=
a.controls.Container.find("#"+b.oembedPlaceHolderId),g=a.utility.findBulletinItemByChild(c),d={originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:c};b.isPlainLink||0<a.utility.countResourcesOnUi(g)||c.data(a.settings.DataAttributes.OembedIsNew)&&a.utility.isViewMode(g)?(a.controls.Container.removeClass(a.settings.CssClasses.OembedBoxLoading),a.embedAsynchronousLoader.removeAjaxLoader(c.closest(a.selectors.mediaAppendTarget)),c.removeClass(a.settings.CssClasses.OembedContent),b.isPlainLink&&a.utility.linkParser.skipUrl(b.originalEmbedCode),
a.watchEmbeds.shouldAppendOembedError(d)?(a.embedBufferMap.set(a.utility.getBulletinId(g),d),a.watchEmbeds.appendOembedError(d),a.showMoreRenderer.renderShowMoreLink(g,!1)):c.remove()):(a.embedBufferMap.set(a.utility.getBulletinId(g),d),c.removeClass(a.settings.CssClasses.OembedBoxLoading),c.data(a.settings.DataAttributes.OembedIsNew)&&(a.embedAsynchronousLoader.removeAjaxLoader(c.closest(a.selectors.mediaAppendTarget)),c.find("."+a.settings.CssClasses.OembedBoxHeader).show()),a.toggler.toggleOembedEditClasses(g,
{isViewMode:a.utility.isViewMode(g),isEmbedInProgress:!1}));a.utility.validateBulletinAndToggleControls(g)})};d.prototype.listenToEmbedSizePostmessages=function(){var a=this;e.EmbedResizer.listenToEmbedSizePostmessages(this.controls.Container,this.settings.CssClasses.OembedContent,this.showMoreRenderer,this.embedAsynchronousLoader,function(b){b=a.utility.findBulletinItemByChild(b);a.utility.isViewMode(b)||a.utility.validateBulletinAndToggleControls(b)})};d.prototype.lightBulletinDeleteEmbedClicked=
function(a){var b=$(a.target);a=this.utility.findBulletinItemByChild(b);b=b.closest("."+this.settings.CssClasses.OembedBox+":visible");this.removeOembedBox(b,a,b.data(this.settings.DataAttributes.OembedIsNew));this.focusOnTextArea(a);this.utility.validateBulletinAndToggleControls(a)};d.prototype.toggleViewEditMode=function(a,b){var c=a.find("[data-"+this.settings.DataAttributes.Text+"]"),g=this.showMoreRenderer.findClickablePlaceholder(a);b||this.utility.textExpander.expand(this.showMoreRenderer.findCollapsibleTextContainer(a),
g);c.toggle(b&&0<c.html().length);g.toggle(b);a.find("."+this.settings.CssClasses.ListItemAction).toggle(b);this.toggler.toggleOembedEditClasses(a,{isViewMode:b,isEmbedInProgress:this.embedAsynchronousLoader.isEmbedInProgress(a)});b||this.utility.validateBulletinAndToggleControls(a);a.find("."+this.settings.CssClasses.ElementLinkDelete).toggle(!b);a.find("."+this.utility.settings.CssClasses.ImageBoxHeader).toggle(!b);a.find("."+this.settings.CssClasses.ImageBox).toggleClass(this.settings.CssClasses.ImageBoxEditMode,
!b)};d.prototype.isAddingEditingBulletinsNotFinished=function(){return!this.settings.IsIeBelow11&&(this.isPostingNewBulletin()||0<this.controls.NewBulletinItem.find("li[data-"+this.settings.DataAttributes.ElementLinkElementId+"]").length||this.utility.imageBox.addImageButtonFileInputHasValue(this.controls.NewBulletinItem)||0<this.controls.Container.find(this.selectors.applyEditAction).length)};d.prototype.isPostingNewBulletin=function(){return this.settings.CanAddNewBulletins&&(this.controls.PostNewBulletin.getIfHyperLinkEnabled()||
this.textValidator.checkNotEmpty(this.controls.NewBulletinText.val()))};d.prototype.createLightBulletin=function(){var a=this,b=this.controls.NewBulletinText.val(),c=this.embedBufferMap.get(0);c=c?c.originalEmbedCode:void 0;this.removeOembedBox(this.utility.getOembedBox(this.controls.NewBulletinItem),this.controls.NewBulletinItem);var g=this.elementLinkBuilder.getElementIdsForBulletin(0);b={CourseId:this.settings.CourseId,Text:b,EmbedUrl:c,DisableComments:this.commentToggler.areCommentsDisabledForNewBulletins,
ElementIdsToAttach:g.elementsToAttach,UploadResult:this.utility.imageBox.getParsedUploadResult(this.controls.NewBulletinItem),Schedule:{ActiveFrom:this.temporaryStorageStrategy.activeFrom,ActiveTo:this.temporaryStorageStrategy.activeTo},BulletinsDisplayMode:this.activationFilterCurrentValue};this.controls.PostNewBulletin.toggleHyperlink(!1);this.resetUnsavedTextInAddMode();this.ajaxClient.createLightBulletin(b).done(function(b){if(b){var c=$(b);if(c.is(":visible")){a.utility.controls.GhostArrow.parent().remove();
var g=$("<li style='display:none;'>"+b+"</li>").addClass(a.settings.CssClasses.ListItem).addClass(a.settings.CssClasses.PositionRelative);a.utility.linkifyTextNodes(g);a.controls.NewBulletinItem.after(g);a.utility.animator.animateShow(g);a.renderShowMoreInAddMode(g);a.utility.getImage(g).one("load",function(){a.renderShowMoreInAddMode(g);a.renderShowMoreCallbackDebouncer.invokeCallback(g,e.LightBulletinConstants.renderShowMoreDelayInMilliseconds)}).each(function(){this.complete&&$(this).load()});
b=a.embedAsynchronousLoader.findIframeHolders(g);0<b.length&&(c=a.embedAsynchronousLoader.createAjaxLoader(),g.find(a.selectors.mediaAppendTarget).append(c),b.append(a.embedAsynchronousLoader.createIframe(a.embedAsynchronousLoader.getEmbedIframeUrl(b),!0)))}else a.showInformationFeedback(c,a.settings.Resources.BulletinHasBeenCreatedButDoesNotMatchFilter)}a.elementLinkBuilder.cleanAppendData(0,void 0);a.temporaryStorageStrategy.resetStorage();a.commentToggler.resetCommentsDisabledForNewBulletins();
a.toggler.toggleAddBulletinMenu(!1);a.utility.getVisibleImageBox(a.controls.NewBulletinItem).remove();a.utility.imageBox.clearAddImageButtonFileInputValue(a.controls.NewBulletinItem);a.utility.imageBox.removeImageError(a.controls.NewBulletinItem);a.utility.getElementLinkList(a.controls.NewBulletinItem).remove();a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);a.utility.getTimeSpan(a.controls.NewBulletinItem).remove()}).fail(function(b,c,g){a.controls.PostNewBulletin.toggleHyperlink(!0);
a.ajaxClient.handleAjaxError(b)})};d.prototype.showInformationFeedback=function(a,b){var c=this,g=a.data(this.settings.DataAttributes.InformationFeedbackButtonText),d=a.data(this.settings.DataAttributes.ActivationFilterValueToShowBulletin);CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.InformationFeedbackMainContainer,b,g,function(){CCL.InformationFeedback.hideFeedback(c.controls.InformationFeedbackMainContainer);c.onActivationFilterChanged(d)})};d.prototype.renderShowMoreInAddMode=
function(a){this.showMoreRenderer.renderShowMoreLink(a,!0)};d.prototype.setupEditorAndApplyButton=function(a,b,c){var g=this,d=!0,f=this.utility.getCurrentBulletinItemOrNew(this.utility.findBulletinItemByChild(a.editor)),m=function(c){if(d&&a.applyButton.getIfHyperLinkEnabled()){var h=g.utility.validateBulletinAndToggleControls(f);g.textValidator.toggleNoTextYetErrorMessage(f,h);h.canBePosted?b():a.editor.focus()}c.preventDefault()};f.data(e.LightBulletinEditor.bulletinEditorDataAttribute,a.editor);
a.applyButton.click(m);this.editor.makeEditorAutoResizable(a.editor);this.editor.resetEditor(a.editor,!1);a.editor.keyup(function(a){a.which===CCL.CommonConstants.keyCodes.escape?(c(),d=g.textValidator.validateEditorTextMaxLength("",f)):a.ctrlKey&&a.which===CCL.CommonConstants.keyCodes.enter&&m(a)}).on("input paste remove",function(b){d=g.textValidator.validateEditorTextMaxLength("remove"===b.type?"":a.editor.val(),f);g.utility.isAddMode(f)&&g.utility.validateBulletinAndToggleControls(f)});this.utility.validateBulletinAndToggleControls(f)};
d.prototype.appendBulletinEditor=function(a){var b=this,c=a.bulletinItem.find("[data-"+this.settings.DataAttributes.Text+"]"),g=c.attr("data-"+this.settings.DataAttributes.Text);a.editor.val(g);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorTarget+"]").append(a.editor);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorButtonsTarget+"]").append(a.editorButtons);a.editor.focus();this.setupEditorAndApplyButton(a,function(){var g=b.embedBufferMap.get(a.bulletinId),
d=b.elementLinkBuilder.getElementIdsForBulletin(a.bulletinId);b.ajaxClient.updateLightBulletin({BulletinId:a.bulletinId,Text:a.editor.val(),EmbedUrl:g?g.originalEmbedCode:void 0,ElementIdsToAttach:d.elementsToAttach,ElementIdsToDetach:d.elementsToDetach,UploadResult:b.utility.imageBox.getParsedUploadResult(a.bulletinItem),DeleteAttachedImage:b.utility.imageBox.getDeleteAttachedImageValue(a.bulletinItem)}).done(function(g){g?(b.utility.getHiddenOembedBox(a.bulletinItem).remove(),b.embedAsynchronousLoader.removeAjaxLoader(a.bulletinItem),
a.removeBulletinEditor(),c.html(g.OutputText).attr("data-"+b.settings.DataAttributes.Text,g.DataAttributeText),b.utility.getVisibleOembedBox(a.bulletinItem).data(b.settings.DataAttributes.OembedIsNew,!1),b.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0),b.toggleViewEditMode(a.bulletinItem,!0),b.utility.linkifyNodes(c),b.elementLinkBuilder.cleanAppendData(a.bulletinId,a.bulletinItem),b.utility.imageBox.applyImageEditsIfNeeded(a.bulletinItem,g.LargeImageUrl)):a.editor.focus()}).fail(function(c,
g,d){b.cancelEditMode(a);(g=CCL.CommonFunctions.safeParseJson(d))&&g.ErrorType===b.settings.BulletinNotFoundFailureCode?(alert(g.Message),b.utility.removeBulletin(a.bulletinItem)):b.ajaxClient.handleAjaxError(c)})},function(){return b.cancelEditMode(a)});a.cancelButton.click(function(c){b.cancelEditMode(a);c.preventDefault()})};d.prototype.resetUnsavedTextInAddMode=function(){this.editor.resetEditor(this.controls.NewBulletinText.val(""),!0)};d.prototype.cancelEditMode=function(a){this.resetUnsavedEmbed(a.bulletinItem,
a.bulletinId,{preserveAjaxLoader:!0});this.utility.imageBox.resetUnsavedImage(a.bulletinItem);a.removeBulletinEditor();this.editor.removeBulletinEditorInstanceDataAttribute(a.bulletinItem);this.toggleViewEditMode(a.bulletinItem,!0);this.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0);this.elementLinkBuilder.resetUnsavedElementLinks(a.bulletinId,a.bulletinItem)};d.prototype.resetUnsavedEmbed=function(a,b,c){var g=this.utility.getVisibleOembedBox(a),d=g.data(this.settings.DataAttributes.OembedIsNew);
d&&this.removeOembedBox(g,a);g=this.utility.getHiddenOembedBox(a);if(0<g.length){g.show();var e=g.data(this.settings.DataAttributes.OembedUrl);this.embedBufferMap.set(b,{oembedPlaceHolder:g,originalEmbedCode:e})}c.preserveAjaxLoader&&!d||this.embedAsynchronousLoader.removeAjaxLoader(a)};d.prototype.removeOembedBox=function(a,b,c){void 0===c&&(c=!0);if(0<a.length){var g=this.embedBufferMap.get(this.utility.getBulletinId(b));g&&a.data(this.settings.DataAttributes.OembedUrl,g.originalEmbedCode);c?a.remove():
a.hide();this.embedBufferMap.delete(this.utility.getBulletinId(b))}};d.prototype.setupOnboardingFeatures=function(){var a=this;this.settings.CanAddNewBulletins&&this.ajaxClient.getBulletinElementLinksAnnouncementCompleted(this.settings.CourseId).done(function(b){b&&a.setupElementLinksAnnouncementContextDialog(b)}).fail(this.ajaxClient.handleAjaxError)};d.prototype.setupGhostBulletin=function(){var a=this;if(this.settings.HasGhostBulletin){var b=new CCL.CallbackDebouncer(function(){var b=a.controls.GhostArrow;
if(0===b.length)$(window).off("resize",c);else{var d=b.next(),e=a.utility.controls.PostNewBulletin;b.css({height:d.position().top-5,width:d.position().top/2,left:e.position().left+e.width()/2});b.show()}});var c=function(){return b.invokeCallback(null,300)};c();$(window).on("resize",c)}};d.prototype.setupElementLinksAnnouncementContextDialog=function(a){var b=this,c=$(this.selectors.addResourceAction);if(c.is(":visible")){c.after(a);var g="#"+this.utility.settings.ElementLinksAnnouncementContainerClientId,
d=new ContextDialog(g,{marginTop:c.height(),marginLeft:(c.width()-420)/2,valign:"bottom",width:420,zIndex:1,blackThemeActivated:!0,closeWithOutsideClick:!1,showHeader:!1,showCloseLink:!1,scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!1,allowAccessToParentWindow:!1,expandParentFrame:!1});this.controls.Container.on("click",g+","+this.selectors.addResourceAction,function(){$(g).is(":visible")&&d.closeDialog()});var e,f=function(){if(CCL.CommonFunctions.isOnScreen(c,.5,.5,b.utility.settings.IsIosDevice?
window.parent:window)){var a=c.position().left+c.width()/2+10,g=c.position().top+10;d.openDialogAt(a,g,!1);return!0}return!1};if(!(e=f()))$(window).on(this.utility.settings.IsIosDevice?"touchmove":"scroll",function(){e||f()})}else setTimeout(this.setupElementLinksAnnouncementContextDialog,50)};return d}();e.LightBulletinContentBlock=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.utility=a}d.prototype.folderContent=function(a){return $.ajax({type:"GET",url:this.utility.settings.Urls.FolderContent,data:a,dataType:"html"})};return d}();e.ElementLinkDialogAjaxClient=f})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k;(function(a){a[a.Expanded=1]="Expanded";a[a.Collapsed=2]="Collapsed";a[a.Loading=3]="Loading"})(k||(k={}));var d=function(){function a(a,c){var b=this;this.controls=a;this.settings=c;this.inputTypeCheckboxSelector="input:checkbox";this.updateElementStateAndToggleOkButtonEnabled=function(a,c){a=b.utility.closestElementItem($(a.target));c=b.updateElementState(a,c.Checked);b.controls.OkButton.prop("disabled",0===c||c>b.currentParams.maxCountOfAddedElements);a.find(b.inputTypeCheckboxSelector).first().focus();
if(b.currentParams.disallowMultipleSelection){var g=b.utility.getElementId(a);c=b.getCheckedElements();if(1<c.length){var d=[];$.each(c,function(a,b){b!==g&&d.push(b)});b.utility.getCheckbox(d[0]).toggle(!1)}}};this.utility=new e.Utility(a,c);this.modalDialog=window[this.getDialogId()];this.ajaxClient=new e.ElementLinkDialogAjaxClient(this.utility);this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler();this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){return b.onFolderContentLoaded()},
afterCloseDialog:function(){void 0!==b.currentParams.afterCloseDialogCallback&&b.currentParams.afterCloseDialogCallback()}})}a.prototype.openDialog=function(a,c){this.currentParams=a;$.extend(c,{elementType:this.currentParams.elementType,showAll:this.currentParams.showAll});this.ajaxParams=c;this.currentParams.openerPage&&(c.openerPage=this.currentParams.openerPage);this.currentParams.relatedEntityId&&(c.relatedEntityId=this.currentParams.relatedEntityId);this.currentParams.learningObjectiveId&&(c.learningObjectiveId=
this.currentParams.learningObjectiveId);this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,c,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1);this.modalDialog.setPreferredSize(this.settings.PreferredWidth,this.settings.PreferredHeight);a=this.countCheckedElements();a=void 0!=this.currentParams.maxCountOfAddedElements&&a>this.currentParams.maxCountOfAddedElements?!1:0<a&&0<this.countElementsChanged();this.controls.OkButton.prop("disabled",!a)};a.prototype.refreshDialog=
function(a){a=void 0===a?{}:a;var b=a.showAll;b=void 0===b?!1:b;a=a.isFilteredByLearningObjectives;this.isFilteredByLearningObjectives=void 0===a?!1:a;this.ajaxParams.showAll=b;this.currentParams.showAll=b;this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,this.ajaxParams,!0)};a.prototype.closeDialog=function(){CssModal.closeDialog()};a.prototype.getDialogId=function(){return this.controls.Container.prop("id")};a.prototype.onFolderContentLoaded=function(){var a=this;this.currentParams.elementStates.forEach(function(b,
g){a.checkboxStateMachine.isElementChecked(b)&&(b=a.utility.getCheckbox(g))&&b.toggleWithSuppressEvents(!0)});this.currentParams.disabledElementIds&&this.currentParams.disabledElementIds.forEach(function(b){(b=a.utility.getCheckbox(b))&&b.enable(!1)})};a.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.on("click",function(b){a.currentParams.afterOkClickCallback(a.currentParams.elementStates);CssModal.closeDialog();b.preventDefault()})};a.prototype.setupListItemFocusedAreaClickHandler=
function(){var a=this;this.controls.Container.on((c={},c[this.settings.EventNames.OptionCheckBoxChanged]=this.updateElementStateAndToggleOkButtonEnabled,c),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.utility.listItemFocusedAreaSelector,function(b){b=$(b.target);var c=a.utility.closestElementItem(b);a.isClickTargetEnabled(b,c)&&(a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(c):a.utility.isListItemFocusedArea(b)&&a.isCheckboxExistAndEnabled(c)&&(b=a.utility.getCheckbox(a.utility.getElementId(c)),
b.toggle(!b.getState().Checked)))});this.controls.Container.on("keyup",this.utility.listItemFocusedAreaSelector,function(b){b.which===CCL.CommonConstants.keyCodes.space&&(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.utility.closestElementItem(b)))});var c};a.prototype.isClickTargetEnabled=function(a,c){return 0>=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand)).length||this.currentParams.allowFolderSelection&&(!this.isFilteredByLearningObjectives||
this.currentParams.showAll)&&this.isCheckboxExistAndEnabled(c)};a.prototype.targetIsFolderActionExpand=function(a){return a.is(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand))||0<a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand)).length};a.prototype.updateElementState=function(a,c){a=this.utility.getElementId(a);var b=this.currentParams.elementStates.get(a)||f.CheckboxStateMachine.State.Empty;c=
this.checkboxStateMachine.validateAndTransferElementStateAfterClick(c,b);this.currentParams.elementStates.set(a,c);return this.countCheckedElements()};a.prototype.countElementsChanged=function(){return f.MapUtils.reduce(this.currentParams.elementStates,function(a,c,g){return g===f.CheckboxStateMachine.State.AttachedByUser||g===f.CheckboxStateMachine.State.DetachedByUser?a+1:a},0)};a.prototype.countCheckedElements=function(){var a=this;return f.MapUtils.reduce(this.currentParams.elementStates,function(b,
g,d){return a.checkboxStateMachine.isElementChecked(d)?b+1:b},0)};a.prototype.getCheckedElements=function(){var a=this;return f.MapUtils.reduce(this.currentParams.elementStates,function(b,g,d){a.checkboxStateMachine.isElementChecked(d)&&b.push(g);return b},[])};a.prototype.expandOrCollapseFolder=function(a){var b=this,g=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand)).first(),d=g.data(this.settings.DataAttributes.ElementLinkFolderActionExpand),
e=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderAppendTarget)).first();d?d===k.Expanded?this.setFolderState(e,g,k.Collapsed):d===k.Collapsed&&this.setFolderState(e,g,k.Expanded):(this.setFolderState(e,g,k.Loading),this.ajaxClient.folderContent({folderId:this.utility.getElementId(a),elementType:this.currentParams.elementType,openerPage:this.currentParams.openerPage,relatedEntityId:this.currentParams.relatedEntityId,learningObjectiveId:this.currentParams.learningObjectiveId,
showAll:this.currentParams.showAll}).done(function(a){e.append(a);b.setFolderState(e,g,k.Expanded);b.onFolderContentLoaded()}))};a.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.utility.getCheckbox(this.utility.getElementId(a)))&&a.getState().Enabled};a.prototype.setFolderState=function(a,c,g){a.toggle(g===k.Expanded);this.utility.closestListItemFocusedArea(c).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
g===k.Expanded);c.data(this.settings.DataAttributes.ElementLinkFolderActionExpand,g);a=c.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,g!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,g===k.Expanded)};a.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};return a}();e.ElementLinkDialogManager=d})(f.ElementLinkDialog||(f.ElementLinkDialog=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;this.settings=b;this.eventNames=b.EventNames;this.initialize()}d.prototype.initialize=function(){!this.settings.UsesNestedLearningObjectiveSelectorMode&&this.settings.LearningObjectivesEditorClientId&&(this.objectivesEditor=window.parent[this.settings.LearningObjectivesEditorClientId]);var a=this;$(document).on(this.eventNames.EmptyStateChangedEventName,function(b,c){$(a.settings.ClientCssSelectorOfTopWarningFeedbackSelector).toggle(c.isAnyEmpty);a.objectivesEditor&&
a.objectivesEditor.handleCriteriaEmptyStateChangedEvent(c.isAnyEmpty,c.loUpdate)}).on(this.eventNames.DeleteLearningObjectiveEventName,function(b,c){a.settings.UsesNestedLearningObjectiveSelectorMode&&(c.reloadPage?(a.haveChangedLos=!0,a.removeLearningObjective(c.learningObjectiveId),a.updateUrlAndReload()):a.removeLearningObjective(c.learningObjectiveId))}).on(this.eventNames.CriteriaWeightsChangedEventName,function(b,c){a.objectivesEditor?(a.objectivesEditor.updateCriteriaWeights(c.data),a.objectivesEditor.updateLearningObjectivesCriteriaWeights(c.loCriteriaWeights)):
$("#"+a.settings.CriteriaWeightsHiddenClientId).val(JSON.stringify(c.data))});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.submitIframe,function(){var b=$("#"+a.settings.CriteriaWeightsHiddenClientId).val(),c=[];$.each(window[a.settings.LearningObjectivesControlClientId].selectedIds,function(a,b){c.push(parseInt(b))});CCL.CommonFunctions.makePostMessageCall(window.parent,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,
{loIds:c,criteriaWeights:b}))})};d.prototype.updateUrlAndReload=function(){if(this.haveChangedLos){var a=document.location.href,b=this.getParameterByName(a,"Ids"),c=window[this.settings.LearningObjectivesControlClientId].selectedIds;a=b?a.replace(b[0],b[0][0]+"Ids="+encodeURIComponent(c.join(","))):a+(-1==a.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(c.join(","));if(b=$("#"+this.settings.CriteriaWeightsHiddenClientId).val())a=(c=this.getParameterByName(a,"CriteriaWeights"))?a.replace(c[0],c[0][0]+
"CriteriaWeights="+encodeURIComponent(b)):a+(-1==a.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(b);b=this.settings.ShowCriteriaWeights?"1":"0";a=(c=this.getParameterByName(a,"ShowCriteriaWeights"))?a.replace(c[0],c[0][0]+"ShowCriteriaWeights="+b):a+(-1==a.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+b;document.location.replace(a)}};d.prototype.addLearningObjectives=function(a){for(var b=[],c=0;c<a.length;c++)b.push(parseInt(a[c]));window[this.settings.LearningObjectivesControlClientId].setSelectedIds(b,
!0);$(document).trigger(this.eventNames.SelectionSavedEventName);window[this.settings.LearningObjectivesControlClientId].showSuccessFeedback();this.haveChangedLos=!0;this.triggerLearningObjectivesDescription()};d.prototype.closeDialogAndRedirect=function(a){var b=window.parent;b.CssModal.closeDialog();b.location=a};d.prototype.removeLearningObjective=function(a){var b=window[this.settings.LearningObjectivesControlClientId].selectedIds;b.splice(b.indexOf(a.toString()),1);window[this.settings.LearningObjectivesControlClientId].setSelectedIds(b,
!0);this.triggerLearningObjectivesDescription()};d.prototype.triggerLearningObjectivesDescription=function(){var a=window[this.settings.LearningObjectivesControlClientId].selectedIds;$("#"+this.settings.AddLearningObjectiveDescriptionClientId).toggle(0==a.length)};d.prototype.getParameterByName=function(a,b){return RegExp("[?&]"+b+"=([^&]*)").exec(a)};return d}();e.ManageMultipleCriteriaPopup=f})(f.Rubric||(f.Rubric={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(b){var c=this;this.showManageRubricModal=function(){$.get(c.settings.WebMethods.GetCriteria).done(function(a){var b=window[c.settings.RubricDialogClientInstanceName],g="&Ids="+a.LoIds.join(","),d="";a.UseAssessmentOrScore&&(d="&ShowCriteriaWeights=True&CriteriaWeights="+JSON.stringify(a.CriteriaWeights));b.setIframeUrl(c.settings.WebMethods.ManageRubricDialogUrl+(g+d));b.openDialog()})};this.updateCriteria=function(a){if(!a.extendedData.updateSettings){var b=
{};b.LoIds=a.extendedData.loIds;a.extendedData.criteriaWeights&&(b.CriteriaWeights=JSON.parse(a.extendedData.criteriaWeights));$.post(c.settings.WebMethods.UpdateCriteria,b).done(function(){e.Settings.Manager.getInstance().refreshReadView()})}};this.settings=b;window[a.clientInstanceName]=this;b=$(window);CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.assignmentShowManageRubric,function(){c.showManageRubricModal()});CCL.CommonFunctions.attachPostMessageEventListener(b,
CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){c.updateCriteria(a)})}a.clientInstanceName="AssignmentListenerClientInstanceName";return a}();f.AssignmentListener=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){e.makeCopy=function(e){var d=new Map;e.forEach(function(a,b,c){d.set(b,a)});return d};e.reduce=function(e,d,a){var b=a;e.forEach(function(a,g,e){b=d(b,g,a)});return b};e.mapToJsonString=function(e){var d=Object.create(null);e.forEach(function(a,b){return d[b.toString()]=a});return JSON.stringify(d)};e.jsonStringToMap=function(e,d){e=JSON.parse(e);for(var a=new Map,b=0,c=Object.keys(e);b<c.length;b++){var g=c[b];a.set(d(g),e[g])}return a};e.stringKeyConverter=function(e){return e};
e.numberKeyConverter=function(e){return parseInt(e,10)}})(f.MapUtils||(f.MapUtils={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){this.defaultLabelColor=null;this.animate=!1;e.assessmentLettersInstance=this;this.context=a;if(e.assessmentLettersInstance.context.Settings.IsMentorCanSendReminders)$("#"+e.assessmentLettersInstance.context.Controls.SendReminderButtonId).on("click",this.SendReminder);this.SetTimestamp(e.assessmentLettersInstance.context.Settings.SendDate)}a.prototype.SendReminder=function(){$.ajax({type:"POST",url:e.assessmentLettersInstance.context.WebMethods.SendReminderUrl,
traditional:!0,data:{termId:e.assessmentLettersInstance.context.Settings.TermId,organisationId:e.assessmentLettersInstance.context.Settings.OrganisationId}}).done(function(a){e.assessmentLettersInstance.SetTimestamp(a)}).fail(function(a,c,g){CCL.CommonFunctions.alertAjaxError(a,c,g)})};a.prototype.SetTimestamp=function(a){if(null!==a){var b=$("#"+e.assessmentLettersInstance.context.Controls.TimestampLabelId),g=b.text();b.text(CCL.CommonFunctions.formatString(e.assessmentLettersInstance.context.Settings.TimestampText,
a));g&&this.blink(b)}};a.prototype.blink=function(a){this.animate||(this.animate=!0,this.defaultLabelColor||(this.defaultLabelColor=a.css("color")),a.css("color","#F9F5BE"),a.animate({color:this.defaultLabelColor},1E3,function(){e.assessmentLettersInstance.animate=!1}))};return a}();e.TermAssessmentOverview=d})(e.Mentor||(e.Mentor={}))})(f.Assessment||(f.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.onboardingControlUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.FinalModalLoader=d;d=function(a){function b(b,g){a.call(this,g);this.context=b}__extends(b,a);b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$finalModalOverlayModal.overlayModal("open")};b.prototype.initEvents=function(){var a=this;$(document).on(CCL.OverlayModalEvents.hide,function(b,c){a.onOverlayModalHide(b,c)})};b.prototype.onOverlayModalHide=function(a,b){(b.closeType===CCL.OverlayModalCloseType.CloseButtonClicked||b.closeType===CCL.OverlayModalCloseType.EscapeKeyPressed)&&this.$finalModalOverlayModal.get(0).id===b.activeElement.id&&CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close()};return b}(OnboardingSystem.OnboardingControl);
e.FinalModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.onboardingControlUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.RecurringEventModalLoader=d;d=function(a){function b(b,g){a.call(this,g);this.context=b}__extends(b,a);b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this)};
return b}(OnboardingSystem.OnboardingControl);e.RecurringEventModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.onboardingControlUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.CalendarModalLoader=d;d=function(a){function b(b,g){a.call(this,g);this.context=b}__extends(b,a);b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$welcomeModalOverlayModal.overlayModal("open")};b.prototype.initEvents=function(){var a=this;this.$LetsGoButton.click(function(){a.onLetsGoButtonClick()});this.$NoThanksButton.click(function(){a.onNoThanksButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,function(b,c){a.onOverlayModalHide(b,c)})};b.prototype.hideWelcomeModalAndCompleteFeature=function(a){$.ajax({url:this.context.OnboardingProxyUrl,type:"PUT"});this.raiseEvent(OnboardingSystem.ControlEvents.courseModernExistingWelcomeModalCompleted)};
b.prototype.onLetsGoButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!1)};b.prototype.onNoThanksButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!0)};b.prototype.onOverlayModalHide=function(a,b){b.closeType!==CCL.OverlayModalCloseType.CloseButtonClicked&&b.closeType!==CCL.OverlayModalCloseType.EscapeKeyPressed||this.$welcomeModalOverlayModal.get(0).id!==b.activeElement.id||(this.hideWelcomeModalAndCompleteFeature(!0),
CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close())};return b}(OnboardingSystem.OnboardingControl);e.CalendarModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.welcomeTopBannerUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.welcomeTopBannerUrl,type:"GET",cache:!1}).done(function(b,g,d){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.WelcomeTopBannerLoader=d;d=function(a){function b(b,g){a.call(this,g);this.height=207;this.slideUpduration=1E3;this.context=b}__extends(b,a);b.prototype.init=function(){this.context.Scripts.WelcomeTopBannerDisplayMeasureKpiScript();
OnboardingSystem.onboardingManagerInstance.registerControl(this);this.$whatsNewOverlayModal=$("#"+this.context.Controls.WhatsNewOverlayModal);this.$tellMeMoreButton=$("#"+this.context.Controls.TellMeMoreButton);this.$gotItButton=$("#"+this.context.Controls.GotItButton);this.initEvents()};b.prototype.initEvents=function(){var a=this;this.$tellMeMoreButton.click(function(){a.onTellMeMoreButtonClick()});this.$gotItButton.click(function(){a.onGotItButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,
function(b,c){a.onOverlayModalHide(b,c)})};b.prototype.hideTopBannerAndCompleteFeature=function(){$("#"+this.context.Controls.WelcomeTopBanner).css({"min-height":0,height:this.height}).slideUp(this.slideUpduration);$.ajax({url:this.context.OnboardingProxyUrl,type:"PUT"})};b.prototype.onTellMeMoreButtonClick=function(){this.context.Scripts.WelcomeTellMeMoreMeasureKpiScript();this.$whatsNewOverlayModal.overlayModal("open")};b.prototype.onGotItButtonClick=function(){this.context.Scripts.WelcomeGotItMeasureKpiScript();
this.hideTopBannerAndCompleteFeature();this.raiseEvent(OnboardingSystem.ControlEvents.dashboardModernExistingWelcomeTopBannerAndModalCompleted)};b.prototype.onOverlayModalHide=function(a,b){this.$whatsNewOverlayModal.get(0).id===b.activeElement.id&&(this.hideTopBannerAndCompleteFeature(),this.raiseEvent(OnboardingSystem.ControlEvents.dashboardModernExistingWelcomeTopBannerAndModalCompleted))};return b}(OnboardingSystem.OnboardingControl);e.WelcomeTopBanner=d})(e.Dashboard||(e.Dashboard={}))})(f.Onboarding||
(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.coursesMenuCallToActionUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuCallToActionUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b),a.$targetElement.find(".ccl-context-dialog-arrow").css("left",a.$targetElement.outerWidth()/2))})};return a}();e.CoursesMenuCallToActionLoader=d;d=function(a){function b(b,g){a.call(this,
g);this.context=b}__extends(b,a);b.prototype.onGotItClick=function(){$("."+this.context.Controls.CoursesMenuCallToActionId).hide()};b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this,b=$("."+a.context.Controls.CoursesMenuCallToActionId);b.click(function(){return a.onGotItClick()});b.show();this.coursesMenuItemIsVisible()&&$.ajax({url:this.context.OnboardingProxyUrl,type:"PUT"})};b.prototype.coursesMenuItemIsVisible=function(){return $(this.context.Controls.CoursesMenuItemSelector).is(":visible")};
return b}(OnboardingSystem.OnboardingControl);e.CoursesMenuCallToAction=d})(e.TopMenu||(e.TopMenu={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c,g){this.coursesMenuItemUrl=a;this.$targetElement=c;this.coursesMenuItemPageContext=g}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuItemUrl,type:"GET",cache:!1}).done(function(b,g,d){b&&0!==b.length&&(b=$(b),a.$targetElement.append(b),$(document).trigger("document:coursesMenuItemLoaded",a.coursesMenuItemPageContext))})};return a}();e.CoursesMenuItemLoader=d;d=function(){function a(a){e.coursesMenuItemInstance=
this;this.context=a}a.prototype.init=function(){var a=this;this.$coursesMenuItem=$(this.context.Controls.CoursesMenuItemSelector);this.$coursesMenuItem.one("click touchstart",function(){a.coursesMenuItemOnClick(a)});this.$gotItButton=$("#"+this.context.Controls.GotItButtonId);this.$gotItButton.on("click touchstart",this.gotItButtonOnClick);this.$allCoursesLink=$("."+this.context.Controls.AllCoursesLink);this.$allCoursesLink.on("click touchstart",this.allCoursesLinkClick);this.$coursesMenuItemAnchor=
this.$coursesMenuItem.children("a").first();this.$originalDropDownMenu=this.$coursesMenuItem.children(".ccl-context-dialog.ccl-dropdownmenu").first().detach();this.$onboardingSplash=$("#"+this.context.Controls.SplashPanelIdControl).detach();this.initSplash()};a.prototype.initSplash=function(){this.$coursesMenuItemAnchor.after(this.$onboardingSplash);this.$originalDropDownMenu.detach()};a.prototype.disposeSplash=function(){this.$coursesMenuItemAnchor.after(this.$originalDropDownMenu);this.$onboardingSplash.detach()};
a.prototype.updateOnboardingService=function(a){$.ajax({type:"PUT",url:a})};a.prototype.completeSplash=function(){this.updateOnboardingService(this.context.Urls.CompleteSplashFeatureUrl)};a.prototype.coursesMenuItemOnClick=function(a){a.updateOnboardingService(a.context.Urls.CompleteSplashFeatureDisplayedUrl)};a.prototype.gotItButtonOnClick=function(){var a=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";e.coursesMenuItemInstance.completeSplash();(new Function(e.coursesMenuItemInstance.context.Functions.HideDropDowns))();
e.coursesMenuItemInstance.disposeSplash();e.coursesMenuItemInstance.$coursesMenuItemAnchor.trigger(a);e.coursesMenuItemInstance.$coursesMenuItem.find(".js-titlesFilter").focus()};a.prototype.allCoursesLinkClick=function(){e.coursesMenuItemInstance.completeSplash()};return a}();e.CoursesMenuItem=d;(function(a){function b(b,g){a.call(this,b);this.coursesMenuItem=g}__extends(b,a);return b})(OnboardingSystem.OnboardingControl)})(e.TopMenu||(e.TopMenu={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,c){this.allCoursesUrl=a;this.$targetElement=c}a.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.allCoursesUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return a}();e.AllCoursesTidyUpFavouriteListLoader=d;d=function(a){function b(b,g){a.call(this,g);this.timeoutForOnboarding=8E3;this.context=b}__extends(b,a);b.prototype.onGotItClick=function(){$("#ctl00_ContentAreaIframe").contents().find("."+this.context.Controls.AllCoursesTidyUpFavouriteListId).hide();
this.isMobile()||$.ajax({url:this.context.OnboardingProxyUrl,type:"PUT"})};b.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this;$("#ctl00_ContentAreaIframe").contents().find("."+a.context.Controls.AllCoursesTidyUpFavouriteListId).click(function(){return a.onGotItClick()});$(setTimeout(function(){a.onGotItClick()},a.timeoutForOnboarding))};b.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,
!1)};return b}(OnboardingSystem.OnboardingControl);e.AllCoursesTidyUpFavouriteList=d})(e.AllCourses||(e.AllCourses={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Welcome=38]="Welcome";a[a.LinkToClassic=39]="LinkToClassic";a[a.Messages=40]="Messages";a[a.Courses=41]="Courses";a[a.MenuMoreButton=42]="MenuMoreButton"})(d||(d={}));var a=function(){function a(a){this.settings=a;this.dialogsToShow=a.dialogClientIds.filter(function(a){return null!=window[a]}).map(function(a){return window[a]});this.dialogsHandlerMapping={};this.dialogsHandlerMapping[d.LinkToClassic]=this.getOpenCloseMoreMenuOnboardingHandlers(this.settings.classicSkoleIntraMenuItemCssClass);
this.dialogsHandlerMapping[d.Courses]=this.getOpenCloseMoreMenuOnboardingHandlers(this.settings.coursesMenuItemCssClass);this.dialogsHandlerMapping[d.MenuMoreButton]=this.getMoreMenuOnboardingHandlers()}a.prototype.start=function(){CCL.CommonFunctions.isPhoneScreenSize()||this.showNextDialog()};a.prototype.showNextDialog=function(){var a=this;if(0<this.dialogsToShow.length){var b=this.dialogsToShow[0];this.dialogsToShow=this.dialogsToShow.slice(1);var d=function(){b.blockHighlightZone=!0;b.openDialog(function(c){return a.dialogCloseHandler(b,
c)})};if(0<b.settings.OnboardingFeatureId){var e=this.dialogsHandlerMapping[b.settings.OnboardingFeatureId];e&&"function"===typeof e.beforeOpenHandler?setTimeout(function(){e.beforeOpenHandler();setTimeout(d,200)},100):d()}else d()}};a.prototype.dialogCloseHandler=function(a,b){0<a.settings.OnboardingFeatureId&&(a=this.dialogsHandlerMapping[a.settings.OnboardingFeatureId])&&"function"===typeof a.afterCloseHandler&&a.afterCloseHandler();b?this.registerCompletionForAll():this.showNextDialog()};a.prototype.registerCompletionForAll=
function(){for(var a=0;a<this.dialogsToShow.length;a++)this.dialogsToShow[a].registerOnboardingCompletion()};a.prototype.getOpenCloseMoreMenuOnboardingHandlers=function(a){return{beforeOpenHandler:this.getCollapseExpandMoreMenuHandler(a,!1),afterCloseHandler:this.getCollapseExpandMoreMenuHandler(a,!0)}};a.prototype.getCollapseExpandMoreMenuHandler=function(a,b){var c=this;return function(){var g=0<$("."+a).parent("#"+c.settings.moreMainMenuDropdownContainerId).length,d=b?":visible":":not(:visible)";
g&&$("#"+c.settings.moreMainMenuDropdownContainerId).is(d)&&$("."+c.settings.menuContainerCssClass+" ."+c.settings.menuMoreButtonCssClass+" > ."+c.settings.menuLinkCssClass).trigger("click")}};a.prototype.getMoreMenuOnboardingHandlers=function(){return{beforeOpenHandler:this.getForceMainMenuWidthHandler(CCL.CommonConstants.mediaScreenSizes.iPadLandscapeMode+"px",!1),afterCloseHandler:this.getForceMainMenuWidthHandler("auto",!0)}};a.prototype.getForceMainMenuWidthHandler=function(a,b){var c=this;return function(){var g=
b?":visible":":not(:visible)";$("."+c.settings.menuContainerCssClass+" ."+c.settings.menuMoreButtonCssClass).is(g)&&($("."+c.settings.menuItemsCssClass).width(a),$(window).trigger("resize"))}};return a}();e.SkoleIntraTopMenuTour=a})(e.SkoleIntra||(e.SkoleIntra={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.context=b;this.controls=a;this.getExternalGrades();$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return c.pagerEventHandler(b)})}d.prototype.refreshGrid=function(a,b){var c=this;$.post(this.context.WebMethods.GetExternalGradebookContent,{courseId:this.context.CourseId,pageIndex:a,pageSize:b}).done(function(a){null!=a&&(a=$(a),c.controls.Container.replaceWith(a),
c.controls.Container=a,c.getExternalGrades())}).fail(function(a){e.Utils.handleAjaxError(a)})};d.prototype.pagerEventHandler=function(a){a===this.context.Pager.Name&&(a=window[a],this.refreshGrid(a.pageNumber,a.pageSize))};d.prototype.getExternalGrades=function(){var a=this;$.post(this.context.WebMethods.GetExternalGradesForCourse,{courseId:this.context.CourseId}).done(function(b){null!=b&&null!=b.length&&0<b.length?a.fillGrades(b):a.clearGrades()}).fail(function(){a.clearGrades()})};d.prototype.fillGrades=
function(a){var b=this;this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").each(function(c,g){c=$(g);var e=c.data(b.context.DataAttributes.LineItemSourcedId),f=c.data(b.context.DataAttributes.PersonSourcedId),m=d.defaultCellText;$.each(a,function(a,c){if(e===c.LineItemSourcedId&&f===c.PersonSourcedId)return m=b.getCellText(c),!1});c.text(m)})};d.prototype.getCellText=function(a){var b=d.defaultCellText;null!=a.Score&&0<a.Score.length&&(b=a.Score);var c=d.defaultCellText;
null!=a.Scale&&0<a.Scale.length&&(c=a.Scale);return b+" / "+c};d.prototype.clearGrades=function(){this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").empty().text(d.defaultCellText)};d.defaultCellText="-";return d}();e.ExternalGradebook=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.context=a;this.controls=b;this.mappingTypesList.on("change",function(){return c.onMappingTypeChanged()});this.existingAssessmentsList.on("change",function(){return c.onGradeBookItemChanged()});this.existingAssessmentScalesList.on("change",function(){return c.onAssessmentScaleChanged()});this.bindButtonsToEvent()}Object.defineProperty(d.prototype,"mappingTypesList",{get:function(){return this.controls.MappingTypesList},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"existingAssessmentsList",{get:function(){return this.controls.ExistingAssessmentsList},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"existingAssessmentScalesList",{get:function(){return this.controls.ExistingAssessmentScalesList},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentButton",{get:function(){return this.controls.SendButton.length?this.controls.SendButton:this.controls.SaveButton},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"settings",{get:function(){return this.context.Settings},enumerable:!0,configurable:!0});d.addOrUpdateDraftItem=function(a){var b=!0;$.each(d.draftItems,function(c,g){if(a.SyncKey.toLowerCase()===g.SyncKey.toLowerCase())return g.GradeType=a.GradeType,g.AssessmentRecordItemId=a.AssessmentRecordItemId,g.AssessmentScaleId=a.AssessmentScaleId,b=!1});b&&d.draftItems.push(a)};d.getDraftItemsBySyncKeys=function(a){var b=[];$.each(a,function(a,g){$.each(d.draftItems,
function(a,c){if(c.SyncKey.toLowerCase()===g.toLowerCase())return b.push(c),!1})});return b};d.prototype.bindButtonsToEvent=function(){var a=this,b=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";if(!this.controls.SaveButton.is(":disabled"))this.controls.SaveButton.on(b,function(){return a.saveResults()});if(!this.controls.SendButton.is(":disabled"))this.controls.SendButton.on(b,function(){return a.sendResults()})};d.prototype.onMappingTypeChanged=function(){this.setControlAvailability(this.mappingTypesList,
!1);var a=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.mappingTypesList.toggleClass(this.context.CssClasses.DefaultMappingType,a===this.context.Settings.MappingTypeEnum.NotLinked);var b=this.settings.LineItemsSyncKeys;switch(a){case this.context.Settings.MappingTypeEnum.NotLinked:this.hideAndClearAssessmentsDropDownList();this.hideAssessmentScalesDropDownList();this.createDraftVersion(this.context.Settings.MappingTypeEnum.NotLinked,b);break;case this.context.Settings.MappingTypeEnum.OverallAverage:this.hideAndClearAssessmentsDropDownList();
this.setButtonAvailability(!1);if(this.settings.DoesOverallAverageHaveMultipleScales)this.showAssessmentScalesDropDownList();else this.onAssessmentScaleChanged();break;case this.context.Settings.MappingTypeEnum.Assessment:case this.context.Settings.MappingTypeEnum.FinalAssessment:this.hideAssessmentScalesDropDownList();this.setButtonAvailability(!1);this.populateAndShowAssessmentsDropDownList();break;case this.context.Settings.MappingTypeEnum.Manual:this.hideAssessmentScalesDropDownList(),this.hideAndClearAssessmentsDropDownList(),
this.createDraftVersion(this.context.Settings.MappingTypeEnum.Manual,b)}this.setControlAvailability(this.mappingTypesList,!0)};d.prototype.onGradeBookItemChanged=function(){this.setControlAvailability(this.existingAssessmentsList,!1);var a=parseInt(this.existingAssessmentsList.find("option:selected").val(),10);if(a!==this.context.Settings.ExistingAssessmentDefaultValue){this.setControlAvailability(this.mappingTypesList,!1);var b=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.createDraftVersion(b,
this.settings.LineItemsSyncKeys,a);this.setControlAvailability(this.mappingTypesList,!0)}else this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentsList,!0)};d.prototype.hideAndClearAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.hide().empty()};d.prototype.populateAndShowAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.empty();var a=parseInt(this.controls.MappingTypesList.find("option:selected").val(),10),b={courseId:this.settings.CourseId,
termId:this.settings.TermId};a===this.context.Settings.MappingTypeEnum.Assessment?this.populateGradebookItemsList(this.context.WebMethods.GetNormalAssessments,b):a===this.context.Settings.MappingTypeEnum.FinalAssessment&&this.populateGradebookItemsList(this.context.WebMethods.GetFinalAssessments,b);this.controls.ExistingAssessmentsList.show()};d.prototype.onAssessmentScaleChanged=function(){this.setControlAvailability(this.existingAssessmentScalesList,!1);var a=parseInt(this.existingAssessmentScalesList.find("option:selected").val(),
10);a!==this.context.Settings.AssessmentScaleDefaultValue?(this.setControlAvailability(this.mappingTypesList,!1),this.createDraftVersion(this.context.Settings.MappingTypeEnum.OverallAverage,this.settings.LineItemsSyncKeys,null,a),this.setControlAvailability(this.existingAssessmentScalesList,!0)):this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentScalesList,!0)};d.prototype.showAssessmentScalesDropDownList=function(){this.existingAssessmentScalesList.show()};d.prototype.hideAssessmentScalesDropDownList=
function(){this.existingAssessmentScalesList.hide()};d.prototype.populateGradebookItemsList=function(a,b){var c=this;$.get(a,b).done(function(a){c.controls.ExistingAssessmentsList.append($("<option />").val(c.context.Settings.ExistingAssessmentDefaultValue.toString()).text(c.context.LanguageTerms.ExistingAssessmentDefaultText));$.each(a,function(a,b){c.controls.ExistingAssessmentsList.append($("<option />").val(b.GradeBookItemId.toString()).text(b.Title))})}).fail(function(a){e.Utils.handleAjaxError(a)})};
d.prototype.createDraftVersion=function(a,b,c,g){null==c&&(c=this.context.Settings.ExistingAssessmentDefaultValue);null==g&&(g=this.context.Settings.AssessmentScaleDefaultValue);$.each(b,function(b,e){d.addOrUpdateDraftItem({SyncKey:e,GradeType:a,AssessmentRecordItemId:c,AssessmentScaleId:g})});this.updateGradingPeriodSection();e.LineItemsResults.refreshGrid(this.settings.AggregatedSyncItemId)};d.prototype.setButtonAvailability=function(a){this.setControlAvailability(this.currentButton,a)};d.prototype.setControlAvailability=
function(a,b){b?a.removeAttr("disabled"):a.attr("disabled","disabled")};d.prototype.disableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!1);this.setControlAvailability(this.existingAssessmentsList,!1);this.setControlAvailability(this.existingAssessmentScalesList,!1);this.currentButton.addClass(this.context.CssClasses.ButtonWithLoader)};d.prototype.enableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!0);this.setControlAvailability(this.existingAssessmentsList,
!0);this.setControlAvailability(this.existingAssessmentScalesList,!0);this.currentButton.removeClass(this.context.CssClasses.ButtonWithLoader);this.currentButton.blur()};d.prototype.sendResults=function(){this.handleButtonClick(this.context.WebMethods.SendResults,{courseId:this.settings.CourseId,lineItemIds:this.settings.LineItemsSyncKeys})};d.prototype.saveResults=function(){this.handleButtonClick(this.context.WebMethods.SaveResults,{courseId:this.settings.CourseId,termId:this.settings.TermId,draftItems:d.getDraftItemsBySyncKeys(this.settings.LineItemsSyncKeys)})};
d.prototype.handleButtonClick=function(a,b){var c=this;this.currentButton.is(":disabled")||(this.disableMappingControls(),$.post(a,b).done(function(a){var b=c.controls.InformationFeedbackPlaceholder.offset();c.updateGradingPeriodSection();e.LineItemsResults.refreshGrid(c.settings.AggregatedSyncItemId);a&&a.feedbackMessage&&0<a.feedbackMessage.length&&$(document).trigger(e.GradeExport.showFeedbackEventTitle,[a.feedbackMessage,b]);c.enableMappingControls()}).fail(function(a){e.Utils.handleAjaxError(a);
c.enableMappingControls()}))};d.prototype.updateGradingPeriodSection=function(a,b){void 0===a&&(a=!0);void 0===b&&(b=!1);e.GradingPeriod.refreshSection(this.context.Settings.GradingPeriodId,a,b)};d.draftItems=[];return d}();e.AggregatedSyncItem=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b,c,g,d,e,f){this.courseId=a;this.assessmentRecordId=b;this.termId=c;this.gradingPeriodId=g;this.isExpanded=e;this.isSentAreaExpanded=f;this.draftLineItemGradeTypes=d}}(),d=function(){function a(b,c){var g=this;this.context=b;this.controls=c;b=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";this.controls.GradingPeriodsSectionHeader.on(b,function(){return g.onGradingPeriodsHeaderClick()});this.controls.SentLineItemsSectionHeader.on(b,
function(){return g.onSentLineItemsHeaderClick()});$(document).off(a.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId));$(document).on(a.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId),function(a,b,c,d){return g.updateGradingPeriodSection(b,c,d)})}a.prototype.onGradingPeriodsHeaderClick=function(){this.controls.AllLineItemsSection.slideToggle("slow");this.controls.GradingPeriodsSection.toggleClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass);this.controls.GradingPeriodsSectionHeader.toggleClass(this.context.CssClasses.GradingPeriodSectionHeaderCollapsedClass)};
a.prototype.onSentLineItemsHeaderClick=function(){this.controls.SentLineItems.slideToggle("slow");this.controls.SentLineItemsSectionHeader.toggleClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass)};a.getUpdateSectionEventTitle=function(b){return""+a.updateSectionEventTitle+b};a.refreshSection=function(b,c,g){void 0===c&&(c=!0);void 0===g&&(g=!1);$(document).trigger(a.getUpdateSectionEventTitle(b),[c,g,e.AggregatedSyncItem.draftItems])};a.prototype.updateGradingPeriodSection=function(a,
c,g){var b=this,d=!this.controls.GradingPeriodsSection.hasClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass),m=!this.controls.SentLineItemsSectionHeader.hasClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass);a=new f(this.context.Settings.CourseId,this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,this.context.Settings.GradingPeriodId,g,d||a,m||c);$.post(this.context.WebMethods.GradingPeriod,a).done(function(a){a&&0!==a.length&&(a=$(a),$(b.controls.GradingPeriodsSection).replaceWith(a),
$(b.controls.GradingPeriodsSection).removeClass(b.context.CssClasses.GradingPeriodSectionCollapsedClass))}).fail(function(a){e.Utils.handleAjaxError(a)})};a.updateSectionEventTitle="GradingPeriod:UpdateGradingPeriodSection";return a}();e.GradingPeriod=d})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,c,g,d,e){this.courseId=a;this.personId=c;this.lineItemSyncKey=g;this.scoreListItemExtensionId=d;this.currentScore=e}}(),d=function(){return function(a,c,g,d,e,f){void 0===e&&(e="");void 0===f&&(f="");this.courseId=a;this.assessmentRecordId=c;this.termId=g;this.studentNameSearchText=e;this.selectedAggregatedLineItemId=f;this.draftLineItemGradeTypes=d}}(),a=function(){function a(b,g){var c=this;this.context=g;this.controls=b;this.initSearch();
$(document).off(a.refreshGridEventTitle);$(document).on(a.refreshGridEventTitle,function(a,b){return c.updateLineItemsResultsSection(new d(c.context.Settings.CourseId,c.context.Settings.AssessmentRecordId,c.context.Settings.TermId,e.AggregatedSyncItem.draftItems,"",b))})}a.refreshGrid=function(b){$(document).trigger(a.refreshGridEventTitle,b)};a.prototype.initSearch=function(){var a=this;this.controls.SearchImage.on("click",function(){return a.onSearchStudentClick()});this.controls.SearchInput.on("keydown",
function(b){return a.onSearchInputKeyDown(b)})};a.prototype.onSearchStudentClick=function(){this.searchStudents(this.controls.SearchInput.val())};a.prototype.preventEventPropagation=function(a){a.cancelBubble=!0;a.returnValue=!1;a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation()};a.prototype.onSearchInputKeyDown=function(a){a.keyCode===CCL.CommonConstants.keyCodes.enter&&(this.preventEventPropagation(a),this.searchStudents($(a.target).val()))};a.prototype.searchStudents=function(a){this.updateLineItemsResultsSection(new d(this.context.Settings.CourseId,
this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,e.AggregatedSyncItem.draftItems,a?a:""))};a.prototype.updateLineItemsResultsSection=function(a){var b=this;$.post(this.context.WebMethods.LineItemsResults,a).done(function(c){if(c&&0!==c.length){var g=b.controls.SearchInput.attr("id");c=$(c);b.controls.LineItemsResultsTable.parent().empty().prepend(c);a.studentNameSearchText&&$("#"+g).val(a.studentNameSearchText)}}).fail(function(a){e.Utils.handleAjaxError(a)})};a.prototype.handleAjaxError=
function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&a.responseText&&alert(a.responseText)};a.refreshGridEventTitle="LineItemsResults:refreshGrid";return a}();e.LineItemsResults=a;a=function(){function a(a,b){var c=this;this.lineItemCellSelectionChangedEventName="LineItemResultCell:LineItemCellSelectionChanged";this.controls=a;this.context=b;this.isSelected=!1;a=CCL.CommonFunctions.isMobileDevice();this.controls.LineItemResultCell.on(a?"touchstart":"click",function(){return c.focusCell()});
if(!a)this.controls.LineItemResultCell.on("mouseenter",function(){return c.focusCell()});this.controls.LineItemResultCell.focus(function(){return c.onLineitemResultCellFocus()});this.controls.LineItemResultCell.find("*").addBack().blur(function(){return c.onLineitemResultCellBlur()});$(document).on(this.lineItemCellSelectionChangedEventName,function(a,b){c.isSelected&&b!==c.controls.LineItemResultCell.attr("id")&&c.controls.LineItemResultCell.blur()});this.controls.AssessmentScaleItemsList.on("change",
function(a){return c.onAssessmentScaleItemChanged(a)})}a.prototype.focusCell=function(){this.isSelected||this.controls.LineItemResultCell.focus()};a.prototype.onLineitemResultCellFocus=function(){this.isSelected||($(document).trigger(this.lineItemCellSelectionChangedEventName,this.controls.LineItemResultCell.attr("id")),this.controls.LineItemResultCell.addClass(this.context.CssClasses.SelectedCellCssClass),this.controls.LineItemResultCell.height(this.controls.LineItemResultCell.innerHeight()),this.isSelected=
!0)};a.prototype.onLineitemResultCellBlur=function(){var a=this;setTimeout(function(){var b=$(document.activeElement);b.is(a.controls.LineItemResultCell)||0!==a.controls.LineItemResultCell.has(b).length||(a.controls.LineItemResultCell.removeClass(a.context.CssClasses.SelectedCellCssClass),a.controls.LineItemResultCell.css("height",""),a.isSelected=!1)},0)};a.prototype.onAssessmentScaleItemChanged=function(a){a=$(a.target);a.attr("disabled","disabled");var b=this.controls.AssessmentScaleItemsList.val();
b=new f(this.context.Settings.CourseId,this.context.Settings.PersonId,this.context.Settings.LineItemSyncKey,b,this.context.Settings.CurrentScore);this.setCustomScoreListItemExtensionForPerson(b);a.removeAttr("disabled")};a.prototype.setCustomScoreListItemExtensionForPerson=function(a){var b=this;a=JSON.stringify(a);$.ajax({type:"POST",url:this.context.WebMethods.SetCustomScoreListItemExtensionForPerson,data:a,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(){b.controls.AssessmentScaleCurrentItemLabel.text(b.controls.AssessmentScaleItemsList.find("option:selected").text())}).fail(function(a){e.Utils.handleAjaxError(a)})};
return a}();e.LineItemResultCell=a})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.handleAjaxError=function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=a.responseText&&0<a.responseText.length||null!=a.statusText&&0<a.statusText.length)&&alert(null!=a.responseText&&0<a.responseText.length?a.responseText:a.statusText)};return d}();e.Utils=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;$(b.AccordionSelector+" "+b.SectionSelector).click(function(a){c.ShowFeedbackItems(a)})}d.prototype.ShowFeedbackItems=function(a){a=$(a.currentTarget);if(!a.data(this.settings.AccordionSectionLoadedDataAttribute)){a.data(this.settings.AccordionSectionLoadedDataAttribute,!0);var b=a.find(this.settings.ContentSelector);a=b.children().first().data(this.settings.CourseIdDataAttribute);$.ajax({type:"GET",
url:this.settings.WebMethod,data:a?{courseId:a,termId:this.settings.TermId,personId:this.settings.PersonId,personCustomerId:this.settings.PersonCustomerId,reportRoleEnumValue:this.settings.ReportRoleEnumValue,readOnly:this.settings.ReadOnly,returnUrl:this.settings.ReturnUrl,linksTarget:this.settings.LinksTarget}:{termId:this.settings.TermId,personId:this.settings.PersonId},success:function(a,g,d){b.empty().append($(a))},error:function(a,g,d){b.empty();CCL.CommonFunctions.alertAjaxError(a,g,d)}})}};
return d}();e.PersonAssessment=f})(f.Person||(f.Person={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.planLoadingProcessId=null;window[a]=this;d.instanceName=a;this.settings=b;this.terms=b.Terms;this.css=b.Css;this.webMethods=b.WebMethods;this.currentDisplayMode=b.CurrentDisplayMode;$("."+this.css.ExpanderLink).click(function(a){c.expanderLinkClick(a)});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==c.currentDisplayMode&&(c.currentDisplayMode=
a,c.toggleEnableDisplayModeSwitcher(!1),$.post(c.webMethods.TogglePlannerDisplayMode,$.param({plannerDisplayMode:c.currentDisplayMode},!0),function(){c.toggleEnableDisplayModeSwitcher(!0);c.refreshExpandedGrids()}).fail(function(a,b,g){CCL.CommonFunctions.alertAjaxError(a,b,g);c.toggleEnableDisplayModeSwitcher(!0)}))});setTimeout(function(){c.startLoadingMonitor()},100)}d.getInstance=function(){return window[d.instanceName]};d.prototype.openViewCellContentDialog=function(a,b,c,g,d,e){b=b||window.event;
b=b.target||b.srcElement;b&&0<$(b).closest("a,input,button,textarea").length||(b=window[this.settings.ViewHtmlTextCellContentDialog],null!=b&&null!=this.webMethods.GetPlanHtmlTextCellContent&&(b.setAjaxUrl(this.webMethods.GetPlanHtmlTextCellContent,{courseId:c,planId:g,columnId:d,childId:0,filterPersonId:e}),a=$(a).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),b.setTitle(a),b.openDialog()))};d.prototype.expanderLinkClick=function(a){a.preventDefault();a=$(a.currentTarget);
var b=a.parent(),c=a.closest("."+this.css.CoursePlansContainer).find("."+this.css.Plans),g=a.data("grid");g=window[g];b.toggleClass(this.css.Expanded);b.hasClass(this.css.Expanded)?(this.refreshPlanGrid(g),a.prop("title",this.terms.CollapseTooltip)):a.prop("title",this.terms.ExpandTooltip);c.slideToggle("fast")};d.prototype.refreshExpandedGrids=function(){var a=this;$("."+this.css.ExpanderLink).each(function(b,c){c=$(c);b=c.parent();c=c.data("grid");c=window[c];c.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=
a.currentDisplayMode;c.setMode(a.currentDisplayMode===a.settings.DisplayModes.Table?a.css.GridViewModes.TableView:a.css.GridViewModes.DefaultView);b.hasClass(a.css.Expanded)&&a.refreshPlanGrid(c)})};d.prototype.refreshPlanGrid=function(a){if(a.isLoadingInProgress())return!1;this.startLoadingMonitor();a.refresh()};d.prototype.startLoadingMonitor=function(){var a=this;if(null==this.planLoadingProcessId){this.toggleEnableDisplayModeSwitcher(!1);var b=$("."+this.css.ExpanderLink);this.planLoadingProcessId=
setInterval(function(){var c=!0;b.each(function(a,b){a=$(b).data("grid");if(window[a].isLoadingInProgress())return c=!1});c&&(clearTimeout(a.planLoadingProcessId),a.planLoadingProcessId=null,a.toggleEnableDisplayModeSwitcher(!0))},500)}};d.prototype.toggleEnableDisplayModeSwitcher=function(a){window[this.settings.DisplayModeSwitcher].toggleEnableSwitcher(a)};return d}();e.AggregatedPlanner=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,g){var c=this;window[b]=this;a.clientInstanceName=b;this.settings=g;this.inlineEditorOptions={multiline:{multiline:!0,autoResize:!0,editFieldCssClass:this.settings.Css.EditModeTextboxMultiline,watermarkCssClass:this.settings.Css.Watermark},singleline:{submitOnEnter:!0,editFieldAutoWidth:!1,editFieldCssClass:this.settings.Css.EditModeTextboxSingleline,watermarkCssClass:this.settings.Css.Watermark,editFieldDisplayInline:!0}};
$(function(){var a={};a[e.PlannerConstants.events.HybridEditorItemInlineModeChanged]=function(a,b){c.onColumnInlineModeChanged(a,b)};a[e.PlannerConstants.events.HybridEditorItemTextUpdated]=function(a,b){c.onColumnTextUpdated(a,b)};a[e.PlannerConstants.events.HybridEditorItemAjaxError]=function(a,b){c.onAjaxError(a,b)};a[e.PlannerConstants.events.HybridEditorItemSaveError]=function(a,b){c.onSaveError(a,b)};$(document).on(a,"div["+e.PlannerConstants.dataAttributes.HybridEditorItem+"]")})}a.prototype.replaceMediaContentWithPlaceholders=
function(){return!1};a.prototype.getSettings=function(a){var b=this.settings.Css.Watermark;switch(a.Type){case e.ClientColumnType.TopicTitle:var c=this.settings.WebMethods.UpdateTopicTitle;var d={courseId:this.settings.CourseId,topicId:a.EntityId};var f="inline";var k=this.settings.Terms.TopicTitleWatermark;b="";break;case e.ClientColumnType.TopicDescription:c=this.settings.WebMethods.UpdateTopicDescription;d={courseId:this.settings.CourseId,topicId:a.EntityId};f="hybrid";k=this.settings.Terms.ClickToAddText;
break;case e.ClientColumnType.PlanDescription:c=this.settings.WebMethods.UpdatePlanDescription;d={courseId:this.settings.CourseId,planId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()};f="hybrid";k=this.settings.Terms.PlanDescriptionWatermark;break;case e.ClientColumnType.PlanTitle:c=this.settings.WebMethods.UpdatePlanTitle;d={courseId:this.settings.CourseId,planId:a.EntityId};f="inline";k=this.settings.Terms.PlanTitleWatermark;b="";break;case e.ClientColumnType.ClassHours:c=
this.settings.WebMethods.UpdateClassHours;d={courseId:this.settings.CourseId,planId:a.EntityId};f="inline";k="0";b="";break;default:c=this.settings.WebMethods.UpdateCustomColumnContent,f="hybrid",k=this.settings.Terms.ClickToAddText,d={courseId:this.settings.CourseId,columnId:a.ColumnId,entityId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()}}return{hybridEditorClientId:this.settings.HybridEditorClientId,editModeEnabled:f,webMethodParams:d,saveContentWebUrl:c,
inlineEditorOptions:this.getInlineEditorOptions(a),editorDialogTitle:this.settings.Terms.Edit+" "+a.ColumnTitle,textContainerWatermark:k,textContainerWatermarkCssClass:b}};a.prototype.getInlineEditorOptions=function(b){var c=this.inlineEditorOptions.singleline;this.isMultilineColumn(b.Type)?c=this.inlineEditorOptions.multiline:b.Type===e.ClientColumnType.PlanTitle?c=$.extend({},this.inlineEditorOptions.singleline,a.planTitleMaxLength):b.Type===e.ClientColumnType.ClassHours&&(c=$.extend({},this.inlineEditorOptions.singleline,
a.classHoursMaxLength));return c};a.prototype.isMultilineColumn=function(a){return a===e.ClientColumnType.TopicDescription||a===e.ClientColumnType.PlanDescription||a===e.ClientColumnType.RichText};a.prototype.onColumnInlineModeChanged=function(a,b){a=$("#"+a.target.id);var c=this.getColumnData(a);c&&(b.isEditMode||b.isNewTextSaved||c.Type!==e.ClientColumnType.ClassHours||this.removeErrorControlFromCell(a))};a.prototype.onSaveError=function(a,b){a=$("#"+a.target.id);b=b.errorText;var c=this.getColumnData(a);
c&&b&&b.length&&c.Type===e.ClientColumnType.ClassHours&&!this.getErrorControl(a).length&&(a.append(this.renderErrorControl(b)),a.addClass(this.settings.Css.Error))};a.prototype.onAjaxError=function(a,b){b.xhrObject.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(b.xhrObject.responseText?CCL.CommonFunctions.htmlDecode(b.xhrObject.responseText):this.settings.Terms.ErrorMessage)};a.prototype.onColumnTextUpdated=function(a,b){a=$("#"+a.target.id);var c=this.getColumnData(a);a&&(c&&c.Type===
e.ClientColumnType.ClassHours&&this.removeErrorControlFromCell(a),this.updateNoPrintContent(a,b.html),c.Type===e.ClientColumnType.TopicTitle&&b.customData&&e.PlannerUtility.updateTopicFolderNode(b.customData.folderId,b.customData.folderName),this.measureKpiEditPlan())};a.prototype.removeErrorControlFromCell=function(a){var b=this.getErrorControl(a);b.length&&($(a).removeClass(this.settings.Css.Error),b.remove())};a.prototype.updateNoPrintContent=function(a,b){a.closest("."+this.settings.Css.CellWrapper).toggleClass(this.settings.Css.NoPrint,
0===$.trim(b).length)};a.prototype.getErrorControl=function(a){return $(a).children("div.error")};a.prototype.renderErrorControl=function(a){return"<div class='error'>"+a+"</div>"};a.planTitleMaxLength=255;a.classHoursMaxLength=5;a.hybridEditorItemIdDataAttr="hybrid-editor-item-id";return a}();d.PlannerInlineCellBase=a})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c){a.call(this,b,c)}__extends(b,a);b.prototype.getEditorItemSettings=function(b){b=$("#"+b);b=this.getColumnData(b);return a.prototype.getSettings.call(this,b)};b.prototype.measureKpiEditPlan=function(){e.CbPlanner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){var b=a.closest("."+this.settings.Css.CbCellContainer),c=a.closest("."+this.settings.Css.CbPlanContainer);a=parseInt(b.data(e.PlannerConstants.dataAttributes.ColumnId),
10);var g=parseInt(b.data(e.PlannerConstants.dataAttributes.ColumnType),10);c=parseInt(c.data(e.PlannerConstants.dataAttributes.PlanId),10);b=b.data(e.PlannerConstants.dataAttributes.ColumnTitle);return{ColumnId:a,Type:g,IsPlanColumn:!0,EntityId:c,ColumnTitle:b}};return b}(d.PlannerInlineCellBase);d.PlannerCBInlineCell=a})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(){function a(a){var b=this;this.settings=a;this.terms=a.Terms;this.css=a.Css;this.contextDialog=new ContextDialog("#"+this.settings.TimeSpanPickerContentPanelId,{title:this.terms.DateContextDialogTitle,footerContent:this.settings.TimeSpanPickerFooterPanelId,setFocus:!1,width:530,zIndex:5});this.closeContextDialog=this.contextDialog.closeDialog;$(function(){b.contextDialog.setCloseFunction(function(a){b.completeEditPlanDate(a)});
$(document).on("click","."+b.css.DateLink,function(a){b.contextDialog.mainContainer.is(":visible")||b.editPlanDate(a)});$("#"+b.settings.CloseContextDialogButton).click(function(){b.contextDialog.closeDialog()})})}a.prototype.editPlanDate=function(a){var b=this,c=$(a.currentTarget),g=this.getDatePicker();this.contextDialog.mainContainer.removeClass(this.css.CellError);this.currentPlanId=this.getCurrentPlanId(c);c=c.parent().find("input:hidden");var d=eval("("+c.val()+")");this.setDefaultDate(g,c);
g.setShowPopUpCallback(function(){b.openContextDialog(a);b.contextDialog.mainContainer.find(":radio:checked:first").focus()});g.showTimeSpan(d,this.currentPlanId)};a.prototype.completeEditPlanDate=function(a){if(!a||!$(a.target).parents().andSelf().hasClass("ui-datepicker"))switch(this.getDatePicker().getCurrentMode()){case e.DatePickerMode.TimeSpan:this.updatePlanTimeSpan(this.currentPlanId);break;case e.DatePickerMode.WeekAndDay:this.updatePlanWeekAndDay(this.currentPlanId);break;case e.DatePickerMode.Event:this.updatePlanEvents(this.currentPlanId)}};
a.prototype.closeDatePicker=function(){this.closeContextDialog()};a.prototype.getDatePicker=function(){return window[this.settings.TimeSpanPickerInstanceName]};return a}();a.PlanDateCellBase=b})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(b){a.call(this,b);this.courseId=b.CourseId;this.$contentBlockContainer=$("#"+b.ContentBlockClientId);this.cbPlanner=e.CbPlanner.getInstance()}__extends(b,a);b.prototype.updatePlanTimeSpan=function(a){var b=this,c=this.getDatePicker();$.post(this.settings.WebMethods.UpdatePlanTimeSpan,$.param({courseId:this.courseId,planId:a,start:c.getStartDate(),stop:c.getStopDate(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()},!0),function(a){a?b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.TimeSpan)}).fail(function(){c.showErrorMsg(e.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,c=this.getDatePicker();$.post(this.settings.WebMethods.UpdatePlanWeekAndDay,$.param({courseId:this.courseId,planId:a,start:c.getStartWeek(),stop:c.getStopWeek(),filterStartDate:this.cbPlanner.getFilterStartDate(),filterStopDate:this.cbPlanner.getFilterStopDate()},
!0),function(a){a?b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.WeekAndDay)}).fail(function(){c.showErrorMsg(e.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,c=this.getDatePicker(),g=c.getEvents();$.post(this.settings.WebMethods.UpdatePlanEvents,$.param({courseId:this.courseId,planId:a,activityIdsJson:JSON.stringify(g),filterStartDate:this.cbPlanner.getFilterStartDate(),filterStopDate:this.cbPlanner.getFilterStopDate()},!0),function(a){a?b.finalizeUpdateDate(a):
c.showErrorMsg(e.DatePickerMode.Event)}).fail(function(){c.showErrorMsg(e.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(a,b){this.getDatePicker().setDefaultDate(this.cbPlanner.getFilterStartDate())};b.prototype.openContextDialog=function(a){var b=$(a.target).closest("."+this.settings.Css.CellContent);a=b.position();b=b.offset();this.contextDialog.openDialogAt(a.left+b.left+10,a.top+b.top-70,!1)};b.prototype.updateContent=function(a,b){a=$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,
a)).find("."+this.css.CellContent);var c=a.parent();a.replaceWith(b);this.cbPlanner.toggleTooltipForField(c.find("."+this.css.CellContent),!0,this.settings.Terms.Tooltip)};b.prototype.getCurrentPlanId=function(a){return parseInt(a.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId).toString(),10)};b.prototype.finalizeUpdateDate=function(a){this.closeDatePicker();a.hidePlan?(this.showFeedback(a.message,a.extraButtonText,a.navigationUrl,a.periodStartDate),this.hidePlan(a.planId)):
this.updateContent(a.planId,a.dateCell)};b.prototype.showFeedback=function(a,b,c,g){var d=this;CCL.InformationFeedback.showFeedbackWithextraButton(this.$contentBlockContainer,a,b,function(){c?window.location.href=c:g&&d.cbPlanner.changeDatePeriod(g);CCL.InformationFeedback.hideFeedback(d.$contentBlockContainer)})};b.prototype.hidePlan=function(a){1<$("."+this.settings.Css.PlanContainer).length?$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,
a)).remove():this.cbPlanner.reloadPlans()};return b}(a.PlanDateCellBase);a.PlanCbDateCell=b})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(){function a(b,c,d){var g=this;a.clientInstanceName=b;window[b]=this;this.settings=c;this.$plannerContainer=d;$(function(){g.loSelector=window[g.settings.LearningObjectiveSelectorInstanceName];g.attachEvents()})}a.getPlanLearningObjectivesCellInstance=function(){return window[a.clientInstanceName]};a.prototype.updateContent=function(a,b){this.getLearningObjectivesListCell(b).html(a)};a.prototype.updateLearningObjectives=
function(a){var b=this,c=this.currentPlanId;$.post(this.settings.WebMethods.AddPlanLearningObjectives,$.param({courseId:this.settings.CourseId,learningObjectiveIds:a,planId:c},!0),function(a){a&&b.updateContent(a,c)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.removeLOFromPlan=function(a,b,c){a={courseId:this.settings.CourseId,planId:a,learningObjectiveId:b};void 0!=c&&(a.showCollapsedList=c);return $.post(this.settings.WebMethods.RemovePlanLearningObjective,a).fail(CCL.CommonFunctions.alertAjaxError)};
a.prototype.attachEvents=function(){var a=this;this.$plannerContainer.on("click","."+this.settings.Css.AddLearningObjectivesLink,function(b){a.currentPlanId=a.getCurrentPlanId($(b.currentTarget));a.loSelector.setSelectedIds(a.getLearningObjectiveIds(a.currentPlanId,!1),!0);a.loSelector.openDialog()});$(document).on("click","."+this.settings.Css.RemoveLearningObjectiveLink,function(b){b=$(b.currentTarget);a.removeLearningObjective(b)})};a.prototype.getLearningObjectiveDataAttribute=function(a){return a?
e.PlannerConstants.dataAttributes.RepositoryLearningObjectiveId:e.PlannerConstants.dataAttributes.LearningObjectiveId};return a}();a.PlanLearningObjectivesCellBase=b})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(b,c){a.call(this,b,c,e.CbPlanner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var c=this,g=this.getCurrentPlanId(b),d=parseInt(b.closest("."+this.settings.Css.LearningObjectivesListItem).data(e.PlannerConstants.dataAttributes.LearningObjectiveId),10);a.prototype.removeLOFromPlan.call(this,g,d).done(function(){b.closest("."+c.settings.Css.LearningObjectivesListItem).remove()})};
b.prototype.getCurrentPlanId=function(a){a=a.closest("."+this.settings.Css.CbPlanContainer);return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId),10)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.CbPlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.AddLearningObjectivesLink).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getLearningObjectiveIds=function(a,b){a=this.getLearningObjectivesListCell(a);
var c=this.getLearningObjectiveDataAttribute(b);b=a.find("."+this.settings.Css.LearningObjectivesListItem+CCL.CommonFunctions.getDataSelector(c));return $.map(b,function(a){return parseInt($(a).data(c),10)})};return b}(a.PlanLearningObjectivesCellBase);a.PlanCbLearningObjectivesCell=b})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b){this.planId=a;this.columnId=b}}();e.PlanColumnId=f;var d=function(){function a(b,c){var g=this;window[b]=this;a.instanceName=b;this.settings=c;this.events=c.Events;this.css=c.Css;this.webMethods=c.WebMethods;this.terms=c.Terms;this.data=c.DataAttributes;this.currentDisplayMode=c.CurrentDisplayMode;this.kpi=c.Kpi;this.courseId=this.settings.CourseId;this.container=$("#"+c.Controls.ContainerId);this.plannerFilter=$("#"+c.Controls.PlannerFilterId);
this._ajaxLoader=$("#"+c.Controls.AjaxLoader);this._ajaxLoaderOverlay=$("#"+c.Controls.AjaxLoaderOverlay);setTimeout(function(){g.showNoTopicMessageIfNecessary()},0);var d=this;if(this.settings.Events&&this.settings.Events.TimelineControlInitialized&&this.currentDisplayMode===this.settings.DisplayModes.Timeline)$(document).on(this.settings.Events.TimelineControlInitialized,function(){g.toggleEnableDisplayModeSwitcher(!1);g.toggleTimelineMode(!0);g.toggleEnableDisplayModeSwitcher(!0)});CCL.CommonFunctions.attachPostMessageEventListener($(window),
CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==d.currentDisplayMode&&(d.currentDisplayMode=a,null!=d.webMethods&&null!=d.webMethods.Common&&null!=d.webMethods.Common.TogglePlannerDisplayMode?(d.toggleEnableDisplayModeSwitcher(!1),$.post(d.webMethods.Common.TogglePlannerDisplayMode,$.param({courseId:d.settings.CourseId,plannerDisplayMode:d.currentDisplayMode,childId:d.settings.ChildId},!0),function(){d.toggleEnableDisplayModeSwitcher(!0);d.changeDisplayMode()}).fail(function(a,
b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);d.toggleEnableDisplayModeSwitcher(!0)})):d.changeDisplayMode())});this.settings.ReadOnlyMode||(CCL.CommonFunctions.attachPostMessageEventListener($(window),e.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,a.customId,!0)}),$.fn.scrollParent=function(){return $(document)})}a.prototype.changeDisplayMode=
function(){var a=this;this.toggleTimelineMode(this.isTimelineCurrentMode());this.isTimelineCurrentMode()||$.each(e.Cards.TopicCard.getAllTopicCards(),function(b,g){g.changeDisplayMode(a.currentDisplayMode)})};a.getInstance=function(){return window[a.instanceName]};a.prototype.getSetDateDialog=function(){return window[this.settings.Controls.SetDateDialog]};a.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};a.prototype.getTopicColorPicker=function(){return window[this.settings.TopicColorPickerInstanceName]};
a.prototype.openViewCellContentDialog=function(a,c,g,d){c=c||window.event;c=c.target||c.srcElement;c&&0<$(c).closest("a,input,button,textarea").length||(c=window[this.settings.Controls.ViewHtmlTextCellContentDialog],null!=c&&null!=this.webMethods.Column.GetPlanHtmlTextCellContent&&(c.setAjaxUrl(this.webMethods.Column.GetPlanHtmlTextCellContent,null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planId:g,columnId:d,childId:this.settings.ChildId,filterPersonId:0}:{publicAccessKey:this.settings.PublicAccessKey,
planId:g,columnId:d}),a=$(a).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),c.setTitle(a),c.openDialog()))};a.prototype.getContainer=function(){return this.container};a.prototype.getPlannerFilter=function(){return this.plannerFilter};a.prototype.getPlannerFeedback=function(){return window[this.settings.Controls.Feedback]};a.prototype.showConfirmDialog=function(a,c,g,d){void 0===g&&(g="");void 0===d&&(d="");CCL.CommonFunctions.jAjaxConfirm(a,this.terms.ConfirmTitle,""===
g?this.terms.Yes:g,""===d?this.terms.No:d,c)};a.prototype.parseDateFromString=function(a){return null!=a?$.datepicker.parseDate(this.settings.DateFormat,a):null};a.prototype.showNoTopicMessageIfNecessary=function(){this.isTimelineCurrentMode()||this.settings.UseTopics&&this.container.find("."+this.css.NoTopicsMessage).toggle(!this.hasTopicsOrPlansWithoutTopic())};a.prototype.togglePlannerSharing=function(){$("#"+this.settings.Controls.ShareMenuItem).toggle(this.hasTopics());$("#"+this.settings.Controls.StopSharingMenuItem).toggle(this.hasTopics())};
a.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};a.prototype.hasTopicCardContainers=function(a){return this.settings.UseTopics?0<e.Cards.TopicCard.getAllTopicCardContainers(a).length:!1};a.prototype.hasTopics=function(){return this.hasTopicCardContainers(!0)};a.prototype.hasTopicsOrPlansWithoutTopic=function(){return this.hasTopicCardContainers(!1)};a.prototype.getPlannerCellCssClass=function(){return this.currentDisplayMode===
this.settings.DisplayModes.Table?this.css.TableCell:this.css.ListCell};a.prototype.toggleEnableDisplayModeSwitcher=function(a){window[this.settings.Controls.DisplayModeSwitcher].toggleEnableSwitcher(a)};a.prototype.isTimelineCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Timeline};a.prototype.getCurrentDisplayMode=function(){return this.currentDisplayMode};a.prototype.isTableCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table};
a.prototype.toggleTimelineMode=function(a){var b=$("#"+this.settings.Controls.GridContainerId);b&&(this.settings.UseTopics?b.toggle(!a):e.Cards.TopicCard.getAllTopicCards()[0].getPlanGrid().getRowsContainer().toggle(!a));(b=e.PlannerTimeline.getInstance())&&b.toggleTimeline(a,this.settings.UseTopics?this.hasTopics():!0);this.disableTopicToolbarActionItems(a)};a.prototype.disableTopicToolbarActionItems=function(a){if(!this.settings.ReadOnlyMode)if(this.settings.UseTopics){var b=$("#"+this.settings.Controls.AddTopicLink),
g=$("#"+this.settings.Controls.ActionLink),d=[];d.push(b);d.push(g);e.Cards.TopicCard.disableMenuItems(d,a,this.settings.Css.DisabledMenuItem,this.settings.Css.DisabledMenuItemContainer,this.settings.Terms.DisableTopicMenuTooltip)}else e.Cards.TopicCard.getAllTopicCards()[0].disablePlanMenu(a)};a.prototype.loadLargePlanTextContent=function(a){var b=this,g=$("."+CCL.CommonFunctions.getDataSelector(this.data.TopicId,a)).find("."+this.css.HtmlTextContentPlaceHolder);if(0===g.length)this.completeLoadingLargePlanContent(a);
else{var d=[];$.each(g,function(a,c){a=$(c);d.push(new f(a.data(b.data.PlanId),a.data(b.data.ColumnId)))});this.processPlanColumnChunks(this.prepareChunks(d)).done(function(){return b.completeLoadingLargePlanContent(a)})}};a.prototype.stopSharingPlanner=function(){var a=this;this.showConfirmDialog(this.settings.Terms.StopSharingPlannerConfirmText,function(b){b&&(a.toggleLoading(!0),$.ajax({type:"POST",url:a.webMethods.ShareablePlanner.StopSharingPlanner,traditional:!0,data:{courseId:a.settings.CourseId,
plannerShareableObjectId:a.settings.ShareableObjectId},dataType:"json"}).done(function(){window.location=window.location}).fail(function(b,c,d){a.toggleLoading(!1);CCL.CommonFunctions.alertAjaxError(b,c,d)}))})};a.prototype.processPlanColumnChunks=function(a){var b=this,g=a.splice(0,this.settings.ChunkSizeForLoadingLargeText);return 0===g.length?$.when():$.when.apply($,g.map(function(a){return b.getPlanCellsWithLargeTextPromise(a)})).then(function(){b.processPlanColumnChunks(a)})};a.prototype.prepareChunks=
function(a){if(!a||0===a.length)return[];for(var b=[],g=!0;g;)g=a.splice(0,this.settings.ChunkSizeForLoadingLargeText),b.push(g),g=0<a.length;return b};a.prototype.getPlanCellsWithLargeTextPromise=function(a){var b=this,g=[],d=[];a.forEach(function(a){g.push(a.planId);d.push(a.columnId)});return $.post(this.webMethods.Plan.LoadCellsWithLargeText,$.param(null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planIds:g,columnIds:d,childId:this.settings.ChildId,currentDisplayMode:this.currentDisplayMode}:
{publicAccessKey:this.settings.PublicAccessKey,planIds:g,columnIds:d,currentDisplayMode:this.currentDisplayMode},!0)).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)}).done(function(a){a&&($.each(a.cellList,function(a,c){b.getPlanTextContentPlaceHolder(c.PlanId,c.ColumnId).replaceWith(c.Content)}),a.columnDataList&&e.Cells.InlineCell.PlannerInlineCell.getInstance().addColumnsToEdit(a.columnDataList))})};a.prototype.getPlanTextContentPlaceHolder=function(a,c){return $("."+this.css.HtmlTextContentPlaceHolder+
CCL.CommonFunctions.getDataSelector(this.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this.data.ColumnId,c))};a.prototype.toggleLoading=function(a){this._ajaxLoaderOverlay.toggle(a);this._ajaxLoader.toggle(a)};a.prototype.completeLoadingLargePlanContent=function(a){a=e.Cards.TopicCard.getInstance(a);a.removePlanGridMessage();a.loadingLargePlanContentCompleted=!0};return a}();e.Planner=d})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(b){var c=this;this.loadingLargePlanContentCompleted=!0;window[a.getTopicCardInstanceName(b.TopicId)]=this;this._settings=b;var g=e.Planner.getInstance();this._topicId=this._settings.TopicId;g.settings.ReadOnlyMode||(this._termStartDate=g.parseDateFromString(this._settings.TermStartDate),this._termEndDate=g.parseDateFromString(this._settings.TermEndDate));this.hasPlans=this._settings.HasPlans;this.hasConnectedFolder=this._settings.HasConnectedFolder;
$(function(){c._planGrid=window[c._settings.PlanGridInstanceName];c._container=$("#"+c._settings.ContainerId);c._topicExpander=c._container.find("."+a.css.TopicExpander);c._topicCheckBox=window[c._settings.TopicCheckBoxInstanceName];c._topicExpanderLink=c._container.find("#"+c._settings.TopicExpanderLinkId);c._topicColorPickerLink=c._container.find("#"+c._settings.TopicColorPickerLinkId);c.attachEvents();c.isTopicExpanded()&&!g.isTimelineCurrentMode()&&$(function(){c.refreshPlanGrid();0<c._settings.PlanIdToScroll&&
(c._planIdToScroll=c._settings.PlanIdToScroll)})})}a.setCommonSettings=function(b){a.planner=e.Planner.getInstance();a.commonSettings=b;a.css=a.commonSettings.Css;a.terms=a.commonSettings.Terms;a.isIos=a.planner.settings.IsIos;a.planner.settings.ReadOnlyMode||a.hideTopicMoveOptionsIfNecessary();null!=b.DisplayModeSwitcher&&(a.planner.settings.Controls.DisplayModeSwitcher=b.DisplayModeSwitcher)};a.getInstance=function(b){return window[a.getTopicCardInstanceName(b)]};a.getInstanceByContainer=function(b){b=
b.data(a.planner.data.TopicId);return window[a.getTopicCardInstanceName(b)]};a.prototype.getColorPickerLink=function(){return this._topicColorPickerLink};a.prototype.getColorSchema=function(){return this._settings.TopicColorSchema};a.prototype.getTopicCardContainer=function(){return this._container};a.topicCardsExist=function(){return null!=a.commonSettings};a.prototype.getTopicCheckBox=function(){return this._topicCheckBox};a.getAllTopicCardContainers=function(b){if(!a.topicCardsExist())return $();
var c="";b&&(c="[data-"+a.planner.data.TopicId+"!=0]");return $("."+a.commonSettings.Css.TopicContainer+c)};a.getAllTopicCards=function(){var b=[];a.getAllTopicCardContainers().each(function(c,g){c=a.getInstanceByContainer($(g));null!=c&&b.push(c)});return b};a.getTopicCardsForTopicIds=function(b){var c=[];null!=b&&0<b.length&&a.getAllTopicCardContainers().each(function(g,d){g=a.getInstanceByContainer($(d));null!=g&&-1<b.indexOf(g._topicId)&&c.push(g)});return c};a.getPlansForAllTopics=function(){return a.topicCardsExist()?
$("."+a.css.Plans+" ."+a.css.PlanContainer):$()};a.getParentTopicCardContainer=function(b){return b.closest("."+a.commonSettings.Css.TopicContainer)};a.getParentTopicCard=function(b){b=a.getParentTopicCardContainer(b);return a.getInstanceByContainer(b)};a.getParentPlanContainer=function(b){return b.closest("."+a.commonSettings.Css.PlanContainer)};a.prototype.getPlanGrid=function(){return this._planGrid};a.prototype.getSelectedPlanIds=function(b){var c=this._planGrid.getSelectedValues();return c.length?
c:(b&&jAlert(a.terms.NothingSelected),null)};a.prototype.clearPlanSelection=function(){return this._planGrid.toggleSelectAll(!1)};a.clearAllTopicSelection=function(){a.planner.getContainer().find("."+a.css.TopicSelector).each(function(b,c){(b=a.getParentTopicCard($(c)))&&b.isTopicSelected()&&(c=b.getTopicCheckBox())&&(c.toggle(!1),b.toggleTopicSelection())})};a.getSelectedTopicIds=function(b){var c=[];a.topicCardsExist()&&a.planner.getContainer().find("."+a.css.TopicSelector).each(function(b,d){(b=
a.getParentTopicCard($(d)))&&b.isTopicSelected()&&c.push(b._topicId)});return c.length?c:(b&&jAlert(e.Planner.getInstance().terms.NoTopicsSelected),null)};a.prototype.showPlanFeedbackMessage=function(a,c){this._planGrid.getFeedback().showMessage(a,c)};a.prototype.appendNewPlan=function(b,c){this._planGrid.removeEmptyText();this._planGrid.getRowsContainer().append(b);a.planner.currentDisplayMode===a.planner.settings.DisplayModes.Table&&this._planGrid.updateHeaderRowCheckBoxSelection();c&&this.scrollToPlan(c);
e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop(this._container)};a.prototype.removePlansFromGrid=function(a,c){for(var b in a)a.hasOwnProperty(b)&&this.getPlanContainerById(a[b]).remove();this._planGrid.updateFreezeState();0===this._planGrid.getRowsCount()&&this._planGrid.getRowsContainer().html(c)};a.prototype.getPlanContainerById=function(a){return this._planGrid.getRowById(a)};a.prototype.sortPlans=function(a){for(var b in a)a.hasOwnProperty(b)&&
this._planGrid.getRowsContainer().append(this.getPlanContainerById(a[b]))};a.prototype.refreshPlanGrid=function(b){if(this._planGrid.isLoadingInProgress())return!1;a.startLoadingMonitor();a.planner.settings.ReadOnlyMode||this.disablePlanMenu(!0);this._planGrid.refresh().done(function(){b&&b()})};a.prototype.getTopicExpander=function(){return this._topicExpander};a.prototype.getTopicExpanderLink=function(){return this._topicExpanderLink};a.prototype.updateTopicExpanderLink=function(a){this._topicExpanderLink.html(a)};
a.prototype.toggleTopicSelection=function(){var b=this.isTopicSelected();this._planGrid.toggleSelectAll(b);this._planGrid.toggleDisableAll(b);this.disablePlanMenu(b,a.terms.DisabledMenuItemTooltip);this.toggleDisablePlanActionMenu(b)};a.prototype.isTopicSelected=function(){return this._topicCheckBox?this._topicCheckBox.isChecked():!1};a.prototype.getTopicId=function(){return this._topicId};a.prototype.getTopicName=function(){return this._settings.TopicName};a.prototype.setTopicColorSchema=function(b,
c){this._settings.TopicColorSchema=b;this._container.find("."+a.css.TopicColorContainer).removeClass().addClass(a.css.TopicColorContainer).addClass(c)};a.prototype.getLastPlanId=function(){return this._planGrid.getRowPrimaryKeyValueByIndex(this._planGrid.getRowsCount()-1)};a.prototype.getPlanIds=function(){return this._planGrid.getAllValues()};a.prototype.containsPlanElements=function(a){var b=this,g=!1;$.each(a,function(a,c){return 0<b.getPlanContainerById(c).find(e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getActivityResourceListItemSelector()).length?
(g=!0,!1):!0});return g};a.prototype.updatePlanCellsCallback=function(a){if(null!=a){for(var b={needToReloadFolders:!1},g=0;g<a.length;g++)this.refreshCell(a[g],b);a=top;b.needToReloadFolders&&a.reloadFolder&&a.reloadFolder("item0","planner",!0,!0)}};a.prototype.redirectToSharePlans=function(a){a=CCL.CommonFunctions.formatString(this._settings.SharePlansPageUrlTemplate,a);window.location=a};a.prototype.redirectToShareTopic=function(){var a=CCL.CommonFunctions.formatString(this._settings.ShareTopicPageUrlTemplate,
this._topicId);window.location=a};a.setDefaultDate=function(b,c){if(c=a.getInstance(c)){var g=Date.now();c=null!=c._termStartDate&&g<c._termStartDate||null!=c._termEndDate&&g>c._termEndDate?c._termStartDate:null;b.setDefaultDate(void 0!=c?c:null)}};a.prototype.setTermDates=function(a,c){this._termStartDate=a;this._termEndDate=c};a.hideTopicMoveOptionsIfNecessary=function(){var b=a.getAllTopicCardContainers(!0);0<b.length&&$.each(b,function(c,g){if(g=$(g).find(CCL.CommonFunctions.getDataSelector(a.planner.data.DropDownMenuClientId)).attr("data-"+
a.planner.data.DropDownMenuClientId))if(g=$(document).find("#"+g))g.find(CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveUpMenu)+","+CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveDownMenu)).show(),0===c&&g.find(CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveUpMenu)).hide(),c===b.length-1&&g.find(CCL.CommonFunctions.getDataSelector(a.planner.data.TopicMoveDownMenu)).hide()})};a.prototype.showPlanActionMenu=function(){$("."+a.planner.css.PlanActionMenu).show()};
a.prototype.hidePlanMoveOptionsIfNecessary=function(){var b=this._planGrid.getRows();if(0<b.length){$("."+a.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.TopicId,this._topicId)).show();$("."+a.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.TopicId,this._topicId)).show();var c=b.first().data(a.planner.data.GridRowId);$("."+a.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.PlanId,c)).hide();b=
b.last().data(a.planner.data.GridRowId);$("."+a.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(a.planner.data.PlanId,b)).hide()}};a.topicExpanderLinkClick=function(b){b.preventDefault();b=$(b.currentTarget);var c=a.getParentTopicCardContainer(b),g=a.getInstanceByContainer(c);c=c.find("."+a.css.Plans);var d=g.getTopicExpander(),e=g.getPlanGrid();d.toggleClass(a.css.TopicExpanded);d.hasClass(a.css.TopicExpanded)?(e.getFeedback().hide(),g.refreshPlanGrid(),b.prop("title",a.terms.CollapseTooltip)):
b.prop("title",a.terms.ExpandTooltip);c.slideToggle("fast")};a.prototype.scrollToPlan=function(b){var c=this,g=0,d=window,e=!1;a.isIos&&window!==window.top&&(g+=$('iframe[name="mainmenu"]',window.top.document).offset().top,d=window.top,e=!0);$("html, body",d.document).stop().animate({scrollTop:g+this.getPlanContainerById(b).offset().top-this._planGrid.getToolbarElement().outerHeight()},function(){a.isIos&&c._planGrid.updateFreezeState(e)})};a.prototype.changeDisplayMode=function(b){this.updateGridView(b);
b=b!==a.planner.settings.DisplayModes.Timeline;a.planner.settings.UseTopics&&(b=b&&this.isTopicExpanded());b&&this.refreshPlanGrid()};a.disableMenuItems=function(a,c,g,d,e){$.each(a,function(a,b){a=$(b);b=a.parent("li");var f=a.html(),h=a.attr("class");b.children("span."+g).remove();c?(b.addClass(d),a.hide(),b=$("<span>").attr("class",h).attr("disabled","disabled").addClass(g).html(f),null!=e&&b.prop("title",e),a.after(b)):(b.removeClass(d),a.show())})};a.prototype.disablePlanMenu=function(b,c){var g=
this._container.find("."+a.css.PlanGridToolbar).children("."+a.css.PlanGridToolbarItemsLeft).find("."+a.css.IconLink);a.disableMenuItems(g,b,a.css.DisabledMenuItem,a.css.DisabledMenuItemContainer,c)};a.prototype.toggleDisablePlanActionMenu=function(b){var c=this._container.find($("."+a.planner.css.PlanActionMenu));$.each(c,function(c,d){c=$(d);c.toggleHyperlink(!b);c.prop("title",b?a.terms.DisabledMenuItemTooltip:"")})};a.prototype.removePlanGridMessage=function(){this._planGrid.removeGridMessage()};
a.prototype.scrollToSelectedPlanOnLoad=function(b){var c=this;0>=b||setTimeout(function(){c._container.find("."+a.planner.css.HtmlTextCellViewer+" img[height]").each(function(a,b){a=$(b);b=parseInt(a.attr("height"))/parseInt(a.attr("width"));isNaN(b)||a.height()||(a.addClass("temp-height"),a.height(b*a.width()))});c.scrollToPlan(c._settings.PlanIdToScroll);$(window).one("resize",function(){$(".temp-height").removeClass("temp-height").height("")})},500)};a.getTopicCardInstanceName=function(b){return a.commonSettings.TopicCardInstanceNamePrefix+
b};a.prototype.isTopicExpanded=function(){return this._topicExpander.hasClass(a.css.TopicExpanded)};a.prototype.refreshCell=function(a,c){switch(a.ColumnType){case e.ColumnType.Date:this.refreshDateCell(a);break;case e.ColumnType.LearningObjectives:this.refreshPlanLoCell(a);break;case e.ColumnType.Resources:case e.ColumnType.Activities:case e.ColumnType.Elements:this.refreshElementCell(a),c.needToReloadFolders=!0}};a.prototype.refreshDateCell=function(a){e.Cells.Plan.DateCell.PlanDateCell.getPlanDateCellInstance().updateContent(a.Content,
a.PlanId,a.Properties.planActive);a.Properties.expanderText&&this.updateTopicExpanderLink(a.Properties.expanderText)};a.prototype.refreshElementCell=function(a){e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(a.Content,a.PlanId,a.ColumnId,!1,!1)};a.prototype.refreshPlanLoCell=function(a){e.Cells.Plan.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(a.Content,a.PlanId)};a.prototype.attachEvents=
function(){var b=this;a.planner.settings.ReadOnlyMode||($(document).on(a.planner.events.PlanActivationChanged,function(a,g){a=g.planActivations;null!=a&&$.each(a,function(a,c){0<b.getPlanContainerById(c.planId).length&&b._planGrid.toggleRowStatus(c.planId,c.planActive)})}),this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,function(){b.showPlanActionMenu();b.toggleTopicSelection();b.hidePlanMoveOptionsIfNecessary()}));this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,
function(){b.loadLargePlanTextContent();null!=b._planIdToScroll&&(b.scrollToSelectedPlanOnLoad(b._planIdToScroll),b._planIdToScroll=null)});this._topicExpanderLink.click(a.topicExpanderLinkClick);this._topicCheckBox&&this._topicCheckBox.setOnChangeCallback(function(){return b.toggleTopicSelection()});a.planner.settings.ReadOnlyMode||this._topicColorPickerLink.click(function(){b._container.off(a.planner.events.ColorPickerColorChange);0<b._topicId&&(a.planner.getTopicColorPicker().setupAndOpenTopicColorPicker(b._topicId),
b._container.on(a.planner.events.ColorPickerColorChange,function(c,g){a.planner.getTopicColorPicker().updateTopicColor(b._topicId,g)}))})};a.prototype.loadLargePlanTextContent=function(){0<this._planGrid.totalCount&&(this.loadingLargePlanContentCompleted=!1,this._planGrid.addGridLoadingMessage(),a.planner.loadLargePlanTextContent(this._topicId))};a.prototype.updateGridView=function(b){this._planGrid.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=b;this._planGrid.setMode(b===a.planner.settings.DisplayModes.Table?
a.planner.css.GridViewModes.TableView:a.planner.css.GridViewModes.DefaultView)};a.startLoadingMonitor=function(){if(null==a.planLoadingProcessId){a.planner.toggleEnableDisplayModeSwitcher(!1);var b=a.getAllTopicCards();a.planLoadingProcessId=setInterval(function(){var c=!0;$.each(b,function(a,b){return b.getPlanGrid().isLoadingInProgress()||!b.loadingLargePlanContentCompleted?c=!1:!0});c&&(clearTimeout(a.planLoadingProcessId),a.planLoadingProcessId=null,a.planner.toggleEnableDisplayModeSwitcher(!0),
a.planner.settings.ReadOnlyMode||e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop())},500)}};a.planLoadingProcessId=null;return a}();f.TopicCard=d})(e.Cards||(e.Cards={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,g){window[b]=this;a.instanceName=b;this.settings=g;this.css=this.settings.Css;this._planner=e.Planner.getInstance()}a.getInstance=function(){return window[a.instanceName]};a.prototype.togglePlanContentExpanderLink=function(a,b,d){a=$(a);a.hasClass(this.css.ExpanderLinkExpanded)?this.collapsePlanContentItems(a):this.expandPlanContentItems(a,b,d)};a.prototype.collapsePlanContentItems=function(a){var b=a.parent().find("li").toArray();
b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay);$.each(b,function(a,b){$(b).hide()});a.children("span").first().text(this.settings.Terms.ShowMore);a.removeClass(this.css.ExpanderLinkExpanded)};a.prototype.expandPlanContentItems=function(a,b,d){a.parent().find("ul").hasClass(this.css.ContentListPartiallyLoaded)?d&&d(a):(b=a.parent().find("li").toArray(),b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay),$.each(b,function(a,b){$(b).show()}),a.children("span").first().text(this.settings.Terms.ShowLess),
a.addClass(this.css.ExpanderLinkExpanded))};a.prototype.loadAllPlanElements=function(a,b,e){var c=this;$.get(this.settings.WebMethods.LoadAllPlanElements,$.param(null==this._planner.settings.PublicAccessKey?{courseId:this._planner.settings.CourseId,planId:b,columnId:e,childId:this._planner.settings.ChildId,dashboardHierarchyId:this._planner.settings.DashboardHierarchyId,dashboardName:this._planner.settings.DashboardName}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b,columnId:e},
!0)).done(function(g){c._planner.settings.ReadOnlyMode?a.closest("."+c._planner.getPlannerCellCssClass()).html(g):d.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(g,b,e,!1,!1)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};a.prototype.loadAllLearningObjectives=function(a,b){var c=this;$.post(this.settings.WebMethods.LoadAllPlanLearningObjectives,$.param(null==this._planner.settings.PublicAccessKey?{courseId:this._planner.settings.CourseId,
planId:b,childId:this._planner.settings.ChildId}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b},!0),function(g){c._planner.settings.ReadOnlyMode?a.closest("."+c._planner.getPlannerCellCssClass()).html(g):d.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(g,b)}).fail(CCL.CommonFunctions.alertAjaxError)};return a}();d.PlanExpandableContentCellCommonLogic=a})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){(function(d){(function(a){var b=function(){function a(a,b){this.fileUploadInProgress=!1;this.fakeElementItemId="fakeElementItemId";this.uploadProgressDataAttributeName="upload-in-progress";this.settings=a;this.courseId=b}a.prototype.attachEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.RemoveFromPlanLink,function(b){b=$(b.currentTarget);a.removeElementFromPlan(b)}).on("click","."+this.settings.Css.AddElementMenuItem+", ."+this.settings.Css.AddElementShowAllMenuItem,
function(b){b=$(b.currentTarget);switch(a.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ElementExternalSource)){case f.AddResourceMenu.ElementExternalSourceType.Library:a.addFromLibrary(b);break;case f.AddResourceMenu.ElementExternalSourceType.Course:a.addFromCourse(b);break;case f.AddResourceMenu.ElementExternalSourceType.Computer:1===a.getDataAttributeValueAsNumber(b,a.uploadProgressDataAttributeName)?CCL.CommonFunctions.jAlertAjaxError(a.settings.Terms.WaitUntilPreviousFileIsUploaded,
"",a.settings.Terms.Ok,!1):a.addFromComputer(b)}(b=CCL.AlternativeChoiceManager.getOpenedDialog())&&b.closeDialog()}).on("click","."+this.settings.Css.AddElementLink,function(b){a.openElementSelector($(b.currentTarget))});this.attachSpecificEvents()};a.prototype.openElementSelector=function(a){var b=this,c=this.getPlanId(a),d=this.getElementType(a),g=this.getColumnId(a),k=this.getFolderId(a);d=this.settings.ElementSelectorClientInstanceNameTemplate.replace("{0}",d.toString());d=window[d];var n=d.getFirstColumn().find("a");
n.each(function(a,d){a=$(d);a.attr("href",b.updateAddLinkUrl(a.attr("href"),c,k))});d.getSecondColumn().find("a").each(function(a,b){$(b).attr("data-"+e.PlannerConstants.dataAttributes.PlanId,c).attr("data-"+e.PlannerConstants.dataAttributes.ColumnId,g).attr("data-"+e.PlannerConstants.dataAttributes.FolderId,k)});var r=d.getSecondColumn().find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.ElementExternalSource,f.AddResourceMenu.ElementExternalSourceType.Computer));r.css("opacity",
this.fileUploadInProgress?"0.5":"");r.attr("data-"+this.uploadProgressDataAttributeName,this.fileUploadInProgress?"1":"0");d.openDialog(a,this.getElementDialogOffset());CCL.CommonFunctions.isMobileDevice()||n.first().focus()};a.prototype.deletePlanElement=function(a,b,c){return $.post(this.settings.WebMethods.DeletePlanElement,{courseId:this.courseId,planId:a,elementId:b,deleteFromCourse:c}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.addFromLibrary=function(a){var b=this.getDataAttributeValueAsNumber(a,
e.PlannerConstants.dataAttributes.ElementType),c=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.FolderId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);a=this.getLibraryBrowserDialog();b={RelatedEntityId:c,ElementCategory:this.getElementCategoryAsStringByElementType(b),FolderId:d,CustomId:g.toString()};b.LearningObjectivesIds=this.getLearningObjectiveIds(c,
!0);a.browseLibrary(b)};a.prototype.addFromCourse=function(a){var b=this,c=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType),d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);a={locationId:this.courseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};var k=[],n=new Map;this.loadCurrentElementStates(d,g,n);c={elementStates:n,elementType:c,
showAll:!1,header:this.getElementLinkDialogTitle(c),afterOkClickCallback:function(a){a&&(a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||k.push(b)}),0<k.length&&b.updatePlanElements(d,k,g))},allowFolderSelection:c!==f.ElementLinkDialog.ContentElementType.Activities,openerPage:f.ElementLinkDialog.ElementsPopupOpener.Plan,relatedEntityId:d};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,a)};a.prototype.addFromComputer=
function(a){this.currentPlanId=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId);this.currentColumnId=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);$("#"+Components.ComponentName.localPicker).click()};a.prototype.onFileUploadSuccess=function(a){var b=this;this.fileUploadInProgress&&$.post(this.settings.WebMethods.CreateNewFileForPlan,{courseId:this.courseId,planId:this.currentPlanId,fileName:a.name,fileId:a.id,signedFileId:a.signature}).done(function(a){a.Success?
b.refreshResourcesCell(b.currentPlanId,b.currentColumnId,!0):($("#"+b.fakeElementItemId).remove(),CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1))}).fail(function(){$("#"+b.fakeElementItemId).remove();CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1)}).always(function(){b.fileUploadInProgress=!1;b.currentColumnId=void 0;b.currentPlanId=void 0})};
a.prototype.onFileUploadFailed=function(a,b){var c=this;this.fileUploadInProgress=!1;CCL.CommonFunctions.jAjaxConfirm(b,this.settings.Terms.FailedFileUploadChoiceDialogTitle,this.settings.Terms.FailedFileUploadChoiceDialogUploadNewFile,this.settings.Terms.FailedFileUploadChoiceDialogCancel,function(a){a?$("#"+Components.ComponentName.localPicker).click():(c.currentColumnId=void 0,c.currentPlanId=void 0)});$("#"+this.fakeElementItemId).remove()};a.prototype.onFileSelected=function(a){this.fileUploadInProgress=
!0;a='<li id="'+this.fakeElementItemId+'" class="'+this.settings.Css.ActivityResourceListItem+'">\n    <div class="'+this.settings.Css.FakeElementContainer+'">\n        <img class="'+this.settings.Css.FakeElementImage+'" src="'+this.settings.LoadingIconUrl+'" />\n        <i class="'+this.settings.Css.FakeElementTitle+'">'+a[0].name+"</i>\n    </div>\n</li>";this.getActivityResourceList(this.currentPlanId,this.currentColumnId).append($(a))};a.prototype.updatePlanElements=function(a,b,c){var d=this;
return $.post(this.settings.WebMethods.UpdatePlanElements,$.param({courseId:this.courseId,planId:a,elementIds:b,columnId:c},!0)).done(function(){d.refreshResourcesCell(a,c,!0)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getDataAttributeValueAsNumber=function(a,b){return parseInt(a.attr("data-"+b),10)};a.prototype.getElementLinkDialogTitle=function(a){return a===f.ElementLinkDialog.ContentElementType.Activities?this.settings.Terms.AddActivityModalTitle:this.settings.Terms.AddResourceModalTitle};
a.prototype.getElementCategoryAsStringByElementType=function(a){switch(a){case f.ElementLinkDialog.ContentElementType.Resources:return e.ElementCategory[e.ElementCategory.Resource];case f.ElementLinkDialog.ContentElementType.Activities:return e.ElementCategory[e.ElementCategory.Activity]}};a.prototype.loadCurrentElementStates=function(a,b,c){$.post(this.settings.WebMethods.GetPlanElements,$.param({courseId:this.courseId,planId:a,columnId:b},!0),function(a){a&&$.each(a.elementIds,function(a,b){c.set(b,
f.CheckboxStateMachine.State.Saved)})}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getPlanContainer=function(a){return a.closest("."+this.settings.Css.PlanContainer)};a.prototype.updateAddLinkUrl=function(a,b,c){var d=a.lastIndexOf("?"),g=a.substring(0,d);a=a.substring(d+1).split("&");for(d=0;d<a.length;d++){var e=a[d].substring(0,a[d].indexOf("="));e.toLowerCase()===this.settings.RequestParameters.FolderId.toLowerCase()?a[d]=e+"="+c:e.toLowerCase()===this.settings.RequestParameters.RelatedEntityId.toLowerCase()&&
(a[d]=e+"="+b)}return g+"?"+a.join("&")};a.prototype.getElementType=function(a){return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType)};return a}();a.PlanResourcesCellBase=b})(d.ResourcesCell||(d.ResourcesCell={}))})(k.Plan||(k.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(c,d){a.call(this,d,d.CourseId);window[c]=this;b.instanceName=c;this.attachEvents();this.cbPlanner=e.CbPlanner.getInstance()}__extends(b,a);b.getPlanActivityResourceCellInstance=function(){return window[b.instanceName]};b.onFileUploadSuccess=function(a){b.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};b.onFileUploadFailed=function(a,c){b.getPlanActivityResourceCellInstance().onFileUploadFailed(a,
c)};b.onFileSelected=function(a){b.getPlanActivityResourceCellInstance().onFileSelected(a)};b.prototype.refreshResourcesCell=function(a,b,c){this.reloadPlanElements(a,b);c&&this.measureKpiEditPlan()};b.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.AddHomework,function(b){a.openElementSelector($(b.currentTarget))})};b.prototype.removeElementFromPlan=function(b){var c=this,d=b.closest("."+this.settings.Css.ActivityResourceListItem);b=this.getPlanId(b);
var g=this.getDataAttributeValueAsNumber(d,e.PlannerConstants.dataAttributes.ElementId);a.prototype.deletePlanElement.call(this,b,g,!1).done(function(){d.remove();c.measureKpiEditPlan()})};b.prototype.getLibraryBrowserDialog=function(){return this.cbPlanner.getLibraryBrowserDialog()};b.prototype.getActivityResourceCell=function(a,b){return this.getActivityResourceList(a,b).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getActivityResourceList=function(a,b){return $("."+this.settings.Css.PlanContainer+
CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.ActivityResourceCell)};b.prototype.getLearningObjectiveIds=function(a,b){var c=d.LearningObjectivesCell.PlanLearningObjectivesCellBase.getPlanLearningObjectivesCellInstance();return c?c.getLearningObjectiveIds(a,b):[]};b.prototype.measureKpiEditPlan=function(){this.cbPlanner.measureEditPlan()};b.prototype.reloadPlanElements=function(a,b){var c=this;$.post(this.settings.WebMethods.ReloadPlanElements,
$.param({courseId:this.courseId,planId:a,columnId:b},!0)).done(function(d){c.getActivityResourceCell(a,b).html(d)}).fail(CCL.CommonFunctions.alertAjaxError)};b.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId)};b.prototype.getColumnId=function(a){return 0};b.prototype.getElementDialogOffset=function(){return-35};b.prototype.getFolderId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,
e.PlannerConstants.dataAttributes.FolderId)};return b}(a.PlanResourcesCellBase);a.PlanCbResourcesCell=b})(d.ResourcesCell||(d.ResourcesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.name=a;this.settings=b;window[this.name]=this;d.instanceName=this.name;this.settings=b;this.$useTopicsCheckbox=$("#"+this.settings.ClientIds.UseTopics);this.topicColumnsGrid=window[this.settings.TopicColumnsGridInstanceName];this.planColumnsGrid=window[this.settings.PlanColumnsGridInstanceName];this.$enableAnonymousAccessCheckbox=$("#"+this.settings.ClientIds.EnableAnonymousAccess);this.$addPlanRichTextColumnLink=$("#"+this.settings.ClientIds.AddPlanColumnLink);
this.countOfPlanRichTextColumns=this.settings.PlanRichColumnsCount;this.deletedTopicColumns=[];this.deletedPlanColumns=[];$(function(){c.toggleTopicSettings();c.togglePublicCopyLink();c.togglePlanDefaultStatusContainer();c.toggleAddPlanRichTextColumnLink();c.toggleElementsColumns();c.disableDragAndDropForColumnsByIds(c.settings.NotReorderableTopicColumnIds,!0);c.disableDragAndDropForColumnsByIds(c.settings.NotReorderablePlanColumnIds,!1);c.attachEvents();c.findRowTeplates()})}d.getInstance=function(){return window[d.instanceName]};
d.prototype.deleteCustomColumn=function(a,b){var c=this;a=$(a);var d=a.closest("."+this.settings.Css.GridRow);a.data(this.settings.DataAttributes.HasData)?this.showConfirmDialog(b?this.settings.Terms.DeleteCustomTopicColumnConfirmText:this.settings.Terms.DeleteCustomPlanColumnConfirmText,function(a){a&&(c.cacheDeletedItem(d,b),d.remove())}):(this.cacheDeletedItem(d,b),d.remove());b||(this.countOfPlanRichTextColumns--,this.toggleAddPlanRichTextColumnLink());return!1};d.prototype.afterOpenCopyPublicLinkDialog=
function(){$.ajax({type:"POST",url:this.settings.MeasureCopyPublicLinkUrl})};d.prototype.save=function(){var a=!0;this.$useTopicsCheckbox.prop("checked")&&(a=this.validateColumnNames(this.topicColumnsGrid,!0));a=this.validateColumnNames(this.planColumnsGrid,a)&&a;if(!a)return event.stopPropagation(),!1;this.collectDataForSaving();return!0};d.prototype.showConfirmDialog=function(a,b){$.alerts.okButton=this.settings.Terms.Yes;$.alerts.cancelButton=this.settings.Terms.No;jConfirm(a,this.settings.Terms.ConfirmTitle,
b)};d.prototype.cacheDeletedItem=function(a,b){var c={};c.Id=a.data(this.settings.DataAttributes.GridRowId);c.IsDeleted=!0;0<c.Id&&(b?this.deletedTopicColumns.push(c):this.deletedPlanColumns.push(c))};d.prototype.addTopicCustomColumn=function(){this.addGridRow(this.topicColumnsGrid,this.$topicColumnTemplate)};d.prototype.addPlanCustomColumn=function(){this.$addPlanRichTextColumnLink.getIfHyperLinkEnabled()&&(this.addGridRow(this.planColumnsGrid,this.$planColumnTemplate),this.countOfPlanRichTextColumns++,
this.toggleAddPlanRichTextColumnLink())};d.prototype.findRowTeplates=function(){this.$topicColumnTemplate=this.topicColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$topicColumnTemplate.detach();this.$planColumnTemplate=this.planColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$planColumnTemplate.detach()};d.prototype.addGridRow=function(a,b){var c=b.clone(!0).data(this.settings.DataAttributes.GridRowId,this.settings.NewColumnId);a.getRowsContainer().append(c);a=b.find(this.settings.ShowOnCoursePageInputSelector);
0<a.length&&(b=CCL.CommonFunctions.formatString(this.settings.ToggleInstanceNameTemplate,a[0].id),a=window[b],b=b+"_clone"+(new Date).getTime(),a.clone(c,b));c.find("input."+this.settings.Css.ColumnTitle).focus()};d.prototype.validateColumnNames=function(a,b){var c=this,d=!0,e;a.getRowsContainer().find("input."+this.settings.Css.ColumnTitle+":visible").each(function(a,b){a=$(b);d=c.validateColumnName(a)&&d;null!=e||d||(e=a)});null!=e&&b&&window.scrollTo(0,e.offset().top);return d};d.prototype.validateColumnName=
function(a){if(0===a.val().trim().length)return a.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","visible"),!1;a.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","");return!0};d.prototype.toggleTopicSettings=function(){var a=this.$useTopicsCheckbox.prop("checked");$("#"+this.settings.ClientIds.TopicsHolder).toggle(a);var b=$("#"+this.settings.ClientIds.CreateFolderForEachNewTopic);a?(b.removeProp("readonly"),b.off("click",this.disabledCheckboxOnClick)):(b.prop("readonly",
"readonly"),b.on("click",this.disabledCheckboxOnClick))};d.prototype.togglePublicCopyLink=function(){var a=this.$enableAnonymousAccessCheckbox.prop("checked");$("#"+this.settings.ClientIds.CopyPublicLink).toggle(a)};d.prototype.togglePlanDefaultStatusContainer=function(){var a=$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).val()===this.settings.PlanActivationTypeManually;$("#"+this.settings.ClientIds.AutoActivationInfoContainer).toggle(!a);$("#"+this.settings.ClientIds.PlanDefaultStatusContainer).toggle(a)};
d.prototype.toggleElementsColumns=function(){for(var a=$("#"+this.settings.ClientIds.ElementColumnsRadioList+" input:checked").val()===this.settings.UseGenericElementsColumn,b=this.planColumnsGrid,c=0;c<this.settings.SeparateElementColumnIds.length;c++)$(b.getRowById(this.settings.SeparateElementColumnIds[c])).toggle(!a);$(b.getRowById(this.settings.GenericElementsColumnId)).toggle(a)};d.prototype.reorderFieldSuccess=function(){$("#"+this.settings.ClientIds.ReorderDataHiddenField).val("true")};d.prototype.collectDataForSaving=
function(){if(this.$useTopicsCheckbox.prop("checked")){var a=$("#"+this.settings.ClientIds.TopicColumnDataHiddenField),b=this.topicColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(a,b,this.deletedTopicColumns)}a=$("#"+this.settings.ClientIds.PlanColumnDataHiddenField);b=this.planColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(a,b,this.deletedPlanColumns)};d.prototype.collectData=function(a,b,c){var d=this,e=[];b.each(function(a,
b){a=$(b);b=a.find("."+d.settings.Css.ColumnTitle);var g=a.find("."+d.settings.Css.ColumnType),f=a.find("."+d.settings.Css.ColumnVisibleFor),h=a.find(d.settings.ShowOnCoursePageInputSelector),l={};l.Id=a.data(d.settings.DataAttributes.GridRowId);l.Title=b.val().trim();l.ColumnType=g.val();l.VisibleFor=f.val();l.ShowOnCoursePage=h.is(":checked");l.IsDeleted=!1;e.push(l);e=e.concat(c)});a.val(JSON.stringify(e))};d.prototype.attachEvents=function(){var a=this;this.$useTopicsCheckbox.on("change",function(){a.toggleTopicSettings()});
this.$enableAnonymousAccessCheckbox.on("change",function(){a.togglePublicCopyLink()});$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).on("change",function(){a.togglePlanDefaultStatusContainer()});this.topicColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(b){b=$(b.currentTarget);a.validateColumnName(b)});this.planColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(b){b=$(b.currentTarget);
a.validateColumnName(b)});$("#"+this.settings.ClientIds.ElementColumnsRadioList).on("change",function(){a.toggleElementsColumns()})};d.prototype.disableDragAndDropForColumnsByIds=function(a,b){b=b?this.topicColumnsGrid:this.planColumnsGrid;for(var c=0;c<a.length;c++)b.getRowById(a[c]).removeClass(this.settings.Css.ReorderableGridRow)};d.prototype.toggleAddPlanRichTextColumnLink=function(){var a=this.countOfPlanRichTextColumns<this.settings.MaxNumberOfRichTextColumnsInPlan;this.$addPlanRichTextColumnLink.toggleHyperlink(a);
a?this.$addPlanRichTextColumnLink.removeAttr("title"):this.$addPlanRichTextColumnLink.attr("title",this.settings.Terms.AddPlanRichTextColumnLinkDisabledTooltip)};d.prototype.disabledCheckboxOnClick=function(){return!1};return d}();e.CustomizePlanner=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.CurrentParameters=d;d=function(){function a(a,c){window[a]=this;this.settings=c;this.$container=$("#"+this.settings.Controls.ContainerId)}a.prototype.clearContainer=function(){this.$container&&(this.$container.find("iframe,object").css("visibility","hidden"),this.$container.html(""))};a.prototype.openDialog=function(a,c,d,e,f){this.currentParameters||(this.currentParameters={});this.currentParameters.EventId=c;this.currentParameters.CourseId=
a;null!=d&&window[this.settings.Controls.DialogTarget].setTitle(d);void 0!=e&&(this.currentParameters.ViewForPersonId=e);void 0!=f&&(this.currentParameters.ChildId=f);this.clearContainer();window[this.settings.Controls.DialogTarget].openDialog()};a.prototype.loadEventPlans=function(){if(this.currentParameters){var a=this.$container;a&&$.ajax({type:"GET",url:this.settings.WebMethods.GetEventPlansXhtml,async:!1,data:{courseId:this.currentParameters.CourseId,eventUniqueId:this.currentParameters.EventId,
childId:null==this.currentParameters.ChildId?0:this.currentParameters.ChildId,viewForPersonId:null==this.currentParameters.ViewForPersonId?0:this.currentParameters.ViewForPersonId,dashboardHierarchyId:this.settings.DashboardHierarchyId},dataType:"html"}).done(function(b){return a.html(b)}).fail(function(b){return a.html(b.responseText)})}};a.prototype.togglePlanDetails=function(a,c,d,e,f,m){var b=this,g=this,h=$(a),l=h.parent().find("."+this.settings.CssClasses.PlanContainerCss);a=l.is(":visible");
h.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.PlanDetailsExpanderImage)).toggleClass(this.settings.CssClasses.ForwardImage,a).toggleClass(this.settings.CssClasses.ChevronDownImage,!a);l.data(this.settings.DataAttributes.PlanDetailsContentLoaded)||$.ajax({type:"GET",url:this.settings.WebMethods.GetSinglePlanXhtml,async:!1,data:{courseId:c,planId:d,childId:e,viewForPersonId:f,showFullPlannerLink:m,dashboardHierarchyId:this.settings.DashboardHierarchyId},dataType:"html"}).done(function(a){l.html(a);
l.data(g.settings.DataAttributes.PlanDetailsContentLoaded,"true")}).fail(function(a){return l.html(a.responseText)});l.slideToggle("fast",function(){h.prop("title",l.is(":visible")?b.settings.Terms.HideDetails:b.settings.Terms.ViewDetails);l.css("overflow","")})};return a}();e.EventPlansDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(b,c){var d=this;window[b]=this;a.instanceName=b;this._settings=c;this._planner=e.Planner.getInstance();$("#"+c.MoveToTopicOkButtonId).click(function(){d.movePlansToTopicOkBtnClick()})}a.getInstance=function(){return window[a.instanceName]};a.prototype.openDialog=function(a,c){void 0===c&&(c=null);var b=e.Cards.TopicCard.getInstance(a);null==c&&(c=b.getSelectedPlanIds(!0));null!=c&&(this.initTopicDropDownListControl(),this._topicId=
a,this._planIds=c,this.reloadTopicList(),this._topicDropDownList.val(a.toString()),0<this._topicDropDownList.children().length&&this.getCssModal().openDialog())};a.prototype.movePlansToTopicOkBtnClick=function(){var a=this,c=this._topicId,d=this._topicDropDownList.val();if(c==d)CssModal.closeDialog();else{var f=e.Cards.TopicCard.getInstance(c),l=e.Cards.TopicCard.getInstance(d),m=f.getPlanGrid(),k=l.getPlanGrid();$.post(this._planner.webMethods.Plan.MovePlansToTopic,$.param({courseId:this._planner.settings.CourseId,
srcTopicId:c,dstTopicId:d,planIds:this._planIds,start:this._planner.settings.FilterStartDate,end:this._planner.settings.FilterEndDate,showPlanDates:this._planner.settings.ShowDates},!0),function(b){m.toggleSelectAll(!1);k.removeEmptyText();var c=!l.hasPlans&&a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table;f.hasPlans=b.srcTopicHasPlans;l.hasPlans=!0;if(k.getGridElement().is(":visible"))if(c)for(l.refreshPlanGrid(),c=0;c<b.sortedPlanIds.length;c++)m.getRowById(b.sortedPlanIds[c]).remove();
else{c=k.getRowsContainer();for(var d=0;d<b.sortedPlanIds.length;d++)c.append(m.getRowById(b.sortedPlanIds[d]));a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table&&k.updateHeaderRowCheckBoxSelection();l.isTopicSelected()&&l.toggleTopicSelection()}else for(c=0;c<b.sortedPlanIds.length;c++)m.getRowById(b.sortedPlanIds[c]).remove();0===m.getRowsCount()&&m.getRowsContainer().html(b.emptyGridText);f.updateTopicExpanderLink(b.srcExpanderText);l.updateTopicExpanderLink(b.dstExpanderText);
f.hidePlanMoveOptionsIfNecessary();l.hidePlanMoveOptionsIfNecessary();CssModal.closeDialog()})}};a.prototype.initTopicDropDownListControl=function(){null==this._topicDropDownList&&(this._topicDropDownList=$("#"+this._settings.TopicDropDownListId))};a.prototype.reloadTopicList=function(){var a=this;this._topicDropDownList.empty();e.Cards.TopicCard.getAllTopicCardContainers().each(function(b,d){b=$(d);b=e.Cards.TopicCard.getInstanceByContainer(b);b=$('<option value="'+b.getTopicId()+'"></option>').text(b.getTopicName());
a._topicDropDownList.append(b)})};a.prototype.getCssModal=function(){return window[this._settings.MoveToTopicCssModalId]};return a}();f.PlanMoveToTopicDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Initial=0]="Initial";a[a.Progress=1]="Progress";a[a.Error=2]="Error";a[a.Result=3]="Result"})(d||(d={}));var a;(function(a){a[a.CopyPlans=0]="CopyPlans";a[a.CopyTopics=1]="CopyTopics"})(a||(a={}));var b=function(){function b(a,c){window[a]=this;b.instanceName=a;this._settings=c;this._terms=c.Terms;this._css=c.Css;this._controls=c.Controls;this._webMethods=c.WebMethods;this._overwriteAssessmentCriteriaStateEnum=c.OverwriteAssessmentCriteriaStateEnum;
this._controlInitialized=!1}b.prototype.open=function(b,c,e){if(null!=c){this.initControls();this._idsToCopy=c();if(b){if(null==this._idsToCopy||!this._idsToCopy.length){jAlert(this._terms.NoTopicsSelected);return}this._currentCopyMode=a.CopyTopics;this._selectCourseLabel.text(this._terms.CopyTopicsToCourse)}else{if(null==this._idsToCopy||!this._idsToCopy.length){jAlert(this._terms.NoPlansSelected);return}this._currentCopyMode=a.CopyPlans;this._selectCourseLabel.text(this._terms.CopyPlansToCourse)}this._clearSelectionCallback=
e;this.setCopyStage(d.Initial);this.getCssModal().openDialog()}};b.prototype.copy=function(){var b=this;if(this._coursesList.val()){this.setCopyStage(d.Progress);var c=0<this._optionOverwriteAssessmentCriteria.length?this._optionOverwriteAssessmentCriteria.prop("checked"):!1;this._currentCopyMode===a.CopyPlans?$.post(this._webMethods.CopyPlans,$.param({sourceCourseId:this._settings.CourseId,targetCourseId:parseInt(this._coursesList.val()),clearDates:this._optionClearDates.prop("checked"),copyResourcesAndActivities:this._optionCopyResourcesAndActivities.prop("checked"),
overwriteAssessmentCriteria:c,planIds:this._idsToCopy},!0),function(a){b._resultMessageHolder.html(a.ResultMessage);b._resultNotesHolder.hide();0<a.ResultWarningNotes.length&&(b._resultNotesHolder.show(),b._resultNotesHolder.find("ol").html(a.ResultWarningNotes).show());b.setCopyStage(d.Result)}).fail(function(){b.setCopyStage(d.Error)}):$.post(this._webMethods.CopyTopics,$.param({sourceCourseId:this._settings.CourseId,targetCourseId:parseInt(this._coursesList.val()),clearDates:this._optionClearDates.prop("checked"),
copyResourcesAndActivities:this._optionCopyResourcesAndActivities.prop("checked"),overwriteAssessmentCriteria:c,topicIds:this._idsToCopy},!0),function(a){b._resultMessageHolder.html(a.ResultMessage);b._resultNotesHolder.hide();0<a.ResultWarningNotes.length&&(b._resultNotesHolder.show(),b._resultNotesHolder.find("ol").html(a.ResultWarningNotes).show());b.setCopyStage(d.Result)}).fail(function(){b.setCopyStage(d.Error)})}else this._selectCourseErrorContainer.show()};b.prototype.getCssModal=function(){return window[this._settings.CssModalClientInstance]};
b.prototype.initControls=function(){var a=this;this._controlInitialized||(this._selectCourseLabel=$("#"+this._controls.SelectCourseLabel),this._coursesList=$("#"+this._controls.CoursesList),this._optionClearDates=$("#"+this._controls.OptionClearDates),this._optionOverwriteAssessmentCriteria=$("#"+this._controls.OptionOverwriteAssessmentCriteria),this._optionCopyResourcesAndActivities=$("#"+this._controls.OptionCopyResourcesAndActivities),this._resultMessageHolder=$("#"+this._controls.ResultMessageHolder),
this._resultNotesHolder=$("#"+this._controls.ResultNotesHolder),this._overwriteAssessmentCriteriaPanel=$("#"+this._controls.OverwriteAssessmentCriteriaPanel),this._dialogCancelButton=$("#"+this._controls.DialogCancelButton),this._dialogOkButton=$("#"+this._controls.DialogOkButton),this._dialogCloseButton=$("."+this._css.DialogCloseButton),this._initialPanel=$("#"+this._controls.InitialPanel),this._progressPanel=$("#"+this._controls.ProgressPanel),this._resultPanel=$("#"+this._controls.ResultPanel),
this._errorPanel=$("#"+this._controls.ErrorPanel),this._copyOptions=$("#"+this._controls.CopyOptions),this._selectCourseErrorContainer=this._initialPanel.find("."+this._css.CopyError),this._coursesList.on("change",function(b){a.onCourseListChange(b)}),this._controlInitialized=!0)};b.prototype.setCopyStage=function(a){switch(a){case d.Initial:this._coursesList.val(null);this._optionClearDates.prop("checked",!1);this._optionCopyResourcesAndActivities.prop("checked",!1);0<this._overwriteAssessmentCriteriaPanel.length&&
(this._overwriteAssessmentCriteriaPanel.show(),this.setOverwriteAssessmentCriteriaControlsState(this._overwriteAssessmentCriteriaStateEnum.Show,!0));this._dialogOkButton.text(this._terms.Copy);this._copyOptions.hide();this._selectCourseErrorContainer.hide();break;case d.Result:null!=this._clearSelectionCallback&&this._clearSelectionCallback();break;case d.Error:this._dialogOkButton.text(this._terms.Retry)}this._dialogCloseButton.toggle(a!==d.Progress);this._dialogCancelButton.toggle(a!==d.Progress).text(a===
d.Initial?this._terms.Cancel:this._terms.Close);this._dialogOkButton.toggle(a===d.Initial||a===d.Error);this._initialPanel.toggle(a===d.Initial);this._progressPanel.toggle(a===d.Progress);this._resultPanel.toggle(a===d.Result);this._errorPanel.toggle(a===d.Error)};b.prototype.setOverwriteAssessmentCriteriaControlsState=function(a,b){0<this._optionOverwriteAssessmentCriteria.length&&(this._optionOverwriteAssessmentCriteria.prop("disabled",a===this._overwriteAssessmentCriteriaStateEnum.Disable),this._overwriteAssessmentCriteriaPanel.toggleClass(this._css.Inactive,
a===this._overwriteAssessmentCriteriaStateEnum.Disable),this._overwriteAssessmentCriteriaPanel.find("#"+this._controls.OverwriteAssessmentCriteriaLabel).toggle(a===this._overwriteAssessmentCriteriaStateEnum.Disable),b&&this._optionOverwriteAssessmentCriteria.prop("checked",!1))};b.prototype.onCourseListChange=function(a){a=$(a.currentTarget).val();this._selectCourseErrorContainer.toggle(!a);this._copyOptions.toggle(0!==a.length);0<this._overwriteAssessmentCriteriaPanel.length&&(this._settings.OverwriteAssessmentCriteriaStateData?
(a=parseInt(this._settings.OverwriteAssessmentCriteriaStateData[a]),this._overwriteAssessmentCriteriaPanel.toggle(a!==this._overwriteAssessmentCriteriaStateEnum.Hide),0<this._optionOverwriteAssessmentCriteria.length&&this.setOverwriteAssessmentCriteriaControlsState(a,!1)):this._overwriteAssessmentCriteriaPanel.toggle(a!==this._settings.CourseId))};return b}();e.PlannerCopyDialog=b})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;d.instanceName=a;this._settings=b;this._terms=b.Terms;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId}d.getInstance=function(){return window[d.instanceName]};d.prototype.addTopic=function(a,b,c,d){$.ajax({type:"POST",url:this._planner.webMethods.Topic.AddTopic,data:{courseId:this._courseId,topicName:a,topicColorSchema:b},success:function(a){null!=c&&c();window.location.href=a},error:function(a,
b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);null!=d&&d()}})};d.prototype.shareTopic=function(a,b){var c=this;if(a){var d=e.Cards.TopicCard.getInstance(a);$.ajax({type:"POST",url:this._planner.webMethods.ShareablePlanner.CheckTopicDataForSharing,data:{courseId:this._courseId,topicId:a,isTopicSharedByAnotherAuthor:b},success:function(a){a&&a.conflictMessage?jAlert(a.conflictMessage):a&&a.warningMessage?c._planner.showConfirmDialog(a.warningMessage,function(a){a&&d.redirectToShareTopic()}):d.redirectToShareTopic()},
error:CCL.CommonFunctions.alertAjaxError})}};d.prototype.stopSharingTopic=function(a,b){b&&$.ajax({type:"POST",url:this._planner.webMethods.ShareablePlanner.StopSharingTopic,data:{courseId:this._courseId,topicId:b},success:function(a){a&&a.message?jAlert(a.message):window.location=window.location},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.deleteTopic=function(a){this.deleteTopics([a],!1)};d.prototype.deleteTopics=function(a,b){var c=this;void 0===a&&(a=null);void 0===b&&(b=!0);b&&null==
a&&(a=e.Cards.TopicCard.getSelectedTopicIds(!0));null!=a&&(b=this.getDeleteTopicsConfirmationMessage(a),this._planner.showConfirmDialog(b,function(b){b&&$.post(c._planner.webMethods.Topic.DeleteTopics,$.param({courseId:c._courseId,topicIds:a},!0)).done(function(a){0<a.deletedtopics.length&&($.each(a.deletedtopics,function(a,b){b.topicId&&0<b.topicId&&(e.Cards.TopicCard.getInstance(b.topicId).getTopicCardContainer().remove(),c.updateFilterAfterDeleting(b.topicId));b.folderId&&0<b.folderId&&e.PlannerUtility.deleteTopicFolderNode(b.folderId)}),
e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary(),c._planner.showNoTopicMessageIfNecessary(),c.showTopicFeedbackMessage(a.restoreText),c._planner.togglePlannerSharing())}).fail(CCL.CommonFunctions.alertAjaxError)},this._planner.terms.Delete,this._planner.terms.Cancel))};d.prototype.restoreTopics=function(a){$.post(this._planner.webMethods.Topic.RestoreTopics,$.param({courseId:this._courseId,topicIds:a},!0)).done(function(a){a&&(window.location.href=a)}).fail(CCL.CommonFunctions.alertAjaxError)};
d.prototype.moveUpTopic=function(a){if(a){var b=e.Cards.TopicCard.getInstance(a).getTopicCardContainer(),c=b.prev();if(c){var d=e.Cards.TopicCard.getInstanceByContainer(c).getTopicId();$.ajax({type:"POST",url:this._planner.webMethods.Topic.SwapTopics,data:{courseId:this._courseId,topicId1:a,topicId2:d},success:function(a){a&&(b.insertBefore(c),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};d.prototype.moveDownTopic=function(a){if(a){var b=e.Cards.TopicCard.getInstance(a).getTopicCardContainer(),
c=b.next();if(c){var d=e.Cards.TopicCard.getInstanceByContainer(c).getTopicId();$.ajax({type:"POST",url:this._planner.webMethods.Topic.SwapTopics,data:{courseId:this._courseId,topicId1:a,topicId2:d},success:function(a){a&&(b.insertAfter(c),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};d.prototype.updateFilterAfterDeleting=function(a){var b=this._planner.getPlannerFilter().find("optgroup[label='Topic']");b.find("option[value='t"+a+"']").remove();
0===b.find("option[value^='t']").length&&b.remove()};d.prototype.showTopicFeedbackMessage=function(a){this._planner.getPlannerFeedback().showMessage(CCL.FeedbackType.Information,a)};d.prototype.getDeleteTopicsConfirmationMessage=function(a){if(null==a||0===a.length)return"";var b=!1;e.Cards.TopicCard.getTopicCardsForTopicIds(a).forEach(function(a){a.hasConnectedFolder&&(b=!0)});a=1<a.length;var c="";return c=b?a?this._terms.DeleteTopicsConnectedToFolderConfirmText:this._terms.DeleteOneTopicConnectedToFolderConfirmText:
a?this._terms.DeleteTopicsConfirmText:this._terms.DeleteOneTopicConfirmText};return d}();e.TopicCommonLogic=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(b){var c=this;window[a.instanceName]=this;this.playPlanContentItemIdAttributeName=b;$("body").on("click",CCL.CommonFunctions.getDataSelector(this.playPlanContentItemIdAttributeName),function(a){a.preventDefault();if(a=$(a.currentTarget))if(a=a.data(c.playPlanContentItemIdAttributeName)){var b=a.split("_")[0];e.PlayPlanDialog.getClientInstance().open(b,a)}})}a.getInstance=function(){return window[a.instanceName]};a.instanceName="playPlanDialogOpenerClientInstanceName";
return a}();e.PlayPlanDialogOpener=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(b){var c=this;this.indexDialogWidth=500;this.itemIdDataAttributeName="itemId";this.onEscape=function(a){a.which===CCL.CommonConstants.keyCodes.escape&&(c.indexDialog.isOpened()?c.indexDialog.closeDialog():c.toggleDialog(!1))};this.closeTooltip=function(a){setTimeout(function(){c.toolTip.isTooltipOpened()&&c.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,d){setTimeout(function(){c.toolTip.isTooltipOpened()||(c.$tooltipContentLabel.html(b),
c.toolTip.openTooltip(a,c.tooltipPositionSettings))},d)};window[a.clientInstanceName]=this;this.settings=b;$(function(){c.$body=$("body");c.$bodyWrapper=$("."+c.settings.CssClasses.BodyWrapper);c.$dialog=$("#"+c.settings.Controls.Dialog);c.$topicColumnNameLabel=$("#"+c.settings.Controls.TopicColumnNameLabel);c.$planColumnNameLabel=$("#"+c.settings.Controls.PlanColumnNameLabel);c.$topicTitleLabel=$("#"+c.settings.Controls.TopicTitleLabel);c.$planTitleLabel=$("#"+c.settings.Controls.PlanTitleLabel);
c.$errorLabel=$("#"+c.settings.Controls.ErrorMessageLabel);c.$frame=$("#"+c.settings.Controls.Frame);c.$loadingIndicator=$("#"+c.settings.Controls.LoadingIndicator);c.$prevButtons=$("."+c.settings.CssClasses.PrevButton);c.$nextButtons=$("."+c.settings.CssClasses.NextButton);c.$indexButtons=$("."+c.settings.CssClasses.IndexButton);c.$indexCancelMobileButton=$("#"+c.settings.Controls.IndexMobileCancelButton);c.$closeButton=$("#"+c.settings.Controls.CloseButton);c.$tooltipContentLabel=$("#"+c.settings.Controls.TooltipContentLabel);
c.$indexDialogContainer=$("#"+c.settings.Controls.IndexContainer);c.focusTracker=new CCL.FocusTracker(c.$dialog);c.$prevButtons.click(function(){return c.goToPreviousItem()});c.$nextButtons.click(function(){return c.goToNextItem()});c.$indexButtons.click(function(){return c.openIndexDialog()});c.$indexCancelMobileButton.click(function(){return c.indexDialog.closeDialog()});c.$closeButton.click(function(){return c.toggleDialog(!1)});c.initTooltip();c.toggleToolTip(c.$indexButtons,c.settings.Terms.ShowAllResources,
!0);c.toggleToolTip(c.$closeButton,c.settings.Terms.CloseThisPlan,!0);c.indexDialog=new ContextDialog(c.$indexDialogContainer,{setFocus:!0,showHeader:!1,showCloseLink:!1,showArrow:!0,expandParentFrame:!1,closeOnEscape:!1,footerContent:c.settings.Controls.IndexMobileCancelContainer,width:c.indexDialogWidth,zIndex:5,marginTop:1,marginLeft:0,align:"right",valign:"bottom",arrowOffset:"manual",arrowLeft:c.indexDialogWidth-c.$indexButtons.outerWidth()/2})})}a.getClientInstance=function(){return window[a.clientInstanceName]};
a.prototype.open=function(a,c){this.playPlanItems=null;this.disableNavigationButtonsIfNeeds();this.clearContentFrame();this.toggleDialog(!0);this.loadPlanItems(a,c)};a.prototype.displayOnboardingIfNeeds=function(){var a=this;this.isNavigationButtonDisabled(this.$nextButtons)||$.get(this.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl).done(function(b){b.IsCompleted||(a.openTooltip(a.$nextButtons,a.settings.Terms.GoToNextResource,500),$.ajax({url:a.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl,
type:"PUT"}))})};a.prototype.adjustDialogPositionOnIosDevice=function(a){if(CCL.CommonFunctions.isIosDevice()){var b=$(window.top).height()-this.$closeButton.height();this.$bodyWrapper.css("overflow",a?"hidden":"");this.$bodyWrapper.height(a?""+b:"auto")}};a.prototype.toggleDialog=function(a){this.suspendUpdateBreadCrumbsAndNavigation(a);this.toggleEscapeHandler(a);this.adjustDialogPositionOnIosDevice(a);this.$body.css("overflow",a?"hidden":"");this.$dialog.toggle(a);a?(CCL.CommonFunctions.makePostMessageCall(window.top,
{messageName:CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame}),this.suspendExpandCollaplseContentAreaFrame(!0),this.$startLink=$(":focus"),this.$closeButton.focus(),this.focusTracker.startTrackFocus()):(this.clearContentFrame(),this.suspendExpandCollaplseContentAreaFrame(!1),CCL.CommonFunctions.makePostMessageCall(window.top,{messageName:CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame}),this.focusTracker.stopTrackFocus(),this.$startLink.focus());IframeResizer.reportSetIframeDefaultHeight()};
a.prototype.toggleEscapeHandler=function(a){if(a)this.$body.on("keyup",this.onEscape);else this.$body.off("keyup",this.onEscape)};a.prototype.clearContentFrame=function(){this.setFrameUrl("about:blank")};a.prototype.loadPlanItems=function(a,c){var b=this;this.loadPlanItemsInProgress||(this.loadPlanItemsInProgress=!0,this.toggleHeaderLoadingText(!0),this.$errorLabel.hide(),$.post(this.settings.WebMethods.LoadItems,{planId:a}).done(function(a){b.toggleHeaderLoadingText(!1);a&&(a.TopicColumnName&&b.$topicColumnNameLabel.text(a.TopicColumnName+
":"),a.PlanColumnName&&b.$planColumnNameLabel.text(a.PlanColumnName+":"),a.TopicTitle&&b.$topicTitleLabel.text(a.TopicTitle),a.PlanTitle&&b.$planTitleLabel.text(a.PlanTitle),b.$topicColumnNameLabel.toggle(a.UseTopics),b.$topicTitleLabel.toggle(a.UseTopics),b.$planColumnNameLabel.toggle(a.UseTopics),b.playPlanItems=a.Items,b.updateIndexDialogContainer(),b.currentPlanItemIndex=-1,(a=b.playPlanItems.filter(function(a){return a.ItemId===c})[0])?b.loadPlayPlanItem(a):b.navigateToPlayPlanItem(0),b.displayOnboardingIfNeeds())}).fail(function(a){a.status>=
CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=a.responseText&&0<a.responseText.length||null!=a.statusText&&0<a.statusText.length)?b.showErrorMessage(null!=a.responseText&&0<a.responseText.length?a.responseText:a.statusText):b.showUnableToShowPlanErrorMessage()}).always(function(){b.loadPlanItemsInProgress=!1}))};a.prototype.toggleHeaderLoadingText=function(a){a?(this.$topicColumnNameLabel.add(this.$planColumnNameLabel).add(this.$topicTitleLabel).text(""),this.$planTitleLabel.text(this.settings.Terms.Loading)):
this.$planTitleLabel.text("")};a.prototype.loadPlayPlanItem=function(a){a?(this.currentPlanItemIndex=this.playPlanItems.indexOf(a),this.disableNavigationButtonsIfNeeds(),this.markCurrentItemAsSelected(a),this.setFrameUrl(a.ContentUrl)):this.showUnableToShowPlanErrorMessage()};a.prototype.markCurrentItemAsSelected=function(a){this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem).removeClass(this.settings.CssClasses.IndexSelectedItem);a=CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,
a.ItemId);this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem+a).addClass(this.settings.CssClasses.IndexSelectedItem)};a.prototype.navigateToPlayPlanItem=function(a){this.currentPlanItemIndex!==a&&this.loadPlayPlanItem(this.playPlanItems[a])};a.prototype.goToPreviousItem=function(){this.isNavigationButtonDisabled(this.$prevButtons)||1<=this.currentPlanItemIndex&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex-1])};a.prototype.goToNextItem=function(){this.isNavigationButtonDisabled(this.$nextButtons)||
this.currentPlanItemIndex<this.playPlanItems.length-1&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex+1])};a.prototype.openIndexDialog=function(){if(!this.isNavigationButtonDisabled(this.$indexButtons)){var a=this.$indexButtons.offset().left+this.$indexButtons.outerWidth()-this.indexDialogWidth,c=this.$indexButtons.outerHeight();this.indexDialog.openDialogAt(a,c,!1);this.closeTooltip(0);if(a=this.playPlanItems[this.currentPlanItemIndex-1])a=this.$indexDialogContainer.find("."+
this.settings.CssClasses.IndexItem+CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,a.ItemId)),this.$indexDialogContainer.animate({scrollTop:a.offset().top})}};a.prototype.updateIndexDialogContainer=function(){var a=this;this.$indexDialogContainer.html("");var c=$('<ul class="'+this.settings.CssClasses.IndexList+'"></ul>');$.each(this.playPlanItems,function(b,d){a.renderItem(c,d,b)});c.appendTo(this.$indexDialogContainer)};a.prototype.renderItem=function(a,c,d){var b=this;$("<li data-"+
this.itemIdDataAttributeName+"="+c.ItemId+">").append('<a href="javascript:void(0);">\n                             <img alt="" src="'+c.IconUrl+'" class="'+this.settings.CssClasses.IndexItemIcon+'"/>\n                             <span class="'+this.settings.CssClasses.IndexItemTitle+'">'+c.ItemTitle+"</span>\n                        </a>").addClass(this.settings.CssClasses.IndexItem).appendTo(a).click(function(){b.indexDialog.closeDialog();b.navigateToPlayPlanItem(d)})};a.prototype.showUnableToShowPlanErrorMessage=
function(){this.showErrorMessage(this.settings.Terms.UnableToShowPlan)};a.prototype.showErrorMessage=function(a){this.$errorLabel.text(a);this.$errorLabel.show();this.$loadingIndicator.hide()};a.prototype.disableNavigationButtonsIfNeeds=function(){this.disableNavigationButton(this.$nextButtons,null==this.playPlanItems||this.currentPlanItemIndex===this.playPlanItems.length-1,this.settings.Terms.GoToNextResource);this.disableNavigationButton(this.$prevButtons,null==this.playPlanItems||0===this.currentPlanItemIndex,
this.settings.Terms.GoToPreviousResource);this.disableNavigationButton(this.$indexButtons,null==this.playPlanItems||1===this.playPlanItems.length,this.settings.Terms.ShowAllResources)};a.prototype.disableNavigationButton=function(a,c,d){var b=this.isNavigationButtonDisabled(a)!==c;a.toggleHyperlink(!c);b&&this.toggleToolTip(a,d,!c)};a.prototype.suspendUpdateBreadCrumbsAndNavigation=function(a){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendUpdateBreadCrumbsAndNavigation,
{suspend:a}))};a.prototype.suspendExpandCollaplseContentAreaFrame=function(a){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame,{suspend:a}))};a.prototype.setFrameUrl=function(a){a?(this.$frame.prop("src",a),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};a.prototype.isNavigationButtonDisabled=function(a){return!a.getIfHyperLinkEnabled()};
a.prototype.initTooltip=function(){this.tooltipPositionSettings={my:"right+23 top",at:"center bottom+10",arrow:"bottom"};this.$toolTipContainer=$("#"+this.settings.Controls.TooltipContainer);this.toolTip=new CCL.CustomToolTip("playPlanToolTip",{contentContainer:this.$toolTipContainer,zIndex:10},this.settings.CssClasses.CustomTooltipCssClasses);this.$toolTipContainer.show()};a.prototype.toggleToolTip=function(a,c,d){var b=this;if(!CCL.CommonFunctions.isMobileDevice())if(d)a.on("mouseover",function(){b.indexDialog.isOpened()||
b.openTooltip(a,c,0)}).on("mouseleave",function(){return b.closeTooltip(0)});else this.closeTooltip(0),a.off("mouseover mouseleave")};a.clientInstanceName="playPlanDialogClientInstanceName";return a}();e.PlayPlanDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){var d=function(){function a(a,c){window[a]=this;this.settings=c;this.$okButton=$("#"+this.settings.Controls.OkButton);this.$cancelButton=$("#"+this.settings.Controls.CancelButton)}a.prototype.open=function(a,c,d,e){null!=a&&(this.updateGridViewCallback=c,this.clearSelectionCallback=d,this.planIdList=a,this.toggleInProcess(!1),this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker],this.datePicker.clearData(),this.datePicker.setRecurringMode(this.planIdList),
this.datePicker.showCurrentMode(),null!=e&&f.Planner.Cards.TopicCard.setDefaultDate(this.datePicker,e),this.setPlanDatesModal=window[this.settings.ClientInstanceNames.SetPlanDatesModal],this.setPlanDatesModal.openDialog())};a.prototype.setPlanDates=function(){this.toggleInProcess(!0);this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker];if(null!=this.datePicker&&this.datePicker.validateDates())switch(this.datePicker.getCurrentMode()){case e.DatePickerMode.TimeSpan:this.updatePlansTimeSpan();
break;case e.DatePickerMode.WeekAndDay:this.updatePlansWeekAndDay();break;case e.DatePickerMode.Event:this.updatePlansEvents()}else this.toggleInProcess(!1)};a.prototype.toggleInProcess=function(a){this.$okButton.toggleClass(this.settings.CssClasses.InProgress,a);a?(this.$okButton.attr("disabled","disabled"),this.$cancelButton.attr("disabled","disabled")):(this.$okButton.removeAttr("disabled"),this.$cancelButton.removeAttr("disabled"))};a.prototype.updatePlansTimeSpan=function(){var a=this,c=this.datePicker.getWeekDays();
$.post(this.settings.WebMethods.SetPlansTimeSpan,$.param({courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartDate(),stop:this.datePicker.getStopDate(),weekNumber:this.datePicker.getWeekNumber(),weekDays:0===c.length?"":JSON.stringify(c),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed},!0),function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,
c,d);a.toggleInProcess(!1)})};a.prototype.updatePlansWeekAndDay=function(){var a=this,c=this.datePicker.getWeekDays();$.post(this.settings.WebMethods.SetPlansWeekAndDay,$.param({courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartWeek(),stop:this.datePicker.getStopWeek(),weekNumber:this.datePicker.getWeekNumber(),weekDays:0===c.length?"":JSON.stringify(c),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed},!0),function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);
a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,c,d);a.toggleInProcess(!1)})};a.prototype.updatePlansEvents=function(){var a=this.datePicker.getEvents(),c=this;$.ajax({type:"post",url:this.settings.WebMethods.SetPlansEvents,dataType:"json",data:$.param({courseId:this.settings.CourseId,planIds:this.planIdList,firstPlanEventIdsJson:JSON.stringify(a),filterStartDateTime:this.settings.FilterStartDateTime,filterStopDateTime:this.settings.FilterStopDateTime,
isDateColumnDisplayed:this.settings.IsDateColumnDisplayed},!0),success:function(a){c.updateGridViewCallback&&c.updateGridViewCallback(a);c.clearSelectionCallback&&c.clearSelectionCallback();c.closeDialog()},error:function(){c.datePicker.showErrorMsg(e.DatePickerMode.Event);c.toggleInProcess(!1)}})};a.prototype.closeDialog=function(){window.location.href=this.settings.DefaultTarget};return a}();k.SetPlanDatesDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){(function(f){var d=function(){function a(a,c){var b=this;window[a]=this;this.settings=c;$(function(){b.topicColorPicker=window[b.settings.ColorPickerClientInstanceName];b.planner=e.Planner.getInstance()})}a.prototype.setupAndOpenTopicColorPicker=function(a){a=e.Cards.TopicCard.getInstance(a);this.topicColorPicker.getSelectedColorKey()!==a.getColorSchema()&&(this.topicColorPicker.setPickerLink(a.getColorPickerLink()),this.topicColorPicker.setColor(a.getColorSchema()),this.topicColorPicker.openPopup())};
a.prototype.updateTopicColor=function(a,c){$.post(this.planner.webMethods.Topic.SetTopicColorSchema,{courseId:this.planner.settings.CourseId,topicId:a,topicColorSchema:c}).done(function(b){e.Cards.TopicCard.getInstance(a).setTopicColorSchema(c,b.topicColorSchemaCss)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};return a}();f.TopicColorPicker=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;this.addingPlanIsInProgress=!1;this.closeTooltip=function(a){setTimeout(function(){c.toolTip.isTooltipOpened()&&c.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,d){setTimeout(function(){c.$toolTipContent.html(b);c.toolTip.openTooltip(a,c.tooltipPositionSettings)},d)};window[a]=this;d.clientInstanceName=a;this.settings=b;this.courseId=this.settings.CourseId;this.kpi=this.settings.Kpi;this.$container=$("#"+this.settings.Controls.Container);
this.$addNewPlanLink=$("#"+this.settings.Controls.AddNewPlanLink);this.$addNewPlanLinkContainer=$("#"+this.settings.Controls.AddNewPlanLinkContainer);this.$newPlanToolTipContent=$("#"+this.settings.Controls.NewPlanToolTip);this.$toolTipContent=$("#"+this.settings.Controls.FieldsToolTip);this.initNewPlanToolTip();this.initFieldsToolTip();$(function(){c.datePeriodSelector=window[c.settings.Controls.DatePeriodSelector];$(c.datePeriodSelector).on(f.Controls.DatePeriodSelector.periodChangedEventName,function(a,
b){return c.loadPlans(b.startDate,b.endDate)});c.$container.on("click","."+c.settings.Css.SinglePlanEmptyOverlay,function(){return c.addPlan(!1)});c.$addNewPlanLink.on("click",function(){return c.addPlan(!0)});c.cbExpander=window[c.settings.Controls.Expander];CCL.CommonFunctions.attachPostMessageEventListener($(window),e.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){e.Cells.Plan.ResourcesCell.PlanCbResourcesCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,
a.customId,!0)})})}d.getInstance=function(){return window[d.clientInstanceName]};d.prototype.getContainer=function(){return this.$container};d.prototype.getFilterStartDate=function(){return this.datePeriodSelector.getStartDate()};d.prototype.getFilterStopDate=function(){return this.datePeriodSelector.getEndDate()};d.prototype.reloadPlans=function(){this.loadPlans(this.datePeriodSelector.getStartDate(),this.datePeriodSelector.getEndDate())};d.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};
d.prototype.changeDatePeriod=function(a){this.datePeriodSelector.changeDatePeriod(a)};d.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};d.prototype.updatePlansFolder=function(a,b){$("."+this.settings.Css.SinglePlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).attr("data-"+e.PlannerConstants.dataAttributes.FolderId,b)};d.prototype.loadPlans=function(a,b){var c=
this;this.datePeriodSelector.toggleNavigationButtons(!1);this.togglePlanTitleToolTip(this.$container,!1);this.$container.append($("<div>").addClass(this.settings.Css.LoadingIndicator));this.cbExpander.renderShowMoreLinkIfNeed(!1);$.getJSON(this.settings.WebMethods.LoadPlans,{courseId:this.settings.CourseId,start:a,stop:b}).done(function(a){c.$container.html(a.html);c.refreshCbExpander(!c.isSelectedWeekNotEmpty());c.renderAddNewPlanLinkIfNeeds();c.disableKeyboardNavigationIfWeekIsEmpty();c.toggleFieldsToolTip(!0)}).fail(function(a,
b,d){c.$container.empty();CCL.CommonFunctions.alertAjaxError(a,b,d)}).always(function(){c.datePeriodSelector.toggleNavigationButtons(!0)})};d.prototype.refreshCbExpander=function(a){this.cbExpander&&this.cbExpander.renderShowMoreLinkIfNeed(a);this.$container.removeClass(this.settings.Css.PlansContainerMinHeight)};d.prototype.addPlan=function(a){var b=this;this.addingPlanIsInProgress||(this.addingPlanIsInProgress=!0,this.toggleFieldsToolTip(!1),$.post(this.settings.WebMethods.AddPlan,{courseId:this.settings.CourseId,
start:this.datePeriodSelector.getStartDate(),stop:this.datePeriodSelector.getEndDate()}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)}).done(function(c){a?(b.$container.append(c),c=b.$container.find("."+b.settings.Css.SinglePlanContainer).last(),$("html, body",window.document).stop().animate({scrollTop:c.offset().top})):(b.$container.html(c),b.$container.find("."+b.settings.Css.PlanTitleCell).find("."+b.settings.Css.HtmlTextCellViewer).click(),b.togglePlanTitleToolTip(b.$container,
!0));b.refreshCbExpander(!0);b.renderAddNewPlanLinkIfNeeds()}).always(function(){b.addingPlanIsInProgress=!1}))};d.prototype.renderAddNewPlanLinkIfNeeds=function(){this.$addNewPlanLinkContainer.toggle(this.isSelectedWeekNotEmpty())};d.prototype.isSelectedWeekNotEmpty=function(){return 0<$("."+this.settings.Css.SinglePlanContainer).not("[data-"+e.PlannerConstants.dataAttributes.PlanId+"=0]").length};d.prototype.togglePlanTitleToolTip=function(a,b){a=a.find("."+this.settings.Css.PlanTitleCell).find("div"+
CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.HybridEditorItem));0<a.length&&this.showNewPlanToolTip(a,b)};d.prototype.initNewPlanToolTip=function(){this.newPlanToolTip=new CCL.CustomToolTip("newPlanToolTip",{contentContainer:this.$newPlanToolTipContent,zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.$newPlanToolTipContent.show()};d.prototype.initFieldsToolTip=function(){this.toolTip=new CCL.CustomToolTip("fieldsToolTip",{contentContainer:this.$toolTipContent,zIndex:1},
this.settings.Css.CustomTooltipCssClasses);this.tooltipPositionSettings={my:"center bottom",at:"center top-10",arrow:"top"};this.$toolTipContent.show()};d.prototype.disableKeyboardNavigationIfWeekIsEmpty=function(){var a=$("."+this.settings.Css.SinglePlanEmptyOverlay);0<a.length&&(this.$container.find("*").prop("tabindex","-1"),a.attr("tabindex","0"))};d.prototype.showNewPlanToolTip=function(a,b){var c=this,d,f,l=function(b){clearTimeout(f);clearTimeout(d);f=setTimeout(function(){c.newPlanToolTip.isTooltipOpened()&&
(c.newPlanToolTip.closeTooltip(),a.off(e.PlannerConstants.events.HybridEditorItemInlineModeChanged),c.toggleFieldsToolTip(!0))},b)},m=function(b){clearTimeout(f);clearTimeout(d);d=setTimeout(function(){c.newPlanToolTip.isTooltipOpened()||(c.newPlanToolTip.openTooltip(a,{my:"center top",at:"center bottom+10",arrow:"bottom"}),a.on(e.PlannerConstants.events.HybridEditorItemInlineModeChanged,function(a,b){b.isEditMode||l(300)}))},b)};b?m(300):l(0)};d.prototype.toggleTooltipForField=function(a,b,c){var d=
this;void 0===c&&(c="");if(!CCL.CommonFunctions.isMobileDevice())if(b)a.on("mouseover",function(b){return d.openTooltip(a,c,0)}).on("mouseleave",function(){return d.closeTooltip(0)});else this.closeTooltip(0),a.off("mouseover mouseleave")};d.prototype.toggleFieldsToolTip=function(a){var b=this;if(!CCL.CommonFunctions.isMobileDevice()){var c=this.$container.find("."+this.settings.Css.PlanTitleCell);c.each(function(a){return b.toggleTooltipForField($(c[a]),!0,b.settings.Terms.PlanTitleCellTooltip)});
var d=this.$container.find("."+this.settings.Css.PlanTopicCell);d.each(function(a){return b.toggleTooltipForField($(d[a]),!0,b.settings.Terms.PlanTopicCellTooltip)});var e=this.$container.find("."+this.settings.Css.PlanDateCell);e.each(function(a){return b.toggleTooltipForField($(e[a]),!0,b.settings.Terms.PlanDateCellTooltip)});var f=this.$container.find("."+this.settings.Css.PlanEmptyThumbnailCell).closest("."+this.settings.Css.PlanThumbnailCell);f.each(function(a){return b.toggleTooltipForField($(f[a]),
!0,b.settings.Terms.PlanThumbnailCellTooltip)})}};return d}();e.CbPlanner=k})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){window[d.clientInstanceName]=this;this.settings=a}d.getInstance=function(){return window[d.clientInstanceName]};d.prototype.updateLearningObjectiveDataSource=function(a){return this.updateLearningObjectivesDataSource([a])};d.prototype.updateLearningObjectivesDataSource=function(a){var b=this;return $.post(this.settings.GetLearningObjectivesTooltipDataWebMethod,$.param({learningObjectiveIds:a},!0),function(a){$.each(a,function(a,c){window[b.settings.TooltipDataSourceMethods.AddToDataSource](a,
c.title,c.description)})}).fail(CCL.CommonFunctions.alertAjaxError)};d.clientInstanceName="PlannerLearningObjectiveToolTipManagerClientInstanceName";return d}();e.PlannerLearningObjectiveToolTipManager=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;d.dataAttributes=b.DataAttributes;d.events=b.Events;d.postMessages=b.PostMessages}return d}();e.PlannerConstants=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){window[a]=this;d.instanceName=a;this._planner=e.Planner.getInstance()}d.getInstance=function(){return window[d.instanceName]};d.prototype.printTopics=function(){var a=this,b=e.Cards.TopicCard.getSelectedTopicIds(!0);null!=b&&(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),b.forEach(function(b){a.prepareTopicForPrint(b)}),window.print())};d.prototype.printPlans=function(a){(a=a.getTopicId())?(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),
this.prepareTopicForPrint(a)):this._planner.settings.UseTopics?(e.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),e.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint();window.print()};d.prototype.prepareAllPlansForPrint=function(){var a=this;e.Cards.TopicCard.getAllTopicCardContainers().each(function(b,c){c=e.Cards.TopicCard.getInstanceByContainer($(c)).getPlanGrid();b=c.getSelectedRows();c=c.getRows();0<
b.length?(c.addClass(a._planner.css.NoPrint),b.removeClass(a._planner.css.NoPrint)):c.removeClass(a._planner.css.NoPrint)})};d.prototype.prepareTopicForPrint=function(a){var b=e.Cards.TopicCard.getInstance(a);a=b.getTopicCardContainer();var c=b.getPlanGrid();b=c.getRows();c=c.getSelectedRows();a.removeClass(this._planner.css.NoPrint);0<c.length?(b.addClass(this._planner.css.NoPrint),c.removeClass(this._planner.css.NoPrint)):b.removeClass(this._planner.css.NoPrint)};d.prototype.printPlanner=function(a){null==
a?this._planner.settings.UseTopics?(e.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),e.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint():(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),this.prepareTopicForPrint(a));window.print()};return d}();e.PlannerPrint=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f;(function(a){a[a.NotLoaded=0]="NotLoaded";a[a.Loading=1]="Loading";a[a.Loaded=2]="Loaded"})(f||(f={}));var d=function(){return function(a,b,c){function d(a){var b=-a.width()/2;a=a.height();m.openDialogAt(b,a,!0);$(window.top).trigger($.Event("QuickAddMenuShow"))}var e=f.NotLoaded,l=$("<div class='ccl-context-dialog-content-container'></div>").hide();a.parent().append(l);var m=new ContextDialog(l,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,valign:"bottom",
marginTop:12,marginBottom:0,marginLeft:0,marginRight:10,cssClass:c,toggleElement:a}),k=m.closeDialog;m.setCloseFunction(function(a){k(a);$(window.top).trigger($.Event("QuickAddMenuHide"))});window.addEventListener("orientationchange",function(a){return m.closeDialog(a)});l.click(function(){return m.closeDialog()});a.click(function(a){m.isOpened()?m.closeDialog():e===f.Loaded?d($(a.currentTarget)):e===f.NotLoaded&&(e=f.Loading,$.get(b,function(b){b&&(l.append(b),d($(a.currentTarget)));e=f.Loaded}).fail(function(){return e=
f.NotLoaded}))})}}();e.QuickAddMenu=d})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){(function(d){var a=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.courseId=b.CourseId;$(function(){$("body").on("keyup","."+c.settings.Css.ImageUploaderContainer,function(a){var b=$(a.target);a.which===CCL.CommonConstants.keyCodes.enter&&b.getIfHyperLinkEnabled()&&b.find("input").click();a.preventDefault()}).on("change","."+c.settings.Css.ImageUploaderContainer,function(a){return c.uploadImage(a)}).on("click","."+c.settings.Css.DeleteButton,
function(a){return c.deleteImage(a)})})}a.prototype.uploadImage=function(a){var b=this,c=$(a.target),d=c.closest("."+this.settings.Css.CellContainer);this.hideImageLoadingError(d);a=a.target;c=parseInt(c.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId),10);a=f.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a);var m=a.formData;if(m)if(a.fileSizes[0]>this.settings.MaxImageSizeInBytes)this.showImageLoadingError(d,this.settings.Terms.MaximumFileSizeForUpload);
else{m.append(this.settings.RequestItems.CourseId,this.settings.CourseId);m.append(this.settings.RequestItems.PlanId,c);var k=this.showLoading(d);e.CbPlanner.getInstance()&&e.CbPlanner.getInstance().toggleTooltipForField(d,!1);$.ajax({type:"POST",url:this.settings.WebMethods.UploadImage,contentType:!1,processData:!1,dataType:"json",data:m}).done(function(a){a.success?d.replaceWith(a.content):(b.toggleAddImage(d,!0),b.showImageLoadingError(d,a.errorMessage))}).fail(function(){CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,
b.settings.Terms.ErrorMessage,b.settings.Terms.Ok,!1)}).always(function(){return b.hideLoading(d,k)})}};a.prototype.deleteImage=function(a){var b=this;a=$(a.target);var c=a.closest("."+this.settings.Css.CellContainer);a=parseInt(a.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId),10);$.get(this.settings.WebMethods.DeletePlanThumbnail,$.param({courseId:this.settings.CourseId,planId:a})).done(function(a){var d=c.parent();c.replaceWith(a);e.CbPlanner.getInstance()&&
e.CbPlanner.getInstance().toggleTooltipForField(d.find("."+b.settings.Css.CellContainer),!0,b.settings.Terms.AddImageTooltip)})};a.prototype.showLoading=function(a){var b=a.css("position");a.css("position","relative").append($('<div class="'+this.settings.Css.AjaxLoader+'"></div>'));this.toggleAddImage(a,!1);return b};a.prototype.hideLoading=function(a,b){a.css("position",b);a.find("."+this.settings.Css.AjaxLoader).replaceWith("")};a.prototype.showImageLoadingError=function(a,b){b=$('<div class="'+
this.settings.Css.ImageErrorMessage+'">'+b+"</div>");a.append(b)};a.prototype.hideImageLoadingError=function(a){a.find("."+this.settings.Css.ImageErrorMessage).replaceWith("")};a.prototype.toggleAddImage=function(a,b){a.find("."+this.settings.Css.AddImage).toggle(b)};return a}();d.PlanThumbnailCell=a})(k.Plan||(k.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){function d(a){var b=window.top;return window!=b?$("#item"+a,b.document):null}e.deleteTopicFolderNode=function(a){a&&(a=d(a))&&a.remove()};e.updateTopicFolderNode=function(a,b){a&&(a=d(a))&&(b=document.createTextNode(b),a.children("a:first").contents().filter(function(){return 3===this.nodeType}).replaceWith(b))}})(e.PlannerUtility||(e.PlannerUtility={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.topicsAutocomplete=function(a,b){c.topicsAutocompleteRequest&&c.topicsAutocompleteRequest.abort&&c.topicsAutocompleteRequest.abort();c.topicsAutocompleteRequest=$.getJSON(c.settings.WebMethods.FindTopics,{courseId:c.courseId,searchText:a.term}).done(function(a){a.length?b($.map(a,function(a){return{label:a.Name,value:a.TopicId,metadata:a}})):b([{label:"",value:""}])}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,
b,c)}).always(function(){c.topicsAutocompleteRequest=void 0})};this.onTopicSelect=function(a,b){c.selectedTopic=b.item.metadata;c.$textInput.val(c.selectedTopic.Name);c.$textInput[0].blur();return!1};window[a]=this;this.courseId=b.CourseId;this.$textInput=$("#"+b.InputClientId);this.settings=b;var d=this;this.$textInput.autocomplete({focus:function(a){a.preventDefault()},position:{collision:"none flip",of:this.$textInput},source:this.topicsAutocomplete,select:this.onTopicSelect,delay:this.settings.Autocomplete.Delay,
minLength:this.settings.Autocomplete.MinLength,create:function(){$(this).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append(b.metadata?String.format("<span>{0}</span>",CCL.CommonFunctions.htmlEncode(b.metadata.Name)):String.format("<span class='{0}'>{1}</span>",d.settings.Css.NoMatches,d.settings.Terms.NoMatches)).appendTo(a)};$(this).data("ui-autocomplete")._renderMenu=function(a,b){var c=this;$.each(b,function(b,d){c._renderItemData(a,d)});a.hasClass(d.settings.Css.AutocompleteMenu)||
a.addClass(d.settings.Css.AutocompleteMenu)}}});$(function(){b.CurrentTopic&&(c.currentTopic=b.CurrentTopic,c.$textInput.val(c.currentTopic.Name));c.$textInput.blur(function(){return c.onTopicChangeHandler()});c.$textInput.keydown(function(a){return c.keyDown(a)});c.cbPlanner=e.CbPlanner.getInstance()})}d.prototype.getPlanId=function(){var a=this.$textInput.closest("."+this.settings.Css.OnePlanContainer);return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId),10)};d.prototype.getCurrentTopicId=
function(){return this.currentTopic?this.currentTopic.TopicId:0};d.prototype.getSelectedTopicId=function(){return this.selectedTopic?this.selectedTopic.TopicId:0};d.prototype.checkIfNeedsToUpdateTopic=function(){var a=!0,b=this.$textInput.val().trim();this.currentTopic||this.selectedTopic||""!==b||(a=!1);if(this.getCurrentTopicId()===this.getSelectedTopicId()&&0<this.getCurrentTopicId()||this.currentTopic.Name===b)a=!1;return a};d.prototype.onTopicChangeHandler=function(){var a=this;if(this.checkIfNeedsToUpdateTopic()){var b=
this.getPlanId();$.post(this.settings.WebMethods.ConnectPlanToTopic,{courseId:this.courseId,topicId:this.getSelectedTopicId(),planId:b,topicName:this.$textInput.val()}).done(function(c){if(c){var d=c.topicInfo;a.currentTopic&&a.currentTopic.TopicId===d.TopicId||a.$textInput.attr("data-"+a.settings.TopicIdDataAttribute,d.TopicId);a.currentTopic=d;a.selectedTopic=null;a.$textInput.val(a.currentTopic.Name);c.isCurrentTopicRenamed&&(a.updateTopicName(a.currentTopic.TopicId,a.currentTopic.Name),e.PlannerUtility.updateTopicFolderNode(c.topicConnectedFolderId,
d.Name));a.cbPlanner.updatePlansFolder(b,c.topicConnectedFolderId)}}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})}};d.prototype.keyDown=function(a){a.which===CCL.CommonConstants.keyCodes.enter&&(a.preventDefault(),this.$textInput[0].blur());a.which===CCL.CommonConstants.keyCodes.escape&&(a.preventDefault(),this.selectedTopic=null,this.currentTopic&&this.$textInput.val(this.currentTopic.Name))};d.prototype.updateTopicName=function(a,b){a=$("."+this.settings.Css.PlansContainer).find("."+
this.settings.Css.TopicNameInput+CCL.CommonFunctions.getDataSelector(this.settings.TopicIdDataAttribute,a));$.each(a,function(a,d){$(d).val(b)})};return d}();e.TopicSelector=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a,b){var c=this;this.sortDirection="DESC";this.refreshGrid=function(a,b){$.post(c.context.WebMethods.LearnerLetters,{PersonId:c.context.PersonId,PageIndex:a-1,PageSize:b,SortDirection:c.sortDirection,SortColumn:c.sortColumn}).done(function(a){null!=a&&(c.letters(a),c.updateScrollBarYHandler())})};this.pagerEventHandler=function(a){a===c.context.Pager.Name&&(a=window[a],c.refreshGrid(a.pageNumber,a.pageSize))};this.changeSortColumn=function(a){c.sortColumn===
a?c.sortDirection="DESC"===c.sortDirection?"ASC":"DESC":c.sortColumn=a;a=window[c.context.Pager.Name];c.refreshGrid(a.pageNumber,a.pageSize)};this.getCourseTitle=function(a){return a?a:c.context.LanguageTerms.All};this.openLetterLink=function(a){window.open(a,"_blank")};this.openProfile=function(a,b){a===c.context.PersonId?$("li[data-tab='about']").find("a").trigger("click"):document.showProfileCard?document.showProfileCard(a):window.raw_popup(b,"","resizable,scrollbars,height=500,width=750")};this.updateScrollBarYHandler=
function(){c.lettersTabPage.perfectScrollbar("update");return!0};this.context=d;this.letters=ko.observableArray(a);this.sortColumn=d.Sort.CreatedDateColumnSortName;this.lettersTabPage=b;$(document).off(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName);$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return c.pagerEventHandler(b)});document.profileCardScope.isWindowLoading=
!1;$(".c-modal__mask").on("click",document.profileCardScope.closeProfileCardWindow);b.perfectScrollbar({suppressScrollX:!0});this.updateScrollBarYHandler();$(window).on("resize",this.updateScrollBarYHandler);d=$(".c-profileCard[data-personid='"+d.PersonId+"']");ko.utils.domNodeDisposal.addDisposeCallback(d[0],function(){$(window).off("resize",this.updateScrollBarYHandler)})}}();e.ProfileLetters=f})(f.ProfileCard||(f.ProfileCard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function a(a){var b=this;d.call(this,a.Urls.CheckSession,a.Resources.AnErrorOccurred);this.settings=a;this.toggleLightBulletinSubscriptionForPerson=function(a,c){return $.ajax({type:"PUT",url:b.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,subscribe:c}})};this.getStreamList=function(a,c){return $.ajax({type:"GET",url:b.settings.Urls.GetStreamList,data:{boundaryNotificationActiveFromTicks:a,boundaryNotificationId:c}})}}__extends(a,
d);return a}(f.CommonAjaxClient);e.StreamAjaxClient=k})(f.Stream||(f.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;this.controls=a;this.settings=b;this.numberOfRepeatsOfCheckingLastItemForIos=12;this.intervalBeforeCheckForLoading=250;this.minVisiblePartOfLastItemToLoadMore=.5;this.afterAddingComment=function(a){a=a.userData.sourceId;var b=c.getBulletinById(a);c.lightBulletinSingleItemDataManager.subscribeToCommentsIfNeeded(b,a)};this.lightBulletinMenuClicked=function(a){var b=c.lightBulletinSingleItemDataManager.getLightBulletinActionDropDownItem(a),
d=c.getBulletinById(b.LightBulletinId);if(b.ActionType===f.LightBulletin.LightBulletinDropDownMenuActionType.ToggleSubscription){var e=c.lightBulletinSingleItemDataManager.getSingleItemData(d).SubscriptionStatus!==f.LightBulletin.PersonSubscriptionStatus.Subscribed;c.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,e).done(function(){return c.lightBulletinSingleItemDataManager.updateSubscriptionStatus(d,a,e)}).fail(c.ajaxClient.handleAjaxError)}};this.resetLastItem=function(){c.lastItem.removeAttr("data-"+
c.settings.DataAttributes.BoundaryNotificationActiveFromTicks).removeAttr("data-"+c.settings.DataAttributes.BoundaryNotificationId);c.lastItem=$()};this.getCurrentLastItem=function(){return c.controls.ItemsContainer.find("[data-"+c.settings.DataAttributes.BoundaryNotificationActiveFromTicks+"]")};this.isAllItemsLoaded=function(){return 0===c.lastItem.length};this.lightBulletinContentNodeSelector="[data-"+this.settings.DataAttributes.LightBulletinId+"]";e.StreamContentBlockInstance=this;this.lastItem=
this.getCurrentLastItem();this.isFirstCallLazy=!0;this.oembedError=new f.LightBulletin.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkifyTextNodes(this.controls.ItemsContainer);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.lightBulletinShowMoreLinkRenderer=new f.LightBulletin.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,this.textExpander);
this.lightBulletinEmbedAsynchronousLoader=new f.LightBulletin.EmbedAsynchronousLoader({isIosDevice:this.isIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+this.settings.CssClasses.OembedBox,bulletinItem:this.lightBulletinContentNodeSelector},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.lightBulletinSingleItemDataManager=
new f.LightBulletin.LightBulletinSingleItemDataManager(this.settings.LightBulletinSingleDataDataAttributes,this.settings.LightBulletinSingleItemDataResources);this.ajaxClient=new e.StreamAjaxClient(this.settings);this.listenToEmbedPostmessages();this.isAllItemsLoaded()||(this.isMobile()||this.loadIfReachedLastItem(!1,0),$(window).on(this.isIosDevice?"touchmove":"scroll",function(){c.isMobile()||c.loadIfReachedLastItem(!1,c.isIosDevice?c.numberOfRepeatsOfCheckingLastItemForIos:0)}),this.controls.ShowMoreLink.click(function(a){c.controls.ShowMoreLink.hide();
c.loadIfReachedLastItem(!0,0);a.preventDefault()}));f.LightBulletin.EmbedResizer.listenToEmbedSizePostmessages(this.controls.ItemsContainer,this.settings.CssClasses.OembedContent,this.lightBulletinShowMoreLinkRenderer,this.lightBulletinEmbedAsynchronousLoader);this.renderShowMoreInLightBulletins(this.controls.ItemsContainer.find(this.lightBulletinContentNodeSelector));this.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(this.controls.ItemsContainer);this.lightBulletinEmbedAsynchronousLoader.loadEmbedContentAsync();
this.lightBulletinSingleItemDataManager.registerDropDownMenuClickHandler(this.isIosDevice,this.lightBulletinMenuClicked)}d.prototype.loadIfReachedLastItem=function(a,b){var c=this;if(this.isAllItemsLoaded()||!a&&!CCL.CommonFunctions.isOnScreen(this.lastItem,this.minVisiblePartOfLastItemToLoadMore,this.minVisiblePartOfLastItemToLoadMore,this.isIosDevice?window.parent:window))0<b&&setTimeout(function(){c.loadIfReachedLastItem(a,b-1)},this.intervalBeforeCheckForLoading);else{var d=this.lastItem.attr("data-"+
this.settings.DataAttributes.BoundaryNotificationActiveFromTicks),e=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationId);this.resetLastItem();this.ajaxClient.getStreamList(d,e).done(function(a){a&&(a=$(a),c.controls.ItemsContainer.append(a),c.linkifyTextNodes(a),c.renderShowMoreInLightBulletins(c.controls.ItemsContainer.find(c.lightBulletinContentNodeSelector)),c.isFirstCallLazy&&($.ajax(c.settings.Urls.MeasureLazyLoading),c.isFirstCallLazy=!1),c.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(a));
c.lastItem=c.getCurrentLastItem();c.isAllItemsLoaded()||c.controls.ShowMoreLink.show()}).fail(CCL.CommonFunctions.alertAjaxError)}};d.prototype.renderShowMoreInLightBulletins=function(a){this.lightBulletinShowMoreLinkRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.AttachedImage+"]",this.lightBulletinContentNodeSelector)};d.prototype.linkifyTextNodes=function(a){f.LightBulletin.LightBulletinLinkifyWrapper.linkifyNodes(a.find("[data-"+this.settings.DataAttributes.LightBulletinContent+
"]"))};d.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,!1)};d.prototype.getBulletinById=function(a){return this.controls.ItemsContainer.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LightBulletinId,a))};d.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var c=a.controls.ItemsContainer.find("#"+
b.oembedPlaceHolderId);a.lightBulletinEmbedAsynchronousLoader.removeAjaxLoader(c);a.controls.ItemsContainer.removeClass(a.settings.CssClasses.AjaxLoader);b.isPlainLink&&!a.oembedError.hasOembedError(c)&&(c.append(a.oembedError.generateOembedError({originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:c},a.lightBulletinEmbedAsynchronousLoader)),a.lightBulletinShowMoreLinkRenderer.renderShowMoreLink(c.closest(a.lightBulletinContentNodeSelector),!1))})};return d}();e.StreamContentBlock=k})(f.Stream||
(f.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this._templates={};window[a]=this;d.instanceName=a;this._settings=b;this.css=b.Css;this.webMethods=b.WebMethods;a=$("#"+this._settings.Controls.PlanTemplateId).html();var e=$("#"+this._settings.Controls.TopicTemplateId).html();this._templates[this._settings.Controls.PlanTemplateId]=Handlebars.compile(a);this._templates[this._settings.Controls.TopicTemplateId]=Handlebars.compile(e);this._container=$("."+b.Css.Container);setTimeout(function(){c.initTimeline()},
100);this._planContextDialog=new ContextDialog("#"+this._settings.Controls.PlanContextDialogId,{valign:"bottom",width:500,zIndex:2,closeLinkTooltip:b.Terms.Close})}d.getInstance=function(){return window[d.instanceName]};d.prototype.getContainer=function(){return this._container};d.prototype.isEmpty=function(){return this._settings.UseTopics?0===this._topics.length:0===this._plans.length};d.prototype.refresh=function(){return this._settings.UseTopics?this.loadTopics():this.loadTopicPlans()};d.prototype.toggleTimeline=
function(a,b){var c=this;this.getContainer().hide();a?($("#"+this._settings.Controls.LoadingLabelId).show(),this.refresh().done(function(){return c.showEmptyMessageIfNecessary()})):b&&this.toggleEmptyMessage(!1);$("#"+this._settings.Controls.LoadingLabelId).hide()};d.prototype.showEmptyMessageIfNecessary=function(){this.toggleEmptyMessage(this.isPlannerTimelineEmpty());this.getContainer().toggle(!this.isPlannerTimelineEmpty())};d.prototype.toggleEmptyMessage=function(a){var b=this._container.parent().find("."+
this._settings.Css.NoTopicsMessage);b&&b.toggle(a)};d.prototype.isPlannerTimelineEmpty=function(){return this._settings.UseTopics&&0===this._topics.length||!this._settings.UseTopics&&0===this._plans.length};d.prototype.initTimeline=function(){var a=this;this._timeline=new vis.Timeline(this._container[0],null,{margin:{item:{vertical:25,horizontal:5E3}},selectable:!1,locale:this._settings.Language,order:function(b,c){return a.orderTimelineItems(b,c)},template:function(b){return(0,a._templates[b.template])(b)},
zoomMin:432E6,zoomMax:321408E5,maxHeight:500});this._timeline.on("click",function(b){a._planContextDialog.isOpened()&&a._planContextDialog.closeDialog();a.expandCollapseTimelineItem(b)});$(document).trigger(this._settings.Events.TimelineControlInitialized)};d.prototype.expandCollapseTimelineItem=function(a){if(null!=a.item&&!$(a.event.target).hasClass(this.css.ItemTitle)){var b=a.item.split("#");if(1===b.length){var c=this.getTopicItem(a.item);b=this._timeline.itemSet.itemFromTarget(a.event).dom.box;
$(b).toggleClass(this.css.TopicArrowCollapsed,null!=c.Plans);$(b).toggleClass(this.css.TopicArrowExpanded,null==c.Plans);$(b).attr("title",this._settings.Terms.HidePlans);null!=c.Plans?(this.removeItemsFromTopicTimeline(c),$(b).attr("title",this._settings.Terms.ShowPlans)):this.loadTopicPlans(a.item)}else c=b[1],(b=this.getPlanItem(a.item,b[0]))&&this.openDialogAndLoadPlanContents(c,b.Content,a)}};d.prototype.openDialogAndLoadPlanContents=function(a,b,c){var d=this;this._planContextDialog.setTitle(b);
this._planContextDialog.openDialog(c.event.srcEvent);this._planContextDialog.setContent(this._settings.Terms.Loading);$.post(this._settings.WebMethods.GetSinglePlanForPlannerXhtml,{planId:a,courseId:this._settings.CourseId,childId:this._settings.ChildId,dashboardHierarchyId:this._settings.DashboardHierarchyId},function(a){d._planContextDialog.setContent(a)})};d.prototype.refreshTimeline=function(){var a=this,b=[],c=[];this._settings.UseTopics?$.each(this._topics,function(d,e){b.push(a.getTimelineItem(e,
!1,e.Id,e.ColorSchemaClass));c.push({id:e.Id,content:"",order:e.Order});null!=e.Plans&&$.each(e.Plans,function(c,d){b.push(a.getTimelineItem(d,!0,e.Id,d.Active?e.ColorSchemaClass:a._settings.Css.InactivePlan))})}):$.each(this._plans,function(d,e){b.push(a.getTimelineItem(e,!0,e.Id,e.Active?a._settings.Css.DefaultColorSchemaClass:a._settings.Css.InactivePlan));c.push({id:e.Id,content:"",order:e.Order})});0<b.length&&this._timeline.setData({groups:c,items:b})};d.prototype.setViewOptions=function(a,
b,c,d){this._timeline.setOptions({start:a,end:b,min:c,max:d})};d.prototype.addItemsToTopicTimeline=function(a){var b=this;$.each(a.Plans,function(c,d){b._timeline.itemsData.add(b.getTimelineItem(d,!0,a.Id,d.Active?a.ColorSchemaClass:b._settings.Css.InactivePlan))})};d.prototype.removeItemsFromTopicTimeline=function(a){if(null!=a.Plans){var b=[];$.each(a.Plans,function(a,d){b.push(d.Id)});this._timeline.itemsData.remove(b);a.Plans=null}};d.prototype.loadTopics=function(){var a=this;return $.ajax({type:"POST",
url:this._settings.WebMethods.GetTopicsForPlannerTimeline,data:{courseId:this._settings.CourseId,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId,topicId:this._settings.FilteredTopicId,termId:this._settings.FilteredTermId},success:function(b){b&&b.topics&&(a.setViewOptions(b.initialStart,b.initialEnd,b.minStart,b.maxEnd),a._topics=b.topics,a.refreshTimeline())},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.loadTopicPlans=function(a){var b=
this;void 0===a&&(a="");return $.ajax({type:"POST",url:this._settings.WebMethods.GetPlansForPlannerTimeline,data:{courseId:this._settings.CourseId,topicIdString:a,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId},success:function(c){if(c&&c.plans)if(b._settings.UseTopics){var d=b.getTopicItem(a);d.Plans=c.plans;b.addItemsToTopicTimeline(d);c.topicStartDate&&c.topicStopDate&&(d.Start=c.topicStartDate,d.End=c.topicStopDate,b._timeline.itemsData.update(b.getTimelineItem(d,
!1,d.Id,d.ColorSchemaClass)))}else b.setViewOptions(c.initialStart,c.initialEnd,c.minStart,c.maxEnd),b._plans=c.plans,b.refreshTimeline()},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.getTopicItem=function(a){return this.getItem(this._topics,a)};d.prototype.getPlanItem=function(a,b){void 0===b&&(b=null);b=null!=b&&this._settings.UseTopics?this.getTopicItem(b).Plans:this._plans;return this.getItem(b,a)};d.prototype.getItem=function(a,b){var c=null;$.each(a,function(a,d){return d.Id===b?
(c=d,!1):!0});return c};d.prototype.getTimelineItem=function(a,b,c,d){var e=this.isTopicExpanded(a,b)?this._settings.Css.TopicArrowExpanded:this._settings.Css.TopicArrowCollapsed;return{id:a.Id,content:a.Content,start:a.Start,end:a.End,className:b?d+" "+this._settings.Css.Plan:d+" "+e,group:c,subgroup:b?a.Order:0,template:b?this._settings.Controls.PlanTemplateId:this._settings.Controls.TopicTemplateId,custom:b?a.ElementsCount:null,active:a.Active,title:b?this._settings.Terms.OpenPlanDetails:this.isTopicExpanded(a,
b)?this._settings.Terms.HidePlans:this._settings.Terms.ShowPlans}};d.prototype.isTopicExpanded=function(a,b){return!b&&null!=a.Plans};d.prototype.orderTimelineItems=function(a,b){return b.subgroup-a.subgroup};d.prototype.parseDateFromString=function(a){return null!=a?$.datepicker.parseDate(this._settings.DateTimeFormat,a):null};return d}();e.PlannerTimeline=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){this.dataAttributes=a;this.resources=b}d.prototype.getLightBulletinActionDropDownItem=function(a){return a.data(this.dataAttributes.LightBulletinActionDropDownItem)};d.prototype.getSingleItemData=function(a){return a.data(this.dataAttributes.LightBulletinSingleItemData)};d.prototype.updateSingleItemData=function(a,b){a.data(this.dataAttributes.LightBulletinSingleItemData,b)};d.prototype.refreshSingleItemData=function(a,b){var c=this.getSingleItemData(a);
b(c);this.updateSingleItemData(a,c);return c};d.prototype.getToggleSubscriptionLink=function(a){return $(CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItemToggleSubscriptionLink,a))};d.prototype.updateSubscriptionStatus=function(a,b,c){this.refreshSingleItemData(a,function(a){return a.SubscriptionStatus=c?e.PersonSubscriptionStatus.Subscribed:e.PersonSubscriptionStatus.UnsubscribedManually});b.text(c?this.resources.TurnOffNotifications:this.resources.TurnOnNotifications)};
d.prototype.registerDropDownMenuClickHandler=function(a,b){$(document).on(a?"touchstart":"click",CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItem),function(a){a.preventDefault();b($(a.currentTarget))})};d.prototype.subscribeToCommentsIfNeeded=function(a,b){this.getSingleItemData(a).SubscriptionStatus===e.PersonSubscriptionStatus.WasNotSubscribed&&this.updateSubscriptionStatus(a,this.getToggleSubscriptionLink(b),!0)};return d}();e.LightBulletinSingleItemDataManager=
f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b,c,d){var e=this;this.$itemSelector=a;this.idDataAttribute=b;this.selectAllItemId=c;this.languageTerms=d;this.hasItems=function(){return 0<e.getAllItems().length};this.getItemId=function(a){a=e.getItemIdByDataAttribute(e.getItem(a));return e.areAllItemsSelected(a)?null:a};this.setDefaultItemText=function(a){a=e.getItem(a);var b=e.getItemIdByDataAttribute(a);a=e.areAllItemsSelected(b)?e.languageTerms.All+" "+e.languageTerms.Items.toLowerCase():
a.text();e.$itemSelector.text(a)};this.getAllItems=function(){return e.$itemSelector.parent().find("[data-"+e.idDataAttribute+"]")};this.isItem=function(a){return null!=a.closest("[data-"+e.idDataAttribute+"]")};this.getItem=function(a){return a.closest("[data-"+e.idDataAttribute+"]")};this.getItemIdByDataAttribute=function(a){return a.data(e.idDataAttribute)};this.areAllItemsSelected=function(a){return a===e.selectAllItemId}}}(),d=function(){function a(b,c,d){var e=this;this.settings=c;this.controls=
d;this.initPerfectScrollbar=function(){e.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});$(window).on("resize",e.updateScrollBarYHandler)};this.updateScrollBarYHandler=function(){e.controls.MenuContainer.perfectScrollbar("update")};this.onItemClickHandler=function(b){var c=e.itemSelectorManagerManager.getItemId($(b.target));void 0!==c&&(e.selectedItemId=c,e.itemSelectorManagerManager.setDefaultItemText($(b.target)),e.controls.ItemSelector.trigger(a.itemSelectorOnChangeEventName,e))};
window[b]=this;this.itemSelectorManagerManager=new f(this.controls.ItemSelector,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.LanguageTerms);this.initPerfectScrollbar();this.controls.ItemSelector.parent().on("focusin",function(){e.controls.ItemSelector.addClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.parent().on("focusout",function(){e.controls.ItemSelector.removeClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.on("keyup",
function(a){a.which===CCL.CommonConstants.keyCodes.enter&&e.controls.ItemSelector.trigger("click")});this.controls.MenuContainer.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);this.itemSelectorManagerManager.getAllItems().on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&(e.onItemClickHandler(a),e.controls.MenuContainer.trigger("click"))})}Object.defineProperty(a.prototype,"hasItems",{get:function(){return this.itemSelectorManagerManager.hasItems()},
enumerable:!0,configurable:!0});a.itemSelectorOnChangeEventName="itemSelector:onchange";return a}();e.ItemSelector=d})(f.ItemSelector||(f.ItemSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){this.settings=a;this.modalDialog=window[this.settings.ContainerId]}d.prototype.openDialog=function(a,b){this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,b,!1);this.modalDialog.setTitle(a.header);$("#"+this.settings.HeaderId).text(a.assessmentName);this.modalDialog.openDialog(!1)};return d}();e.TermAssessmentDialogManager=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,d){var c=this;this.serviceUrls=b;this.model=d;this.getAssessments=function(){var a={supervisorType:c.model.supervisorType,courseId:c.model.courseId,termId:c.model.termId(),categoryIds:c.model.categoryIds()};return $.post(c.serviceUrls.Assessments,a,function(a){c.model.addAssessments(a)})};this.getAssessmentPersonResults=function(){var b={supervisorType:c.model.supervisorType,courseId:c.model.courseId,assessmentIds:c.model.assessments().map(function(a){return a.id}),
paging:{pageIndex:c.model.assessmentPersonResultsCurrentPage,pageSize:a.pageSize},sortDescending:c.model.sortDescending};return $.post(c.serviceUrls.AssessmentPersonResults,b,function(a){c.model.addAssessmentPersonResults(a)})}}a.pageSize=50;return a}(),d=function(){function a(a){var b=this;this.settings=a;this.isScrollingInProgress=!1;this.assessmentPersonResultsCurrentPage=0;this.sortDescending=!1;this.initialise=function(){b.areAssessmentsBeingLoaded(!0);b.dataFetcher.getAssessments()};this.addAssessments=
function(a){a&&(a=a.map(function(a){return{id:a.Id,title:a.Title}}),[].push.apply(b.assessments(),a),b.assessments.valueHasMutated());b.areAssessmentsBeingLoaded(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.addAssessmentPersonResults=function(a){if(a){var c=a.map(function(a){return{personId:a.PersonId,fullName:a.FullName,pictureUrl:a.PictureUrl,fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,
score:a.Score?a.Score:"-",hasComment:a.HasComment}})}});[].push.apply(b.assessmentPersonResults(),c);b.assessmentPersonResults.valueHasMutated()}0===b.assessmentPersonResultsCurrentPage?b.areAssessmentsPersonResultsBeingLoaded(!1):b.isAssessmentsPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.pageSize)&&b.areAllAssessmentPersonResultsRetreived(!0);b.assessmentPersonResultsCurrentPage++;b.$assessmentColumnsContainer.perfectScrollbar("update")};this.openProfileCard=function(a){document.showProfileCard?
document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.isScrolledToTheBottom(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.fetchAssessmentsData=function(){b.cancelDataFetching();b.areAssessmentsBeingLoaded(!0);b.assessments([]);b.clearAssessmentPersonResultsData();b.fetchAssessmentsCallbackDebouncer.invokeCallback({},200)};this.clearAssessmentPersonResultsData=
function(){b.areAssessmentsPersonResultsBeingLoaded(!0);b.assessmentPersonResults([]);b.isAssessmentsPersonResultsPageBeingLoaded(!1);b.areAllAssessmentPersonResultsRetreived(!1);b.assessmentPersonResultsCurrentPage=0;b.isScrolledToTheBottom(!1);b.resultsScrollLeft=0;b.resultsScrollTop=0};this.fetchAssessmentPersonResultsData=function(a){void 0===a&&(a=null);b.cancelDataFetching();b.clearAssessmentPersonResultsData();b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(a,200)};this.fetchAssessmentPersonResultsPage=
function(){b.isAssessmentsPersonResultsPageBeingLoaded(!0);b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(null,200)};this.cancelDataFetching=function(){null!=b.fetchAssessmentPersonResultsPromise&&b.fetchAssessmentPersonResultsPromise.readyState!==b.fetchAssessmentPersonResultsPromise.DONE&&b.fetchAssessmentPersonResultsPromise.abort();null!=b.fetchAssessmentsPromise&&b.fetchAssessmentsPromise.readyState!==b.fetchAssessmentsPromise.DONE&&b.fetchAssessmentsPromise.abort()};this.onAssessmentResultsScrollHandler=
function(){if(!b.isScrollingInProgress){b.isScrollingInProgress=!0;var a=b.$assessmentColumnsContainer.scrollLeft();a!==b.resultsScrollLeft&&(b.resultsScrollLeft=a,$("."+b.settings.CssClasses.AssessmentHeaders).scrollLeft(b.resultsScrollLeft));a=b.$assessmentColumnsContainer.scrollTop();a!==b.resultsScrollTop&&(b.fetchAssessmentPersonResultsPageOnScrollHandler(a),b.resultsScrollTop=a,$("."+b.settings.CssClasses.StudentsColumn).scrollTop(b.resultsScrollTop),Math.ceil(b.$assessmentColumnsContainer[0].scrollHeight-
b.$assessmentColumnsContainer[0].scrollTop)===b.$assessmentColumnsContainer[0].clientHeight&&b.isScrolledToTheBottom(!0));b.isScrollingInProgress=!1}};this.resetAssessmentRecordScroll=function(){b.$assessmentColumnsContainer.scrollTop(0);b.$studentsColumn.scrollTop(0)};this.fetchAssessmentPersonResultsPageOnScrollHandler=function(a){!b.areAssessmentsPersonResultsBeingLoaded()&&!b.areAllAssessmentPersonResultsRetreived()&&a>b.resultsScrollTop&&(a=$("."+b.settings.CssClasses.AssessmentColumnsContainer+
" > ."+b.settings.CssClasses.AssessmentColumn).first().children(),a=a.eq(a.length-k.pageSize/2),CCL.CommonFunctions.isOnScreen(a,.5,.5)&&b.fetchAssessmentPersonResultsPage())};this.initialiseTermFilter=function(){b.$termFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,c){b.termId(c.selectedItemId);b.fetchAssessmentsData()};this.initialiseCategoryFilter=function(){b.$categoryFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,
b.onCategoryFilterItemClickHandler)};this.onCategoryFilterItemClickHandler=function(a,c){b.categoryIds(c.selectedItemIds);b.fetchAssessmentsData()};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchAssessmentsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchAssessmentsPromise=b.dataFetcher.getAssessments()});this.fetchAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(a){b.fetchAssessmentPersonResultsPromise=b.dataFetcher.getAssessmentPersonResults();
a&&b.fetchAssessmentPersonResultsPromise.done(function(){return a()})});this.termId=ko.observable(null);this.categoryIds=ko.observableArray([]);this.areAssessmentsBeingLoaded=ko.observable(!0);this.assessments=ko.observableArray([]);this.areAssessmentsPersonResultsBeingLoaded=ko.observable(!0);this.isAssessmentsPersonResultsPageBeingLoaded=ko.observable(!1);this.areAllAssessmentPersonResultsRetreived=ko.observable(!1);this.assessmentPersonResults=ko.observableArray([]);this.persons=ko.computed(function(){return b.assessmentPersonResults().map(function(a){return a})});
this.resultsScrollLeft=this.$assessmentColumnsContainer.scrollLeft();this.resultsScrollTop=this.$assessmentColumnsContainer.scrollTop();this.initialiseTermFilter();this.initialiseCategoryFilter();this.isScrolledToTheBottom=ko.observable(!1)}Object.defineProperty(a.prototype,"$assessmentColumnsContainer",{get:function(){return $("."+this.settings.CssClasses.AssessmentColumnsContainer)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$studentsColumn",{get:function(){return $("."+
this.settings.CssClasses.StudentsColumn)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$categoryFilter",{get:function(){return $("#"+this.settings.ClientIds.CategoryFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"courseId",{get:function(){return this.settings.CourseId},enumerable:!0,configurable:!0});return a}();e.AssessmentRecordViewModel=d;var a=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};var c=new f.KnockoutCustomBindingsManager;c.registerSafeImgBinding();c.registerPerfectScrollBarBinding();this.model=new d(a);ko.applyBindings(this.model,this.$container[0]);
this.model.initialise();this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();e.AssessmentRecord=a})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,d){var c=this;this.serviceUrls=b;this.model=d;this.getDataForOrganisation=function(){var a={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId()};return $.post(c.serviceUrls.Filters,a,function(a){c.model.updateOrganisation(a)})};this.getCourses=function(){var b={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),paging:{pageIndex:c.model.coursesCurrentPage,pageSize:a.coursesPageSize}};
return $.post(c.serviceUrls.Courses,b,function(a){c.model.addCourses(a);c.model.areCoursesBeingLoaded(!1)})};this.getTermAssessments=function(){if(!c.model.currentCourse())return null;var a={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),courseId:c.model.currentCourse().id,hierarchyIds:c.model.hierarchyIds()};return $.post(c.serviceUrls.TermAssessments,a,function(a){a&&c.model.addTermAssessments(a);c.model.areCourseTermAssessmentsBeingLoaded(!1)})};
this.getTermAssessmentPersonResults=function(){if(!c.model.currentCourse())return null;var b={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),courseId:c.model.currentCourse().id,hierarchyIds:c.model.hierarchyIds(),finalAssessmentIds:c.model.termAssessments().map(function(a){return a.id}),paging:{pageIndex:c.model.termAssessmentPersonResultsCurrentPage,pageSize:a.termAssessmentPersonResultsPageSize},sortDescending:c.model.sortDescending};return $.post(c.serviceUrls.TermAssessmentPersonResults,
b,function(a){c.model.addTermAssessmentPersonResults(a);c.model.areCourseTermAssessmentsResultsBeingLoaded(!1)})}}a.coursesPageSize=10;a.termAssessmentPersonResultsPageSize=50;return a}(),d=function(){function a(a){var b=this;this.settings=a;this.isResultsHorisontalScrollInProgress=!1;this.termAssessmentPersonResultsCurrentPage=this.coursesCurrentPage=0;this.sortDescending=!1;this.updateOrganisation=function(a){$("."+b.settings.CssClasses.FiltersContainer).replaceWith($(a));b.initialiseFilters();
b.fetchCoursesData()};this.addCourses=function(a){var c=0===b.coursesCurrentPage,d=a.map(function(a,d){return{id:a.Id,title:a.Title,isSelected:c?0===d:!1,assessmentRecordTooltip:b.getAssessmentRecordTooltip(a.Title)}});[].push.apply(b.courses(),d);b.courses.valueHasMutated();b.coursesCount(b.courses().length);c?(b.areCoursesBeingLoaded(!1),b.enableHierarchyFilter(),0<b.coursesCount()&&b.selectCourse(b.courses()[0])):b.isCoursesPageBeingLoaded(!1);(0===a.length||a.length<k.coursesPageSize)&&b.areAllCoursesRetreived(!0);
b.coursesCurrentPage++};this.selectCourse=function(a){b.currentCourse(a);b.fetchTermAssessmentsData();$(window).scrollTop(0)};this.openAssessmentRecord=function(a){window.location.href=b.settings.ServiceUrls.AssessmentRecord+"?courseId="+a.id+"&supervisorType="+b.settings.SupervisorType};this.selectStudent=function(a){b.currentStudent(a)};this.clearStudent=function(){b.currentStudent(null)};this.addTermAssessments=function(a){a=a.map(function(a){return{id:a.Id,title:a.Title}});[].push.apply(b.termAssessments(),
a);b.termAssessments.valueHasMutated();b.termAssessmentsCount(b.termAssessments().length);b.fetchTermAssessmentPersonResultsData()};this.addTermAssessmentPersonResults=function(a){if(a){var c=a.map(function(a){return{personId:a.PersonId,fullName:a.FullName,pictureUrl:a.PictureUrl,fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score,hasComment:a.HasComment}})}});
[].push.apply(b.termAssessmentPersonResults(),c);b.termAssessmentPersonResults.valueHasMutated();b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length)}0===b.termAssessmentPersonResultsCurrentPage?b.areCourseTermAssessmentsResultsBeingLoaded(!1):b.isTermAssessmentPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.termAssessmentPersonResultsPageSize)&&b.areAllTermAssessmentPersonResultsRetreived(!0);b.termAssessmentPersonResultsCurrentPage++};this.openProfileCard=function(a){document.showProfileCard?
document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.fetchTermAssessmentPersonResultsData();$(window).scrollTop(0)};this.showMoreCourses=function(){b.fetchCoursesPage()};this.showMoreResults=function(){b.fetchTermAssessmentPersonResultsPage()};this.scrollResultsContainer=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsFixedHeadersWrapper),$("."+b.settings.CssClasses.ResultsContainer))};
this.scrollResultsFixedHeader=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsContainer),$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper))};this.ajustResultsFixedHeaderPosition=function(){b.onResultsFixedHeaderPositionChangeHandler()};this.scrollHorisontaly=function(a,c){b.isResultsHorisontalScrollInProgress||(b.isResultsHorisontalScrollInProgress=!0,c.scrollLeft(a.scrollLeft()),b.isResultsHorisontalScrollInProgress=!1)};this.isScrolledIntoView=function(a){return a.offset().top>=
$(window).scrollTop()};this.onResultsFixedHeaderPositionChangeHandler=function(){var a=$("."+b.settings.CssClasses.StudentHeader);if(0<a.length){var c=CCL.CommonFunctions.isElementFullyShownInWindow(a),d=$("."+b.settings.CssClasses.ResultsContainer),e=CCL.CommonFunctions.isElementFullyShownInWindow(d),f=$("."+b.settings.CssClasses.StudentFixedHeader),g=$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper);if(c&&e)f.css({display:"none"}),g.css({display:"none"});else{c=c||b.isScrolledIntoView(d)?
a.offset().top-$(window).scrollTop():0;f.css({display:"block",position:"fixed",top:c,height:a.outerHeight(!0),width:a.outerWidth(!0)});g.css({display:"block",position:"fixed",top:c,left:a.offset().left+a.outerWidth(!0),height:a.outerHeight(!0),width:d.outerWidth(!0)});g.perfectScrollbar("update");$("."+b.settings.CssClasses.ResultsFixedHeadersContainer).css({display:"flex",width:d[0].scrollWidth});a=$("."+b.settings.CssClasses.ResultsFixedHeader);var k=$("."+b.settings.CssClasses.ResultsHeader);a.each(function(a,
b){$(b).css({width:k.eq(a).outerWidth(!0)})})}}};this.openAssessmentDialog=function(a,c){var d=e.termAssessmentDialogManagerInstance;if(d){var f=ko.utils.arrayFirst(b.termAssessments(),function(a){return a.id===c}),g=ko.utils.arrayFirst(b.termAssessmentPersonResults(),function(b){return b.personId===a});d.openDialog({header:g.fullName,assessmentName:f.title},{personId:a,gradebookItemId:c,supervisorType:b.settings.SupervisorType})}};this.openAssessmentDialogForCurrentStudent=function(a,c){b.openAssessmentDialog(a().personId,
c)};this.getPersonGradebookItemResult=function(a,c){var d=ko.utils.arrayFirst(b.termAssessmentPersonResults(),function(b){return b.personId===a().personId});return ko.utils.arrayFirst(d.results,function(a){return a.gradebookItemId===c})};this.initialiseFilters=function(){b.initialiseOrganisationFilter();b.initialiseTermFilter();b.initialiseHierarchyFilter()};this.disableFilters=function(){b.$organisationFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$organisationFilter.prop("disabled",!0);
b.$termFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$termFilter.prop("disabled",!0);b.disableHierarchyFilter()};this.disableHierarchyFilter=function(){b.$hierarchyFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$hierarchyFilter.prop("disabled",!0)};this.enableHierarchyFilter=function(){window[b.settings.ClientIds.HierarchyFilter].hasItems&&(b.$hierarchyFilter.removeClass(b.settings.CssClasses.FilterDisabled),b.$hierarchyFilter.removeProp("disabled"))};this.initialiseOrganisationFilter=
function(){b.$organisationFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onOrganisationFilterClickHandler)};this.onOrganisationFilterClickHandler=function(a,c){b.organisationId(c.selectedItemId);b.fetchOrganisationData()};this.initialiseTermFilter=function(){b.$termFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,c){b.termId(c.selectedItemId);b.fetchCoursesData()};this.initialiseHierarchyFilter=
function(){b.$hierarchyFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onHierarchyFilterItemClickHandler)};this.onHierarchyFilterItemClickHandler=function(a,c){b.hierarchyIds(c.selectedItemIds);b.fetchTermAssessmentPersonResultsData()};this.fetchOrganisationData=function(){b.clearFilters();b.clearCoursesData();b.cancelDataFetching();b.disableFilters();b.fetchFiltersCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesData=function(){b.clearCoursesData();
b.clearTermAssessmentsData();b.cancelDataFetching();b.disableHierarchyFilter();b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesPage=function(){b.isCoursesPageBeingLoaded(!0);b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentsData=function(){b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentsCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentPersonResultsData=function(){b.clearTermAssessmentPersonResultsData();
b.cancelDataFetching();b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.onFetchTermAssessmentPersonResultsPageHandler=function(a){if(!b.areCourseTermAssessmentsResultsBeingLoaded()&&!b.areAllTermAssessmentPersonResultsRetreived()&&!b.isStudentSelectedInMobile()){a=$(a.target).scrollTop();if(a>b.termAssessmentPersonResultsListScrollTop){var c=$("."+b.settings.CssClasses.MobileStudentContainer).is(":visible")?$("."+b.settings.CssClasses.MobileStudentContainer).children():
$("."+b.settings.CssClasses.StudentsContainer).children();c=c.eq(c.length-k.termAssessmentPersonResultsPageSize/2);CCL.CommonFunctions.isOnScreen(c,.5,.5)&&b.fetchTermAssessmentPersonResultsPage()}b.termAssessmentPersonResultsListScrollTop=a}};this.fetchTermAssessmentPersonResultsPage=function(){b.isTermAssessmentPersonResultsPageBeingLoaded(!0);b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.cancelDataFetching=function(){null!=b.fetchFiltersPromise&&b.fetchFiltersPromise.readyState!==
b.fetchFiltersPromise.DONE&&b.fetchFiltersPromise.abort();null!=b.fetchCoursesPromise&&b.fetchCoursesPromise.readyState!==b.fetchCoursesPromise.DONE&&b.fetchCoursesPromise.abort();null!=b.fetchTermAssessmentsPromise&&b.fetchTermAssessmentsPromise.readyState!==b.fetchTermAssessmentsPromise.DONE&&b.fetchTermAssessmentsPromise.abort();null!=b.fetchTermAssessmentPersonResultsPromise&&b.fetchTermAssessmentPersonResultsPromise.readyState!==b.fetchTermAssessmentPersonResultsPromise.DONE&&b.fetchTermAssessmentPersonResultsPromise.abort()};
this.clearFilters=function(){b.termId(null);b.hierarchyIds([])};this.clearCoursesData=function(){b.courses([]);b.coursesCount(b.courses().length);b.areCoursesBeingLoaded(!0);b.isCoursesPageBeingLoaded(!1);b.currentCourse(null);b.areAllCoursesRetreived(!1);b.coursesCurrentPage=0;b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData()};this.clearTermAssessmentsData=function(){b.termAssessments([]);b.termAssessmentsCount(b.termAssessments().length);b.areCourseTermAssessmentsBeingLoaded(!0)};
this.clearTermAssessmentPersonResultsData=function(){b.termAssessmentPersonResults([]);b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length);b.areCourseTermAssessmentsResultsBeingLoaded(!0);b.isTermAssessmentPersonResultsPageBeingLoaded(!1);b.currentStudent(null);b.areAllTermAssessmentPersonResultsRetreived(!1);b.termAssessmentPersonResultsCurrentPage=0;b.ajustResultsFixedHeaderPosition()};this.getAssessmentRecordTooltip=function(a){a=CCL.CommonFunctions.htmlEncode(a);return CCL.CommonFunctions.formatString(b.settings.LanguageTerms.AssessmentRecordTooltip,
a)};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchCoursesCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchCoursesPromise=b.dataFetcher.getCourses()});this.fetchFiltersCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchFiltersPromise=b.dataFetcher.getDataForOrganisation()});this.fetchTermAssessmentsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentsPromise=b.dataFetcher.getTermAssessments()});this.fetchTermAssessmentPersonResultsCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentPersonResultsPromise=b.dataFetcher.getTermAssessmentPersonResults()});this.organisationId=ko.observable(this.settings.OrganisationId);this.termId=ko.observable(0===this.settings.TermId?null:this.settings.TermId);this.currentCourse=ko.observable(null);this.hierarchyIds=ko.observableArray(this.settings.HierarchyIds);this.currentCourseTitle=ko.pureComputed(function(){var a="";null!=b.currentCourse()&&(a=b.currentCourse().title);return a});this.areCoursesInitiated=
ko.observable(!1);this.areCoursesBeingLoaded=ko.observable(!0);this.isCoursesPageBeingLoaded=ko.observable(!1);this.areCourseTermAssessmentsBeingLoaded=ko.observable(!0);this.areCourseTermAssessmentsResultsBeingLoaded=ko.observable(!0);this.isTermAssessmentPersonResultsPageBeingLoaded=ko.observable(!1);this.courses=ko.observableArray([]);this.coursesCount=ko.observable(0);this.areAllCoursesRetreived=ko.observable(!1);this.termAssessments=ko.observableArray([]);this.termAssessmentsCount=ko.observable(0);
this.termAssessmentPersonResults=ko.observableArray([]);this.termAssessmentPersonResultsCount=ko.observable(0);this.areAllTermAssessmentPersonResultsRetreived=ko.observable(!1);this.persons=ko.computed(function(){return b.termAssessmentPersonResults().map(function(a){return a})});this.currentStudent=ko.observable(null);this.isStudentSelectedInMobile=ko.computed(function(){return b.currentStudent()&&CCL.CommonFunctions.isMobileDevice()});this.initialiseFilters();this.termAssessmentPersonResultsListScrollTop=
$(window).scrollTop();$(window).on("resize scroll touchmove",this.onResultsFixedHeaderPositionChangeHandler);$(window).on("scroll touchmove",this.onFetchTermAssessmentPersonResultsPageHandler)}Object.defineProperty(a.prototype,"$organisationFilter",{get:function(){return $("#"+this.settings.ClientIds.OrganisationFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"$hierarchyFilter",{get:function(){return $("#"+this.settings.ClientIds.HierarchyFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});return a}();e.TermAssessmentsViewModel=d;var a=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};
a=new f.KnockoutCustomBindingsManager;a.registerSafeImgBinding();a.registerPerfectScrollBarBinding();this.model=new d(this.settings);ko.applyBindings(this.model,this.$container[0]);this.model.dataFetcher.getCourses().done(function(){b.model.areCoursesInitiated(!0)});this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,
"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();e.TermAssessments=a})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){var b=this;this.context=a;$("#"+this.context.Controls.DeleteButtonId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){return b.deleteSelectedTerms()})}a.prototype.deleteSelectedTerms=function(){var a=this,c=window[this.context.Controls.DataGridName],d=c.GetSelectedValues(),e=[];d&&0<d.length&&(e=d.substr(0,d.length-1).split(","));if(!c.GetNumberOfSelectedRows())return jAlert(this.context.Settings.PleaseMakeSelectionMessage),
!1;c=this.context.Settings.DeleteWarningMessage.replace(/#NumberOfSelectedRows/g,c.GetNumberOfSelectedRows());for(var f in e)if(e.hasOwnProperty(f)&&-1!==this.context.TermIdsUsedInGradebook.indexOf(e[f])){c=this.context.Settings.DeleteWarningMessageWithExistTermInGradebook;break}$.alerts.okButton=this.context.Settings.YesButtonText;$.alerts.cancelButton=this.context.Settings.NotButtonText;jConfirm(c,this.context.Settings.WarningDialogTitle,function(b){b&&__doPostBack("__Page",a.context.Settings.PostBackArgumentDelete)});
return!1};return a}();e.TermManagement=d})(e.TermManagement||(e.TermManagement={}))})(f.Terms||(f.Terms={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,a){var b=[],c=d.ArrowButton.find("img"),e=new DivToggler({divId:a.ClientIds.TopMenuArea,isCollapsed:!a.TopmenuExpanded,afterToggle:function(){e.settings.isCollapsed?(c.removeClass(a.CssClasses.ArrowUp).addClass(a.CssClasses.ArrowDown),d.ArrowButton.prop("title",a.Terms.ClickToMaximise)):(c.removeClass(a.CssClasses.ArrowDown).addClass(a.CssClasses.ArrowUp),d.ArrowButton.prop("title",a.Terms.ClickToMinimise))},changeDivVisibility:!0}),f=new DivToggler({divId:a.ClientIds.BottomNavigationBarWrapper,
isCollapsed:!1,changeDivVisibility:!0}),l=$(window);e.initialize();d.ArrowButton.click(function(){e.toggleDiv(function(){$.ajax({type:"POST",url:a.Urls.SaveTopStateFormat+(e.settings.isCollapsed?0:1)})});window[a.SetIframeDefaultHeightFunctionName]()});b.push(e);f.initialize();b.push(f);a.ClientIds.TopNavigationContainer&&b.push(new DivToggler({divId:a.ClientIds.TopNavigationContainer,isCollapsed:!1,changeDivVisibility:!0}));if(a.UseLeftmenuToggler){var m=function(b,c,e){d.LeftMenuToggler.prop("title",
b?a.Terms.OpenMenu:a.Terms.HideMenu).toggleClass(c,!b).toggleClass(e,b)},k=new DivToggler({divId:a.ClientIds.LeftArea,isCollapsed:!a.LeftMenuExpanded,changeDivVisibility:!1,afterToggle:function(){var b=k.settings.isCollapsed,c=a.CssClasses.DesktopLefttoggleExpand,e=a.CssClasses.DesktopLefttoggleCollapse,f=a.CssClasses.DesktopLeftmenuHidden;d.LeftArea.toggleClass(a.CssClasses.DesktopLeftmenuVisible,!b).toggleClass(f,b);m(b,c,e)}}),p=new LeftMenu;p.settings={treeMenuClientID:a.ClientIds.TreeMenu,contentAreaIframeClientID:a.ClientIds.ContentAreaIframe,
arrowButtonClientID:d.ArrowButton.prop("id")};p.initialize();var n=new DivToggler({divId:a.ClientIds.LeftArea,isCollapsed:!0,changeDivVisibility:!1,afterToggle:function(){var b=n.settings.isCollapsed,c=a.CssClasses.MobileLeftmenuHidden;d.LeftArea.toggleClass(a.CssClasses.MobileLeftmenuVisible,!b).toggleClass(c,b);m(n.settings.isCollapsed,a.CssClasses.MobileLefttoggleExpand,a.CssClasses.MobileLefttoggleCollapse);n.settings.isCollapsed||(b=CCL.CommonFunctions.calculateBottomOffset(d.MenuIframe),p.recalculateHeight(IframeResizer.getIframeDefaultHeight(l,
d.MenuIframe,b)),a.IsIosDevice&&p.forceRefreshOnIos())}});d.LeftMenuToggler.click(function(){p.isDesktopMode()?k.toggleDiv(function(){$.ajax({type:"POST",url:a.Urls.SaveLeftStateFormat+(k.settings.isCollapsed?0:1)})}):n.toggleDiv()});d.MainSidebar.on("click","a",function(){var a=$(this).attr("href");"#"===a||0===a.toLowerCase().indexOf("javascript:")||p.isDesktopMode()||n.toggleDiv()});n.initialize();b.push(n);k.initialize();b.push(k)}window.divTogglers=b;CCL.CommonFunctions.attachPostMessageEventListener(l,
[CCL.CommonWindowMessages.MessageNames.disableFullScreen,CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame,CCL.CommonWindowMessages.MessageNames.enableFullScreen,CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame],function(a,b){if(!window.top[CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame]){var c;if(a.messageName===CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame||a.messageName===CCL.CommonWindowMessages.MessageNames.disableFullScreen){$(window.top.divTogglers).each(function(){this.settings.isCollapsed||
this.expandDiv()});var e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasCollapsed);var f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe)}else a.messageName!==CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame&&!CCL.CommonWindowMessages.MessageNames.enableFullScreen||window.top.isProfileCardOpened||($(window.top.divTogglers).each(function(){var a=this.settings.isCollapsed;this.collapseDiv();
this.settings.isCollapsed=a}),e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasExpanded),f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandExtensionIframe));(c=1===d.MenuIframe.length?d.MenuIframe.get(0).contentWindow:void 0)&&CCL.CommonFunctions.makePostMessageCall(c,f);CCL.CommonFunctions.makePostMessageCall(b,e)}});CCL.CommonFunctions.attachPostMessageEventListener(l,CCL.CommonWindowMessages.MessageNames.collapseLeftMenu,
function(){k.collapseDiv()});CCL.CommonFunctions.attachPostMessageEventListener(l,CCL.CommonWindowMessages.MessageNames.toggleBreadcrumbs,function(b,c){b.extendedData?$("."+a.CssClasses.BreadcrumbsContainer).parent().slideDown(0):$("."+a.CssClasses.BreadcrumbsContainer).parent().slideUp(0)})}}();e.BottomNavigationBar=f})(f.TopMenu||(f.TopMenu={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){e.GradeExportInstance=this;this.controls=a;this.context=b;this.init()}d.prototype.dismissSyncItemNotifications=function(){$.post(this.context.WebMethods.CancelSyncItemNotification,{courseId:this.context.Settings.CourseId}).fail(function(a){e.Utils.handleAjaxError(a)})};d.prototype.init=function(){var a=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;$(document).on(d.showFeedbackEventTitle,
function(b,c,d){return a.showFeedback(c,d)})};d.prototype.showFeedback=function(a,b){var c=this;this.changeFeedbackContainer(b);null!=a&&CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.Container,a,this.context.LanguageTerms.GotIt,function(){c.closeFeedback()})};d.prototype.changeFeedbackContainer=function(a){null!=a&&$(document).find("."+CCL.CommonCssClasses.InformationFeedback.Container).css("top",a.top+20)};d.prototype.closeFeedback=function(){CCL.InformationFeedback.hideFeedback(this.controls.Container)};
d.showFeedbackEventTitle="LineItemsTransfer:showFeedback";return d}();e.GradeExport=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){var b=this;this.toggleValidator=ValidatorEnable;this.self=this;e.AddAssessmentInstance=this;this.context=a;this.window=$(window);var c=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;this.initialDefaultScore=1===this.context.Controls.DefaultScore.length?this.context.Controls.DefaultScore.val():"";this.initialDefaultAssessmentItemId=1===this.context.Controls.DefaultAssessmentItemId.length?
this.context.Controls.DefaultAssessmentItemId.val():"";this.context.Controls.OkButton.click(function(){return b.approveChanges(b)});this.secondSectionSeparator=this.context.Controls.WhereCountSection.parent().find("div."+this.context.CssClasses.FormSectionSeparator).last();this.toggleCustomExistingSections(this);this.context.Controls.CustomRadioButton.click(function(){b.toggleCustomExistingSections(b)});this.context.Controls.ExistingAssessment.click(function(){b.toggleCustomExistingSections(b)});
this.toggleFinalAssessmentCheckbox();this.context.Controls.AddDefaultAssessmentCheckBox.click(function(){b.toggleDefaultAssessmentControls(b)});this.context.Controls.DefaultAssessmentItemList.change(function(){b.saveDefaultAssessmentItemListSelection(b)});this.context.Controls.RetrieveLearningObjectivesFromPlannerButton.click(function(){b.retrieveLearningObjectivesFromPlanner(b)});$(document).on(c.context.Settings.LearningObjectiveItemsChangedClientEventName,function(a,b){c.refreshAssessmentTypeList(c,
a,b)});1===this.context.Controls.AssessmentScaleList.length&&(this.context.Controls.AssessmentScaleList.change(function(){c.toggleWeightPanelAccordingToAssessmentScale(this.value);c.toggleMaxScorePanelAccordingToAssessmentScale();c.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale()}),this.toggleWeightPanelAccordingToAssessmentScale(this.context.Controls.AssessmentScaleList.val()))}d.prototype.toggleCustomExistingSections=function(a){var b=a.context.Controls.CustomRadioButton.prop("checked");
a.toggle(a.context.Controls.ExistingSection,!b);a.toggle(a.context.Controls.CustomSection,b);a.toggle(a.context.Controls.AssessmentScaleListHolder,b);a.context.Controls.AssessmentScaleName.toggle(!b||0===a.context.Controls.AssessmentScaleList.length);a.toggle(a.context.Controls.EditableMaxScoreHolder,b);a.context.Controls.MaxScoreLabel.toggle(!b||0===a.context.Controls.MaxScore.length);a.context.Settings.UseTerms&&(0<a.context.Settings.SelectedTermId&&a.toggle(a.context.Controls.FinalAssessmentPanel,
b),a.context.Controls.FinalAssessmentCheckbox.prop("checked")&&a.toggleFinalAssessmentSettings(b),0<a.context.Settings.SelectedTermId&&a.toggleWhereOrHowSection(a.context.Controls.WhereCountSection,b||a.context.Controls.CategoryListPanel.is(":visible")));a.context.Settings.UseTerms&&0!==a.context.Settings.SelectedTermId||a.context.Controls.CustomRadioButton.prop("disabled")&&b||a.toggleBottomWarningMessageForElement(a);a.toggleWeightPanelAccordingToAssessmentScale(null);a.toggleMaxScorePanelAccordingToAssessmentScale();
a.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale();a.toggleIsManualAssessmentVisible()};d.prototype.toggleIsManualAssessmentVisible=function(){var a=this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")||!this.context.Controls.CustomRadioButton.prop("checked");this.toggle(this.context.Controls.IsManualAssessmentVisibleTogglePanel,!a)};d.prototype.toggleFinalAssessmentCheckbox=function(){this.toggleFinalAssessmentSettings(this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&
this.context.Controls.FinalAssessmentCheckbox.prop("checked"))};d.prototype.toggleFinalAssessmentSettings=function(a){this.toggleIsManualAssessmentVisible();this.toggle(this.context.Controls.CategoryListPanel,!a);this.context.Settings.UseTerms&&0<this.context.Settings.SelectedTermId&&this.toggleWhereOrHowSection(this.context.Controls.HowAssessSection,!a);this.toggleWeightPanelAccordingToAssessmentScale(null);this.toggleMaxScorePanelAccordingToAssessmentScale()};d.prototype.toggleWhereOrHowSection=
function(a,b){a.is(":visible")&&b||(this.toggle(a,b),this.secondSectionSeparator.toggle(this.context.Controls.HowAssessSection.is(":visible")&&b))};d.prototype.toggleWeightPanelAccordingToAssessmentScale=function(a){1===this.context.Controls.WeightPanel.length&&this.toggle(this.context.Controls.WeightPanel,(!this.context.Controls.FinalAssessmentCheckbox.is(":visible")||!this.context.Controls.FinalAssessmentCheckbox.prop("checked"))&&(1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?
this.isAssessmentScaleSupportWeighting(a||this.context.Controls.AssessmentScaleList.val()):this.context.Settings.IsAssessmentScaleOfTheColumnSupportWeighting))};d.prototype.toggleMaxScorePanelAccordingToAssessmentScale=function(){1===this.context.Controls.MaxScorePanel.length&&this.toggle(this.context.Controls.MaxScorePanel,1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?this.isAssessmentScaleSupportScore():this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore)};
d.prototype.saveDefaultAssessmentItemListSelection=function(a){a.context.Controls.DefaultAssessmentItemId.val(a.context.Controls.DefaultAssessmentItemList.val())};d.prototype.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale=function(){1===this.context.Controls.AddDefaultAssessmentPanel.length&&(this.isAssessmentScaleSelected()||this.isAssessmentScaleSupportScore()?this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("disabled"):(this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"),
this.context.Controls.AddDefaultAssessmentCheckBox.prop("disabled","disabled")),this.toggleDefaultAssessmentControls(this))};d.prototype.toggleDefaultAssessmentControls=function(a){var b=a.context.Controls.CustomRadioButton.prop("checked")&&!a.usedFinalAssessmentOption(),c=!1,d=!1;b?(c=a.context.Controls.AddDefaultAssessmentCheckBox.prop("checked"),d=a.isAssessmentScaleSupportScore(),c&&!d&&$.ajax({type:"POST",url:a.context.WebMethods.GetAssessmentItems,dataType:"json",data:{assessmentId:this.getAssessmentId(),
courseId:this.context.Settings.CourseId},success:function(b){a.context.Controls.DefaultAssessmentItemList.empty();for(var c=0,d=b.length;c<d;c+=1){var e=b[c];a.context.Controls.DefaultAssessmentItemList.append('<option value="'+e.AssessmentItemId+'">'+e.Title+"</option>")}""!==a.context.Controls.DefaultAssessmentItemId.val()&&a.context.Controls.DefaultAssessmentItemList.val(a.context.Controls.DefaultAssessmentItemId.val())},error:function(a){return CCL.CommonFunctions.alertAjaxError(a,null,null)}})):
(a.context.Controls.DefaultAssessmentItemList.empty(),a.context.Controls.DefaultAssessmentItemId.val(""),a.context.Controls.DefaultScore.val(""),a.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"));a.toggle(a.context.Controls.AddDefaultAssessmentPanel,b);a.toggle(a.context.Controls.DefaultAssessmentItemListPanel,b&&c&&!d);a.toggle(a.context.Controls.DefaultScorePanel,b&&c&&d)};d.prototype.isAssessmentScaleSupportWeighting=function(a){return parseInt(a.split(":")[1])===this.context.Settings.AssessmentTotalsAverage};
d.prototype.isAssessmentScaleSupportScore=function(){return 1===this.context.Controls.AssessmentScaleList.length&&parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0])===this.context.Settings.ScoreItemValue||0===this.context.Controls.AssessmentScaleList.length&&this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore};d.prototype.toggleBottomWarningMessageForElement=function(a){if(window[a.context.Settings.BottomMessageClientInstanceName]){var b=!a.context.Controls.CustomRadioButton.prop("checked")&&
a.context.Settings.IsAssessmentScaleOfTheColumnSupportScore;window[a.context.Settings.BottomMessageClientInstanceName].self.context.Controls.container.toggle(b);b&&(a.context.Controls.FinalAssessmentCheckbox.prop("checked",!1),a.toggleFinalAssessmentCheckbox());a.context.Controls.FinalAssessmentCheckbox.prop("disabled",b)}};d.prototype.usedFinalAssessmentOption=function(){return 1===this.context.Controls.FinalAssessmentCheckbox.length&&this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&
this.context.Controls.FinalAssessmentCheckbox.prop("checked")};d.prototype.isAssessmentScaleSelected=function(){return null!=this.getAssessmentId()};d.prototype.getAssessmentId=function(){return 1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.val()!==this.context.Settings.NotSelectedAssessmentScaleValue?parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0]):0===this.context.Controls.AssessmentScaleList.length&&0<this.context.Settings.SelectedAssessmentId?
this.context.Settings.SelectedAssessmentId:null};d.prototype.toggle=function(a,b){var c=this;if(1===a.length){var d=function(a,b){for(var d=0,e=a.length;d<e;d++)c.toggleValidator(a[d],b)};a.toggle(b);a.hasClass(this.context.CssClasses.FormContainer)?a.find('input:not([type="hidden"]), select, textarea').each(function(a,b){d($(b).nextAll("span[id$=Validator]").toArray(),$(b).is(":visible"))}):d(a.nextAll("span[id$=Validator]").toArray(),b)}};d.prototype.approveChanges=function(a){return a.confirmationDefaultAssessmentEditRequired()?
(jConfirm(a.context.Controls.AddDefaultAssessmentCheckBox.prop("checked")?a.context.LanguageTerms.DefaultAssessmentChaingingConfirmMessage:a.context.LanguageTerms.DefaultAssessmentTurningOffConfirmMessage,a.context.LanguageTerms.PleaseConfirm,function(b){if(b)if(a.pageIsValid())a.context.Functions.SuccessSubmit();else return!1;return!0}),!1):!0};d.prototype.confirmationDefaultAssessmentEditRequired=function(){if(!this.context.Settings.IsEditModeAndCustomAssessment)return!1;var a=1===this.context.Controls.AddDefaultAssessmentCheckBox.length&&
this.context.Controls.AddDefaultAssessmentCheckBox.prop("checked");return this.context.Settings.UseDefaultAssessment&&!a||this.context.Settings.UseDefaultAssessment&&a&&(1===this.context.Controls.DefaultScore.length&&this.context.Controls.DefaultScore.val()!==this.initialDefaultScore||1===this.context.Controls.DefaultAssessmentItemId.length&&this.context.Controls.DefaultAssessmentItemId.val()!==this.initialDefaultAssessmentItemId)};d.prototype.pageIsValid=function(){return Page_ClientValidate&&"function"===
typeof Page_ClientValidate?(Page_ClientValidate(),Page_IsValid):!0};d.prototype.retrieveLearningObjectivesFromPlanner=function(a){a.context.Controls.OkButton.attr("disabled","disabled");a.context.Controls.RetrieveLearningObjectivesFromPlannerButton.addClass(a.context.CssClasses.ButtonInProgerssClass).attr("disabled","disabled");$.ajax({type:"POST",data:$.param({termId:a.context.Settings.TermId,courseId:a.context.Settings.CourseId},!0),dataType:"json",url:a.context.WebMethods.GetLearningObjectivesFromPlanner}).done(function(b){b.Success||
alert(b.Message);b=$.unique((b.LearningObjectiveIds?b.LearningObjectiveIds:[]).concat(window[a.context.Controls.LearningObjectivesEditorKey].getObjectiveIdsArray()));window[a.context.Controls.LearningObjectivesEditorKey].addLearningObjectives(b)}).fail(function(a){handleAjaxError(a)}).always(function(){a.context.Controls.OkButton.removeAttr("disabled");a.context.Controls.RetrieveLearningObjectivesFromPlannerButton.removeClass(a.context.CssClasses.ButtonInProgerssClass).removeAttr("disabled")})};d.prototype.refreshAssessmentTypeList=
function(a,b,c){a.context.Controls.AssessmentTypeListPanel.find("["+a.context.Settings.IncludeLearningObjectivesAttribute+"='False']").toggle(!(0<c.length))};return d}();e.AddAssessment=f})(f.AssessmentRecord||(f.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.settings=a;this.controls=b;this.document=$(document);window[this.settings.ClientInstanceName]=this;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton});this.controls.usePlagiarismCheckBox.click(function(a){c.controls.plagiarismInfoMessage.toggle()});this.controls.useAnonymousSubmissionCheckBox.click(function(a){c.controls.anonymousSubmissionInfoMessage.toggle()});
this.settings.ConnectAssessmentCriteriaToScale&&this.controls.assessmentDropDown.change(function(){c.toggleCriteriaWeights(!1)})}d.prototype.toggleCriteriaWeights=function(a){var b=this.controls.assessmentDropDown.find("option:selected").val();this.document.trigger(this.settings.LearningObjectivesEditorToggleCriteriaWeightsVisibilityMethodName,{show:!a&&b!==this.settings.AssessmentScaleControlDoNotUseAssessmentValue})};return d}();e.AddEditLearningToolElement=f})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){this.settings=a;this.document=$(document);window[this.settings.ClientInstanceName]=this}a.prototype.checkIfTransitionAllowed=function(a,c){var b=[];this.settings.AllowedTypeTransitions.forEach(function(c){c.Type==a&&(b=c.AllowedChildrenTypes)});return 0<b.length&&-1<$.inArray(c,b)};a.prototype.extractType=function(a){var b=this.settings.NodeNamePrefix,d=a.indexOf(b);if(0>d)return"";var e=a.indexOf(" ",d);0>e&&(e=a.length-1);return a.substring(d+
b.length,e)};a.prototype.findParentWithType=function(a,c,d){c=this.settings.NodeNamePrefix+c;if(d&&$(a).hasClass(c))return a;a=$(a).parents("."+c);return 0<a.length?a.get(0):null};a.prototype.moveNode=function(a,c,d,e,f){var b=this,g=$("#"+a);c=$("#"+d);var h=$("#"+e),l={};l[this.settings.RequestItems.RepositoryTreeEntityClientIdToMove]=a;l[this.settings.RequestItems.RepositoryTreeEntityToMoveType]=this.extractType(g.attr("class"));l[this.settings.RequestItems.NewParentRepositoryTreeEntityClientId]=
d;l[this.settings.RequestItems.NewParentRepositoryTreeEntityType]=this.extractType(c.attr("class"));l[this.settings.RequestItems.RelativeRepositoryTreeEntityClientId]=e;l[this.settings.RequestItems.RelativeRepositoryTreeEntityType]=this.extractType(h.attr("class"));l[this.settings.RequestItems.RelativeMovePosition]=f;l[this.settings.RequestItems.HierarchyId]=this.settings.HierarchyId;l[this.settings.RequestItems.CountryCode]=this.settings.CountryCode;$.ajax({type:"POST",url:this.settings.MoveUrl,
data:l}).done(function(){g.children("a").first().effect("highlight",{},2500)}).fail(function(){jAlert(b.settings.Terms.TreeMenuErrorWhileMoving,b.settings.Terms.Error,function(){location.reload()})})};a.prototype.beforeMove=function(a){if(this.extractType(a.o[0].className)===this.settings.TreeTypeDescriptor){a=a.np[0];var b=this.extractType(a.className)===this.settings.TreeTypeCriterion;return b&&$(a).find("li."+this.settings.NodeNamePrefix+this.settings.TreeTypeDescriptor).length>=this.settings.MaxNumberOfAchievementLevels?
(jAlert(this.settings.Terms.YouCannotAddMoreThanXDescriptors),!1):b}return!0};a.prototype.checkOnMove=function(a){if(a.np[0]!=a.op[0]){var b=this.extractType(a.np[0].className),d=this.extractType(a.o[0].className);if(!b||!d||!this.checkIfTransitionAllowed(b,d)||this.findParentWithType(a.np[0],this.settings.TreeTypeSubject,!0)!=this.findParentWithType(a.o[0],this.settings.TreeTypeSubject,!1))return!1}return!0};return a}();e.LearningObjectiveRepository=d})(e.LearningObjectiveRepository||(e.LearningObjectiveRepository=
{}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){var c=this;this.checkAsyncTaskStatusTimeoutMilliseconds=5E3;this.selectedPersonIds=[];e.AssessmentLettersInstance=this;this.settings=a;this.controls=b;this.letterGroupGridRowsContainer=this.controls.letterGroupGridInstance.getRowsContainer();this.letterGroupGridRows=this.controls.letterGroupGridInstance.getRows();this.letterGroupGridRowsContainer.on("click",CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupDownloadLink),
function(){$.ajax({type:"POST",url:c.settings.ServiceUrlsModel.AddKpiOnDownloadLetterGroupPdf,data:{isViewerRoleHeadteacher:c.settings.IsViewerRoleHeadteacher}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})});this.controls.createLetterGroupButton.click(this.openCreateLetterGroupPopup);this.scheduleCheckExportToPdfAsyncTaskStatus();this.scheduleCheckLettersGeneratedAsyncTaskStatus();this.settings.IsScrollToGroupLettersFeedbackControlNeeded&&this.scrollToGroupLettersFeedback()}d.prototype.openViewRecipientsDialog=
function(a,b,c){a=window[e.AssessmentLettersInstance.settings.ClientInstanceNames.ViewRecipientsDialogInstance];c=CCL.CommonFunctions.formatString(e.AssessmentLettersInstance.settings.LanguageTerms.RecipientsFor,c);a.setTitle(c);a.setAjaxUrl(e.AssessmentLettersInstance.settings.ServiceUrlsModel.GetLetterGroupRecipients,{letterGroupId:b,isViewerRoleHeadteacher:e.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher},!1);a.openDialog(!1)};d.prototype.publishLetterGroupAction=function(a,b,c){var d=
this,e={letterGroupId:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher};$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.PublishLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(a){a&&d.postJsonToService(d.settings.ServiceUrlsModel.PublishLetterGroup,e).done(function(a){window.location=window.location})})};d.prototype.deleteLetterGroupAction=function(a){$.alerts.okButton=
this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.DeleteLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(b){b&&a()})};d.prototype.exportToPdfLetterGroupAction=function(a,b){$(a).attr("disabled")||b()};d.prototype.openCreateLetterGroupPopup=function(){var a=window[e.AssessmentLettersInstance.settings.ClientInstanceNames.CreateLetterPopupInstance],b=[],c=e.AssessmentLettersInstance.controls.learnersGridInstance.GetSelectedValues();
c&&0<c.length&&(b=c.substr(0,c.length-1).split(","));0===b.length?jAlert(e.AssessmentLettersInstance.settings.LanguageTerms.SelectAtLeastOneLearner,e.AssessmentLettersInstance.settings.LanguageTerms.AlertTitle,null):0===$(b).not(e.AssessmentLettersInstance.selectedPersonIds).length&&0===$(e.AssessmentLettersInstance.selectedPersonIds).not(b).length?a.openDialog():$.ajax({type:"POST",url:e.AssessmentLettersInstance.settings.ServiceUrlsModel.GetCreateLetterGroupPopupTitle,traditional:!0,data:{personIds:b,
termName:e.AssessmentLettersInstance.settings.TermName,isViewerRoleHeadteacher:e.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher}}).done(function(c){e.AssessmentLettersInstance.selectedPersonIds=b;a.setAboutHtml(c);a.openDialog()}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};d.prototype.scheduleCheckExportToPdfAsyncTaskStatus=function(){var a=this;setTimeout(function(){a.checkExportToPdfAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};d.prototype.checkExportToPdfAsyncTaskStatus=
function(){var a=this,b=[];this.controls.letterGroupGridInstance.getRows().each(function(a,d){b.push($(d).data("id"))});0<b.length&&$.ajax({type:"POST",url:this.settings.ServiceUrlsModel.GetLetterGroupsFeedback,traditional:!0,data:{letterGroupIds:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(c){var d=window[a.settings.ClientInstanceNames.GroupLettersTasksStatusFeedbackInstance];c=$(c);var e=c.attr(a.settings.DataAttributes.FeedbackProgress);e!==a.settings.DataAttributes.FeedbackProgressValueWait&&
e!==a.settings.DataAttributes.FeedbackProgressValueOk&&e!==a.settings.DataAttributes.FeedbackProgressValueError||d.showMessage(e===a.settings.DataAttributes.FeedbackProgressValueError?CCL.FeedbackType.Error:CCL.FeedbackType.Information,c.html());e!==a.settings.DataAttributes.FeedbackProgressValueOk&&e!==a.settings.DataAttributes.FeedbackProgressValueError||a.deleteLetterGroupAsyncTaskExportAsPdf();e===a.settings.DataAttributes.FeedbackProgressValueOk&&a.injectLetterGroupDownloadLinks(b);a.scheduleCheckExportToPdfAsyncTaskStatus()}).fail(function(a,
b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.scheduleCheckLettersGeneratedAsyncTaskStatus=function(){var a=this;0<this.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&setInterval(function(){a.checkLettersGeneratedAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};d.prototype.checkLettersGeneratedAsyncTaskStatus=function(){var a=this,b=[];this.controls.letterGroupGridInstance.getRows().each(function(c,
d){0<$(d).find(CCL.CommonFunctions.formatString(".{0}",a.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&b.push($(d).data("id"))});0<b.length&&this.postJsonToService(this.settings.ServiceUrlsModel.GetGenerateLettersJobStatus,{letterGroupIds:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(a){var b=!1;a.forEach(function(a){a.IsLetterGroupBusy||(b=!0)});b&&(window.location=window.location)})};d.prototype.publishLetterGroups=function(a,b){this.postJsonToService(this.settings.ServiceUrlsModel.PublishLetterGroup,
{letterGroupIds:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(){b()})};d.prototype.deleteLetterGroupAsyncTaskExportAsPdf=function(){this.postJsonToService(this.settings.ServiceUrlsModel.DeleteLetterGroupAsyncTaskExportAsPdf,{isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher})};d.prototype.injectLetterGroupDownloadLinks=function(a){var b=this;$.ajax({type:"POST",url:this.settings.ServiceUrlsModel.GetLetterGroupDownloadLinks,traditional:!0,data:{letterGroupIds:a,
isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(a){$(a).children().each(function(a,c){a=$(c);c=b.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString("[{0}='{1}'] ",b.settings.DataAttributes.LetterGroupDownloadLink,a.attr(b.settings.DataAttributes.LetterGroupDownloadLink)));0<c.length&&c.replaceWith(a)})}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.postJsonToService=function(a,b){return $.ajax({type:"POST",dataType:"JSON",
traditional:!0,url:a,data:b}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.scrollToGroupLettersFeedback=function(){$("html, body").animate({scrollTop:this.controls.groupLettersGridLabel.offset().top},1E3)};return d}();e.AssessmentLetters=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(){function a(a,b){this.PlanId=a;this.ColumnId=b}a.distinctArray=function(a){return a.reduce(function(a,b){0===a.filter(function(a){return b.PlanId===a.PlanId&&b.ColumnId===a.ColumnId}).length&&a.push(b);return a},[])};return a}();a.PlannerCell=b;var c=function(a){function c(b,f){a.call(this,f,e.Planner.getInstance().settings.CourseId);this._planElementMovingDisabled=!1;window[b]=this;c.instanceName=b;this._css=f.Css;this._terms=
f.Terms;this._elementColumnIds=f.ElementColumnIds;this._planner=e.Planner.getInstance();this._activateElementsByPlan=this._planner.settings.ActivateElementsByPlan;this._planExpandableContentCellCommonLogic=d.PlanExpandableContentCellCommonLogic.getInstance();b=top;this._activateElementsByPlan&&b.reloadFolder&&b.reloadFolder("item0","planner",!0);this.attachEvents()}__extends(c,a);c.prototype.refreshResourcesCell=function(a,b,c){this.refreshActivityResourceCell(a,b,!0,!0,!1);c&&this.measureKpiEditPlan()};
c.getPlanActivityResourceCellInstance=function(){return window[c.instanceName]};c.onFileUploadSuccess=function(a){c.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};c.onFileUploadFailed=function(a,b){c.getPlanActivityResourceCellInstance().onFileUploadFailed(a,b)};c.onFileSelected=function(a){c.getPlanActivityResourceCellInstance().onFileSelected(a)};c.getActivityResourceListItemSelector=function(){return"."+c.getPlanActivityResourceCellInstance()._css.ActivityResourceListItem};c.prototype.refreshActivityResourceCell=
function(a,b,c,d,e){void 0===d&&(d=!0);this.reloadPlanElements(a,b,d,c,e)};c.prototype.updateContent=function(a,b,c,d,f){var g=this;b=this.getActivityResourceCell(b,c);b.html(a);a=top;d&&a.reloadFolder&&a.reloadFolder("item0","planner",f,!0);if(this._activateElementsByPlan){d=b.find("."+this._css.ActivityResourceListItem);var h=this._planner.getContainer();0<d.length&&d.each(function(a,b){var c=$(b);a=c.find("."+g._css.ActivityResourceListItemLink).first();b=c.data(g._planner.data.ElementId);void 0==
b||0>=a.length||(a=h.find("."+g._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(g._planner.data.ElementId,b)),0<a.length&&a.each(function(){var a=$(this),b=c.clone();a.replaceWith(b)}))})}this.initDragAndDrop(e.Cards.TopicCard.getParentTopicCardContainer(b))};c.prototype.initDragAndDrop=function(a){var b=this;null==a&&(a=e.Cards.TopicCard.getAllTopicCardContainers());a.each(function(a,c){var d=$(c);b._elementColumnIds.forEach(function(a){a=d.find("."+b._css.ActivityResourceCell+
CCL.CommonFunctions.getDataSelector(b._planner.data.ColumnId,a)+" > ul");b.setDragAndDrop(a)})})};c.prototype.reloadPlanElements=function(a,b,c,d,e){var f=this;this._planElementMovingDisabled=!0;void 0==e&&(e=!this.getActivityResourceCell(a,b).find("."+this._planExpandableContentCellCommonLogic.css.ExpanderLink).hasClass(this._planExpandableContentCellCommonLogic.css.ExpanderLinkExpanded));$.get(this.settings.WebMethods.ReloadPlanElements,$.param({courseId:this.courseId,planId:a,columnId:b,showCollapsedList:e})).done(function(e){f.updateContent(e,
a,b,c,d);f._planElementMovingDisabled=!1}).fail(function(){return f._planElementMovingDisabled=!1})};c.prototype.removeElementFromPlan=function(b){var c=this,d=this.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ElementId),f=this.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.PlanId),g=this.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ColumnId);a.prototype.deletePlanElement.call(this,f,d,!1).done(function(){c.refreshActivityResourceCell(f,
g,!1,!1);c.measureKpiEditPlan()})};c.prototype.deleteElementFromCourse=function(c){var d=this,f=this.getDataAttributeValueAsNumber(c,e.PlannerConstants.dataAttributes.ElementId);c=this.getDataAttributeValueAsNumber(c,e.PlannerConstants.dataAttributes.PlanId);a.prototype.deletePlanElement.call(this,c,f,!0).done(function(){var a=top;a.reloadFolder&&a.reloadFolder("item0","planner");a=d.findCellsToRefresh(f);b.distinctArray(a).forEach(function(a){d.refreshActivityResourceCell(a.PlanId,a.ColumnId,!1,
!1)});d.measureKpiEditPlan()})};c.prototype.getActivityResourceCell=function(a,b){return $("."+this._css.ActivityResourceCell+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).closest("."+this._planner.getPlannerCellCssClass())};c.prototype.getActivityResourceList=function(a,b){return this.getActivityResourceCell(a,b).find("ul")};c.prototype.findCellsToRefresh=function(a){var c=this,d=[];this._planner.getContainer().find("."+
this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,a)).each(function(a,e){e=$(e);a=e.data(c._planner.data.PlanId);e=e.data(c._planner.data.ColumnId);d.push(new b(a,e))});this.getChildElementIds(a).forEach(function(a){d=$.merge(d,c.findCellsToRefresh(a))});return d};c.prototype.getChildElementIds=function(a){var b=this,c=[];this._planner.getContainer().find("."+this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ParentFolderId,
a)).each(function(a,d){a=$(d).data(b._planner.data.ElementId);-1===c.indexOf(a)&&c.push(a)});return c};c.prototype.swapPlanElements=function(a,b,c,d){var e=this;$.post(this.settings.WebMethods.SwapPlanElements,$.param({courseId:this.courseId,elementId1:b,elementId2:c,planId:a,columnId:d})).done(function(){e.reloadPlanElements(a,d,!1,!1)})};c.prototype.movePlanElement=function(a,b,c,d,e){var f=this;this._planElementMovingDisabled=!0;$.post(this.settings.WebMethods.MovePlanElement,$.param({courseId:this.courseId,
sourcePlanId:a,targetPlanId:b,elementId:c,columnId:d,elementIds:e},!0)).done(function(){a!==b&&(f.refreshActivityResourceCell(a,d,!1),f.refreshActivityResourceCell(b,d,f._planner.settings.ActivateElementsByPlan));f._planElementMovingDisabled=!1}).fail(function(){f.refreshActivityResourceCell(a,d,!1);a!==b&&f.refreshActivityResourceCell(b,d,!1);f._planElementMovingDisabled=!1})};c.prototype.moveElementToPlan=function(a,b,c,d){var e=this;$.post(this.settings.WebMethods.MoveElementToPlan,$.param({courseId:this.courseId,
elementId:c,sourcePlanId:a,targetPlanId:b,columnId:d})).done(function(c){c&&(e.refreshActivityResourceCell(a,d,!1),e.refreshActivityResourceCell(b,d,e._planner.settings.ActivateElementsByPlan))})};c.prototype.getPrevElementId=function(a,b,c){var d=this,e=null,f=this.getActivityResourceCell(a,c).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,c){c=$(c);var g=f.eq(a-1);c.data(d._planner.data.ElementId)==b&&0<a&&(e=g.data(d._planner.data.ElementId))});return e};c.prototype.getNextElementId=
function(a,b,c){var d=this,e=null,f=this.getActivityResourceCell(a,c).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,c){c=$(c);var g=f.eq(a+1);c.data(d._planner.data.ElementId)==b&&a<f.length-1&&(e=g.data(d._planner.data.ElementId))});return e};c.prototype.getNextPlanId=function(a,b){var c=null,d=e.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(d,function(b,e){if(e===a)return b<d.length-1&&(c=d[b+1]),!1});return c};c.prototype.getPrevPlanId=
function(a,b){var c=null,d=e.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(d,function(b,e){if(e===a)return 0<b&&(c=d[b-1]),!1});return c};c.prototype.updateMoveOptions=function(a,b){if(a.length){var c=a.data(this._planner.data.ElementId),d=a.data(this._planner.data.ColumnId);a=a.data(this._planner.data.PlanId);var e="data-"+this._planner.data.PlanId,f=this.getActionLink(this._css.MoveUpResourceLink,c,d,b),g=this.getActionLink(this._css.MoveDownResourceLink,
c,d,b),h=this.getActionLink(this._css.MoveResourceToPrevPlanLink,c,d,b),l=this.getActionLink(this._css.MoveResourceToNextPlanLink,c,d,b),k=this.getActionLink(this._css.RemoveFromPlanLink,c,d,b);b=this.getActionLink(this._css.DeleteFromCourseLink,c,d,b);f.attr(e,a);g.attr(e,a);h.attr(e,a);l.attr(e,a);k.attr(e,a);b.attr(e,a)}};c.prototype.hideMoveOptionsIfNecessary=function(a){if(a.length){var b=a.siblings("."+this._css.ActivityResourceListItem),c=b.data(this._planner.data.ElementId);a=b.data(this._planner.data.ColumnId);
var d=b.data(this._planner.data.PlanId),e=this.getActionLink(this._css.MoveUpResourceLink,c,a,d).closest("li"),f=this.getActionLink(this._css.MoveDownResourceLink,c,a,d).closest("li"),g=this.getActionLink(this._css.MoveResourceToPrevPlanLink,c,a,d).closest("li");b=this.getActionLink(this._css.MoveResourceToNextPlanLink,c,a,d).closest("li");var h=this.getPrevElementId(d,c,a);e.toggle(null!=h);c=this.getNextElementId(d,c,a);f.toggle(null!=c);c=this.getPrevPlanId(d,a);g.toggle(null!=c);a=this.getNextPlanId(d,
a);b.toggle(null!=a)}};c.prototype.getActionLink=function(a,b,c,d){return $("."+a+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,c)+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,d))};c.prototype.setDragAndDrop=function(a){var b=this;a.each(function(c,d){c=$(d);if(null!=c.sortable("instance"))return c.sortable("option","connectWith",a),!0;c.sortable({connectWith:a,axis:"y",scroll:!0,scrollSensitivity:50,
scrollSpeed:10,handle:"."+b._planner.css.ReorderDragHandler,cursor:"move",dropOnEmpty:!0,items:"."+b.settings.Css.ElementListItem,containment:e.Cards.TopicCard.getParentTopicCard(c).getPlanGrid().getRowsContainer()});c.on("sortstart",function(a,b){b.item.data("oldIndexValue",b.item.index())});c.on("sortreceive",function(a,c){var d=$(c.item).find("."+b._css.ActivityResourceListItem),e=d.data(b._planner.data.ElementId);b._planElementMovingDisabled?c.sender.sortable("cancel"):$(a.target).find("."+b._css.ActivityResourceListItem).each(function(a,
f){if(f==d[0])return!0;if($(f).data(b._planner.data.ElementId)==e)return c.sender.sortable("cancel"),!1})});c.on("sortstop",function(a,c){var d=parseInt(c.item.index(),10),f=parseInt(c.item.data("oldIndexValue"),10),g=$(c.item),h=g.find("."+b._css.ActivityResourceListItem),k=h.data(b._planner.data.PlanId),l=h.data(b._planner.data.ColumnId),m=h.data(b._planner.data.ElementId),q=e.Cards.TopicCard.getParentPlanContainer(h).data(b._planner.data.GridRowId);if(k!==q||f!==d){var p=[];g.parent().find("."+
b._css.ActivityResourceListItem).each(function(a,c){a=$(c);l===a.data(b._planner.data.ColumnId)&&(a=a.data(b._planner.data.ElementId),p.push(a))});b._planElementMovingDisabled?(a=null!=c.sender?c.sender:$(a.currentTarget),null!=a&&a.sortable("cancel")):(b.movePlanElement(k,q,m,l,p),h.attr("data-"+b._planner.data.PlanId,q),h.data(b._planner.data.PlanId,q),b.updateMoveOptions(h,k))}})})};c.prototype.getLearningObjectiveIds=function(a,b){var c=d.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance();
return c?c.getLearningObjectiveIds(a,b):[]};c.prototype.measureKpiEditPlan=function(){this._planner.measureEditPlan()};c.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click","."+this._css.DeleteFromCourseLink,function(b){var c=$(b.currentTarget);$.alerts.okButton=a._planner.terms.Yes;$.alerts.cancelButton=a._planner.terms.No;jConfirm(a._terms.DeleteFromCourseConfirmation,a._planner.terms.ConfirmTitle,function(b){b&&a.deleteElementFromCourse(c)})}).on("click","."+this._css.MoveUpResourceLink,
function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var e=a.getPrevElementId(b,c,d);e&&a.swapPlanElements(b,c,e,d)}).on("click","."+this._css.MoveDownResourceLink,function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=
a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var e=a.getNextElementId(b,c,d);e&&a.swapPlanElements(b,c,e,d)}).on("click","."+this._css.MoveResourceToNextPlanLink,function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var e=a.getNextPlanId(c,d);e&&a.moveElementToPlan(c,e,b,d)}).on("click","."+this._css.MoveResourceToPrevPlanLink,
function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var e=a.getPrevPlanId(c,d);e&&a.moveElementToPlan(c,e,b,d)}).on("click","."+this._css.ActionLink,function(b){a.hideMoveOptionsIfNecessary($(b.currentTarget))}).on(this._planner.events.PlanActivityResourceCellOutdated,function(b,c){null!=c&&a._elementColumnIds.forEach(function(b){a.refreshActivityResourceCell(c.planId,
b,!1,a._activateElementsByPlan)})})};c.prototype.getLibraryBrowserDialog=function(){return this._planner.getLibraryBrowserDialog()};c.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.GridRowId)};c.prototype.getColumnId=function(a){a=a.closest("."+this._planner.getPlannerCellCssClass()).find("."+this.settings.Css.ActivityResourceCell);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId)};
c.prototype.getElementDialogOffset=function(){return-15};c.prototype.getFolderId=function(a){return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.FolderId)};return c}(a.PlanResourcesCellBase);a.PlanActivityResourceCell=c})(d.ResourcesCell||(d.ResourcesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(c,d){var f=this;a.call(this,d);window[c]=this;b.instanceName=c;this.planner=e.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.showDates=this.planner.settings.ShowDates;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;$(function(){f.attachEvents()})}__extends(b,a);b.getPlanDateCellInstance=function(){return window[b.instanceName]};
b.prototype.updateContent=function(a,b,c){this.getDateCell(b).replaceWith(a);a=[{planId:b,planActive:c}];$(document).trigger(e.PlannerConstants.events.PlanActivationChanged,{planActivations:a})};b.prototype.updatePlanTimeSpan=function(a){var b=this,c=this.getDatePicker();$.post(this.settings.WebMethods.UpdatePlanTimeSpan,$.param({courseId:this.courseId,planId:a,start:c.getStartDate(),stop:c.getStopDate(),showPlanDates:this.showDates},!0),function(a){if(a){b.closeDatePicker();b.refreshDatesCell(a);
var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.TimeSpan)}).fail(function(){c.showErrorMsg(e.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,c=this.getDatePicker();$.post(this.settings.WebMethods.UpdatePlanWeekAndDay,$.param({courseId:this.courseId,planId:a,start:c.getStartWeek(),stop:c.getStopWeek(),showPlanDates:this.showDates},!0),function(a){if(a){b.closeDatePicker();b.refreshDatesCell(a);
var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.WeekAndDay)}).fail(function(){c.showErrorMsg(e.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,c=this.getDatePicker(),d=c.getEvents();$.post(this.settings.WebMethods.UpdatePlanEvents,$.param({courseId:this.courseId,planId:a,activityIdsJson:JSON.stringify(d),filterStartDateTime:this.startDate,filterStopDateTime:this.endDate,showPlanDates:this.showDates},
!0),function(a){if(a){b.closeDatePicker();b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.Event)}).fail(function(){c.showErrorMsg(e.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(a,b){b=b.data(e.PlannerConstants.dataAttributes.TopicId);e.Cards.TopicCard.setDefaultDate(a,b)};b.prototype.getCurrentPlanId=function(a){a=a.parent().find("input:hidden");return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId).toString(),
10)};b.prototype.openContextDialog=function(a){this.contextDialog.openDialog(a)};b.prototype.refreshDatesCell=function(a){this.updateContent(a.dateCell,a.planId,a.planActive);this.planner.settings.ActivateElementsByPlan&&$(document).trigger(e.PlannerConstants.events.PlanActivityResourceCellOutdated,{planId:a.planId})};b.prototype.getDateCell=function(a){return $("."+this.css.CellContent+" input:hidden"+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).closest("."+this.css.CellContent)};
b.prototype.attachEvents=function(){var a=this;$(document).on(e.PlannerConstants.events.PlanDateCellChange,function(b,c){void 0!=c.dateCellObject&&a.refreshDatesCell(c.dateCellObject)});$(document).on(e.PlannerConstants.events.PlanDateCellsChanged,function(b,c){void 0!=c.dateCellObjects&&$.each(c.dateCellObjects,function(b,c){a.getDateCell(c.PlanId).replaceWith(c.Content)})})};return b}(a.PlanDateCellBase);a.PlanDateCell=b})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells=
{}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(a){var b=function(a){function b(b,c){a.call(this,b,c,e.Planner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var c=this,d=b.data(e.PlannerConstants.dataAttributes.PlanId);b=b.data(e.PlannerConstants.dataAttributes.LearningObjectiveId);var f=!this.getLearningObjectivesListCell(d).find("."+this.settings.Css.ExpanderLink).hasClass(this.settings.Css.ExpanderLinkExpanded);a.prototype.removeLOFromPlan.call(this,
d,b,f).done(function(a){return c.updateContent(a,d)})};b.prototype.getCurrentPlanId=function(a){return a.data(e.PlannerConstants.dataAttributes.PlanId)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.LearningObjectivesList+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).closest("."+e.Planner.getInstance().getPlannerCellCssClass())};b.prototype.getLearningObjectiveIds=function(a,b){void 0===b&&(b=!1);var c=this.getLearningObjectivesListCell(a),
d=this.getLearningObjectiveDataAttribute(b);a=c.find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)+CCL.CommonFunctions.getDataSelector(d));var f=[];0<a.length&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(d))&&(a=parseInt(a.data(d).toString(),10),-1===$.inArray(a,f)&&f.push(a))});return f};return b}(a.PlanLearningObjectivesCellBase);a.PlanLearningObjectivesCell=b})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells=
{}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.RichText=0]="RichText";e[e.Theme=1]="Theme";e[e.Lesson=3]="Lesson";e[e.LessonDescription=4]="LessonDescription";e[e.Date=5]="Date";e[e.ClassHours=6]="ClassHours";e[e.LearningObjectives=7]="LearningObjectives";e[e.Resources=8]="Resources";e[e.Activities=9]="Activities";e[e.Term=10]="Term";e[e.Rubric=11]="Rubric";e[e.Elements=12]="Elements"})(e.ColumnType||(e.ColumnType={}));(function(e){e[e.Resource=0]="Resource";e[e.Activity=1]="Activity";e[e.LearningObjectiveAssessmentSupported=
2]="LearningObjectiveAssessmentSupported"})(e.ElementCategory||(e.ElementCategory={}));(function(e){e[e.TimeSpan=0]="TimeSpan";e[e.WeekAndDay=1]="WeekAndDay";e[e.Event=2]="Event"})(e.DatePickerMode||(e.DatePickerMode={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a,b){window[a]=this;d.instanceName=a;this.terms=b;this.planner=e.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;this.showPlanDates=this.planner.settings.ShowDates;this.useTopics=this.planner.settings.UseTopics;this.addingPlanInProgress=!1}d.getInstance=function(){return window[d.instanceName]};d.prototype.addPlan=function(a){var b=
this;if(!this.addingPlanInProgress){this.addingPlanInProgress=!0;this.planner.toggleEnableDisplayModeSwitcher(!1);var c=e.Cards.TopicCard.getInstance(a),d=c.getLastPlanId();d||(d=0);$.ajax({type:"POST",url:this.planner.webMethods.Plan.AddPlan,data:{courseId:this.courseId,topicId:a,start:this.startDate,end:this.endDate,insertAfterPlanId:d,showPlanDates:this.showPlanDates,currentDisplayMode:this.planner.currentDisplayMode},success:function(a){b.useTopics&&(c.getTopicExpanderLink().html(a.topicExpanderText),
c.hasPlans=a.hasPlans);c.appendNewPlan(a.planRow,a.planId);c.showPlanActionMenu();c.hidePlanMoveOptionsIfNecessary();b.planner.toggleEnableDisplayModeSwitcher(!0);b.addingPlanInProgress=!1},error:function(a,c,d){CCL.CommonFunctions.alertAjaxError(a,c,d);b.planner.toggleEnableDisplayModeSwitcher(!0);b.addingPlanInProgress=!1}})}};d.prototype.removePlan=function(a,b){this.removePlans(a,[b],!1)};d.prototype.removePlans=function(a,b,c){var d=this;void 0===b&&(b=null);void 0===c&&(c=!0);var f=e.Cards.TopicCard.getInstance(a);
c&&null==b&&(b=f.getSelectedPlanIds(!0));null!=b&&this.planner.showConfirmDialog(c?this.terms.DeletePlansConfirmation:this.terms.DeletePlanConfirmation,function(e){e&&$.ajax({type:"POST",url:d.planner.webMethods.Plan.RemovePlans,traditional:!0,data:{courseId:d.courseId,topicId:a,planIds:b,updatePlanCount:d.useTopics,start:d.startDate,end:d.endDate,showPlanDates:d.showPlanDates,isBulkAction:c},success:function(a){d.useTopics&&(f.getTopicExpanderLink().html(a.topicExpanderText),f.hasPlans=a.hasPlans);
f.showPlanFeedbackMessage(CCL.FeedbackType.Information,a.restoreText);f.clearPlanSelection();f.removePlansFromGrid(b,a.emptyGridText);f.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError})},this.planner.terms.Delete,this.planner.terms.Cancel)};d.prototype.restorePlans=function(a,b){var c=this,d=e.Cards.TopicCard.getInstance(a);$.ajax({type:"POST",url:this.planner.webMethods.Plan.RestorePlans,traditional:!0,data:{courseId:this.courseId,topicId:a,planIds:b,start:this.startDate,
end:this.endDate,updatePlanCount:this.useTopics,showPlanDates:this.showPlanDates},success:function(a){c.useTopics&&(d.getTopicExpanderLink().html(a.topicExpanderText),d.hasPlans=a.hasPlans);d.refreshPlanGrid(function(){a.restoredText&&d.showPlanFeedbackMessage(CCL.FeedbackType.Information,a.restoredText)})},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.togglePlanStatus=function(a,b,c){this.togglePlansStatus(a,c,[b],!1)};d.prototype.togglePlansStatus=function(a,b,c,d){var f=this;void 0===
c&&(c=null);void 0===d&&(d=!0);var g=e.Cards.TopicCard.getInstance(a);d&&null==c&&(c=g.getSelectedPlanIds(!0));if(null!=c){var k=function(a){$.ajax({type:"POST",url:f.planner.webMethods.Plan.TogglePlansStatus,traditional:!0,data:{courseId:f.courseId,planIds:c,activate:b,showPlanDates:f.showPlanDates,toggleElementsActivation:a,isBulkAction:d},success:function(a){1===c.length?g.showPlanFeedbackMessage(CCL.FeedbackType.Information,b?f.terms.PlanActivated:f.terms.PlanDeactivated):g.showPlanFeedbackMessage(CCL.FeedbackType.Information,
b?f.terms.PlansActivated:f.terms.PlansDeactivated);d&&g.clearPlanSelection();$.each(a,function(a,b){$(document).trigger(f.planner.events.PlanDateCellChange,{dateCellObject:b,planContainer:g.getPlanContainerById(b.planId)})})},error:CCL.CommonFunctions.alertAjaxError})};!b&&this.planner.settings.ActivateElementsByPlan&&g.containsPlanElements(c)?this.planner.showConfirmDialog(d?this.terms.PlansDeactivatedWithElementsWarning:this.terms.PlanDeactivatedWithElementsWarning,function(a){k(a)}):k(!0)}};d.prototype.notifyAboutChanges=
function(a){null!=a&&$.ajax({type:"POST",url:this.planner.webMethods.Plan.NotifyAboutChanges,data:{courseId:this.courseId,planId:a},success:function(){},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.movePlan=function(a,b,c){this.movePlans(a,c,[b])};d.prototype.movePlans=function(a,b,c){void 0===c&&(c=null);var d=e.Cards.TopicCard.getInstance(a);null==c&&(c=d.getSelectedPlanIds(!0));null!=c&&(c.length>=d.getPlanGrid().getRowsCount()||$.ajax({type:"POST",url:this.planner.webMethods.Plan.MovePlans,
traditional:!0,data:{courseId:this.courseId,topicId:a,planIds:c,moveUp:b,start:this.startDate,end:this.endDate},success:function(a){d.sortPlans(a.sortedPlanIds);d.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError}))};d.prototype.setPlanDates=function(a){var b=e.Cards.TopicCard.getInstance(a),c=b.getSelectedPlanIds(!0);null!=c&&this.planner.getSetDateDialog().open(c,function(a){b.updatePlanCellsCallback(a)},function(){b.clearPlanSelection()},a)};d.prototype.sharePlans=function(a){var b=
this,c=e.Cards.TopicCard.getInstance(a),d=c.getSelectedPlanIds(!0);null!=d&&$.ajax({type:"POST",url:this.planner.webMethods.ShareablePlanner.CheckPlanDataForSharing,traditional:!0,data:{courseId:this.courseId,planIds:d},success:function(a){a&&a.conflictMessage?jAlert(a.conflictMessage):a&&a.warningMessage?b.planner.showConfirmDialog(a.warningMessage,function(a){a&&c.redirectToSharePlans(d)}):c.redirectToSharePlans(d)},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.stopSharingPlan=function(a,
b,c){var d=this,f=e.Cards.TopicCard.getInstance(b);$.ajax({type:"POST",url:this.planner.webMethods.ShareablePlanner.StopSharingPlans,traditional:!0,data:{courseId:this.courseId,planIds:[c]},success:function(){d.planner.settings.UseTopics&&f&&f.clearPlanSelection();$(a).parent().hide()},error:CCL.CommonFunctions.alertAjaxError})};return d}();e.PlanCommonLogic=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(a){function b(b,c,d){var e=this;a.call(this,b,c);$(function(){e.columnsData=[];e.addColumnsToEdit(d)})}__extends(b,a);b.getInstance=function(){return window[d.PlannerInlineCellBase.clientInstanceName]};b.prototype.addColumnsToEdit=function(a){var c=this;$.each(a,function(a,d){c.columnsData[d.HybridEditorItemId]=d;(a=$("div["+e.PlannerConstants.dataAttributes.HybridEditorItem+"][id *= "+d.HybridEditorItemId+"]"))&&a.data(b.hybridEditorItemIdDataAttr,
d.HybridEditorItemId)})};b.prototype.getEditorItemSettings=function(b){return(b=this.columnsData[b])?a.prototype.getSettings.call(this,b):{}};b.prototype.measureKpiEditPlan=function(){e.Planner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){return this.columnsData[a.data(b.hybridEditorItemIdDataAttr).toString()]};b.prototype.replaceMediaContentWithPlaceholders=function(){return e.Planner.getInstance().isTableCurrentMode()};return b}(d.PlannerInlineCellBase);d.PlannerInlineCell=
a})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function a(a,c){var b=this;this.focusTitle=function(){b.$topicTitle.select()};window[a]=this;this.settings=c;this.planner=e.Planner.getInstance();this.$topicTitle=$("#"+this.settings.Controls.TopicTitleId);this.$errorMessage=$("#"+this.settings.Controls.ErrorMessageId);this.$saveButton=$("#"+this.settings.Controls.SaveButtonId);this.attachEventHandlers()}a.prototype.open=function(){var a=this,c=this.getDialog(),d=this.getColorPicker();this.clearForm();
$.post(this.settings.WebMethods.GetRandomColorSchemeFormNewTopic,{courseId:this.planner.settings.CourseId},function(a){d.setColor(a.topicColorSchema)}).fail(function(){d.setColor(a.settings.TopicDefaultColorSchema)});c.openDialog()};a.prototype.getColorPicker=function(){return window[this.settings.Controls.ColorPickerId]};a.prototype.attachEventHandlers=function(){var a=this;this.$saveButton.click(function(){return a.validateAndSave()});this.$topicTitle.keypress(function(b){return 13===b.keyCode?
(a.validateAndSave(),!1):!0})};a.prototype.clearForm=function(){this.$errorMessage.hide();this.$saveButton.toggleHyperlink(!0)};a.prototype.validateAndSave=function(){if(this.$saveButton.getIfHyperLinkEnabled()){var a=$.trim(this.$topicTitle.val());if(0<a.length){var c=this.getColorPicker().getSelectedColorKey();this.addTopic(a,c)}else this.$errorMessage.show()}};a.prototype.addTopic=function(a,c){var b=this;this.$saveButton.toggleHyperlink(!1);e.TopicCommonLogic.getInstance().addTopic(a,c,CssModal.closeDialog,
function(){b.$saveButton.toggleHyperlink(!0)})};a.prototype.getDialog=function(){return window[this.settings.TopicAddDialogInstan\u0441e]};return a}();f.TopicAddDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,d){window[b]=this;a.instanceName=b;this._settings=d;this._css=d.Css;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._currentColumnId=this._currentTopicId=0;this.attachEvents()}a.getTopicLearningObjectivesCellInstance=function(){return window[a.instanceName]};a.prototype.updateLearningObjectives=function(a){var b=this,c=this._currentTopicId,d=this._currentColumnId;$.post(this._planner.webMethods.LearningObjective.AddTopicLearningObjectives,
$.param({courseId:this._courseId,learningObjectiveIds:a,topicId:c,columnId:d},!0),function(a){b.getLearningObjectivesListCell(c,d).html(a)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getLearningObjectivesListCell=function(a,b){return $("."+this._css.CardCell+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).parent()};a.prototype.getLearningObjectiveIds=function(a,b,d){var c=this;a=a.find(CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,
b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,d)+CCL.CommonFunctions.getDataSelector(this._planner.data.LearningObjectiveId));var e=[];0<a.size()&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(c._planner.data.LearningObjectiveId))&&e.push(parseInt(a.data(c._planner.data.LearningObjectiveId)))});return e};a.prototype.removeLearningObjective=function(a,b,d){var c=this;$.post(this._planner.webMethods.LearningObjective.RemoveTopicLearningObjective,{courseId:this._courseId,topicId:a,
learningObjectiveId:d,columnId:b},function(d){c.getLearningObjectivesListCell(a,b).html(d)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this._planner.getContainer().on("click","."+this._css.AddLearningObjectivesLink,function(b){a._currentTopicId=$(b.currentTarget).data(a._planner.data.TopicId);a._currentColumnId=$(b.currentTarget).data(a._planner.data.ColumnId);b=window[a._settings.LearningObjectiveSelector];b.setSelectedIds(a.getLearningObjectiveIds(a.getLearningObjectivesListCell(a._currentTopicId,
a._currentColumnId),a._currentTopicId,a._currentColumnId),!0);b.openDialog()});$(document).on("click","."+this._css.RemoveLearningObjectiveLink,function(b){b=$(b.currentTarget);a.removeLearningObjective(b.data(a._planner.data.TopicId),b.data(a._planner.data.ColumnId),b.data(a._planner.data.LearningObjectiveId))})};return a}();d.TopicLearningObjectivesCell=a})(f.Topic||(f.Topic={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var a=function(){function a(b,d){window[b]=this;a.instanceName=b;this._settings=d;this._css=d.Css;this._terms=d.Terms;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._contextDialog=new ContextDialog($("#"+d.TermEditorId),{title:this._terms.TermContextDialogTitle,footerContent:d.TermEditorFooterId,setFocus:!1,width:"auto",zIndex:1});$.each($("."+this._css.TermRadioButton),function(a,b){$(b).find(":radio").attr("name",
"TermGroup")});this.attachEvents()}a.getTopicTermCellInstance=function(){return window[a.instanceName]};a.prototype.editTerm=function(a,b,d,e){this._currentTopicId=d;this._activeContainer=b.parent();this._contextDialog.openDialog(a);null!=e?$("."+this._css.TermRadioButton+CCL.CommonFunctions.getDataSelector(this._planner.data.CourseTermId,e)).find(":radio").attr("checked","checked").focus():($("."+this._css.TermRadioButton).find(":radio:checked").removeAttr("checked").blur(),$("."+this._css.TermRadioButton+
":first").find(":radio").focus())};a.prototype.attachEvents=function(){var a=this;this._contextDialog.setBeforeCloseDialog(function(){a.beforeCloseClontextDialog()});this._planner.getContainer().on("click","."+this._css.EditTermLink,function(b){var c=$(b.currentTarget),d=c.data(a._planner.data.TopicId),e=c.data(a._planner.data.CourseTermId);!a._contextDialog.mainContainer.is(":visible")&&0<d&&a.editTerm(b,c,d,e)});$("#"+this._settings.SaveTermButtonId).on("click",function(){a._contextDialog.closeDialog()});
$("#"+this._settings.ClearTermLinkId).on("click",function(){$("."+a._css.TermRadioButton).find(":radio:checked").removeAttr("checked")})};a.prototype.beforeCloseClontextDialog=function(){var a=this,b=$("."+this._css.EditTermLink+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,this._currentTopicId)).data(this._planner.data.CourseTermId),d=$("."+this._css.TermRadioButton).has(":radio:checked").data(this._planner.data.CourseTermId);b!==d&&$.post(this._planner.webMethods.TopicTerm.UpdateTopicTerm,
{courseId:this._courseId,topicId:this._currentTopicId,courseTermId:void 0!==d?d:0,start:this._planner.settings.FilterStartDate,stop:this._planner.settings.FilterEndDate},function(b){if(b){a._activeContainer.replaceWith(b.termCell);$(document).trigger(a._planner.events.PlanDateCellsChanged,{dateCellObjects:b.dateCells});var c=e.Cards.TopicCard.getInstance(a._currentTopicId);c&&c.setTermDates(a._planner.parseDateFromString(b.termStartDate),a._planner.parseDateFromString(b.termStopDate))}})};return a}();
d.TopicTermCell=a})(f.Topic||(f.Topic={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){e.mentorFeedbackOverviewInstance=this;this.context=a;this.$window=$(window);this.setMentorFeedbackSelectorAction();this.setCompleteButtonAction();this.setUndoButtonAction();this.context.Settings.IsToolbarButtonsAvailable?(this.setfeedbackSetupAction(),this.setMultipleAssessAction()):(window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+this.context.Controls.FeedbackSetupButtonId)),window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+
this.context.Controls.AssessMultipleButtonId)));a=$("."+this.context.CssClasses.HybridEditorItemCss);this.bindToEditorItemEvents(a);window[this.context.Controls.PersonGrid].toggleSelectAll(!1)}d.prototype.onSetFeedbackColumnValueError=function(a,b){b=b.xhrObject.status;CCL.CommonFunctions.jAlertAjaxError(409===b?this.context.LanguageTerms.AlertMessage:this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,409===b);a.stopPropagation()};d.prototype.bindToEditorItemEvents=
function(a){var b=this;a.on(this.context.Events.HybridEditorItemAjaxError,function(a,d){b.onSetFeedbackColumnValueError(a,d)}).on(this.context.Events.HybridEditorItemSaveError,function(a,d){b.onSetFeedbackColumnValueError(a,d)})};d.prototype.checkLogAvailability=function(a){var b=window[e.mentorFeedbackOverviewInstance.context.Controls.PersonGrid].getRowById(a);b=$("."+e.mentorFeedbackOverviewInstance.context.CssClasses.MentorFeedbackSelectorCss,b).attr(e.mentorFeedbackOverviewInstance.context.Settings.MentorFeedbackIdAttribute);
e.mentorFeedbackOverviewInstance.ajaxHandler(e.mentorFeedbackOverviewInstance.context.WebMethods.LogAvailability,{mentorFeedbackId:b},function(b){e.mentorFeedbackOverviewInstance.toggleLogLink(b.available,a)})};d.prototype.setfeedbackSetupAction=function(){var a=this;$("#"+this.context.Controls.FeedbackSetupButtonId).click(function(){return a.isAnyStudentSelected(function(b){for(var c,d="",e=0;e<b.length;e++){var f=a.getLearnerMentorFeedbackId(b[e]);if(0===e)c=f;else if(c!==f){d=a.context.LanguageTerms.DifferentMfConfirmation;
break}}var k=a.context.Urls.FeedbackSetupDialogUrl+"&"+a.context.Settings.PersonIdAttribute+"="+b.join(",");""!==d?jConfirm(d,a.context.LanguageTerms.PleaseConfirm,function(b){b&&a.openDialog(k,a.context.Controls.FeedbackSetupDialog)}):a.openDialog(k,a.context.Controls.FeedbackSetupDialog)})})};d.prototype.setMultipleAssessAction=function(){var a=this;$("#"+this.context.Controls.AssessMultipleButtonId).click(function(){return a.isAnyStudentSelected(function(b){for(var c=0,d=a.context.LanguageTerms.WarningNoMfSelected,
e=0;e<b.length;e++){var f=a.getLearnerMentorFeedbackId(b[e]);if(0!==f){if(0!==c&&c!==f){d=a.context.LanguageTerms.WarningDifferentMfSelected;break}c=f;d=""}}""!==d?jAlert(d,a.context.LanguageTerms.AlertTitle,null):(b=a.context.Urls.AssessMultipleDialogUrl+"&"+a.context.Settings.TermAssessmentAttributeId+"="+c+"&"+a.context.Settings.PersonIdAttribute+"="+b.join(","),a.openDialog(b,a.context.Controls.AssesMultipleDialog))})})};d.prototype.openDialog=function(a,b){window[b].setIframeUrl(a);window[b].openDialog()};
d.prototype.isAnyStudentSelected=function(a){var b=window[this.context.Controls.PersonGrid].getSelectedValues();0===b.length?jAlert(this.context.LanguageTerms.AlertNoPersonSelected,this.context.LanguageTerms.AlertTitle,null):a(b)};d.prototype.getLearnerMentorFeedbackId=function(a){return+$("select["+this.context.Settings.LearnerIdAttribute+"='"+a+"']").val()};d.prototype.setCompleteButtonAction=function(){var a=this;$("#"+this.context.Controls.CompleteTermButtonId).click(function(){jConfirm(a.context.LanguageTerms.CompleteTermWarning,
a.context.LanguageTerms.PleaseConfirm,function(b){b&&a.ajaxHandler(a.context.WebMethods.CompleteTerm,{organizationId:a.context.Settings.OrganizationId,termId:a.context.Settings.TermId},function(){$("#"+a.context.Controls.CompleteContainer).hide();$("#"+a.context.Controls.UndoContainer).show()})})})};d.prototype.setUndoButtonAction=function(){var a=this;$("#"+this.context.Controls.UndoCompleteTermButtonId).click(function(){a.ajaxHandler(a.context.WebMethods.UndoCompleteTerm,{organizationId:a.context.Settings.OrganizationId,
termId:a.context.Settings.TermId},function(){$("#"+a.context.Controls.UndoContainer).hide();$("#"+a.context.Controls.CompleteContainer).show()})})};d.prototype.ajaxHandler=function(a,b,c){var d=this;this.errorRised=!1;$.ajax({type:"POST",url:a,dataType:"json",data:b,success:c,error:function(a){return d.ajaxErrorHandler(a)}})};d.prototype.ajaxErrorHandler=function(a){this.errorRised||(this.errorRised=!0,409===a.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertMessage,this.context.LanguageTerms.AlertTitle,
this.context.LanguageTerms.Ok,!0):0===a.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!1):CCL.CommonFunctions.alertAjaxError(a,null,null))};d.prototype.setMentorFeedbackSelectorAction=function(){var a=this;$("."+this.context.CssClasses.MentorFeedbackSelectorCss).focus(function(b){return a.feedbackSetupPreviousValue=$(b.target).val()}).change(function(b){var c=$(b.target).attr(a.context.Settings.LearnerIdAttribute);
a.ajaxHandler(a.context.WebMethods.IsMentorFeedbackValuesExist,{learnerId:c,organisationId:a.context.Settings.OrganizationId,hierarchyId:a.context.Settings.HierarchyId,termId:a.context.Settings.TermId},function(c){c.result?jConfirm(a.context.LanguageTerms.ChangeFeedbackSetupWarning,a.context.LanguageTerms.PleaseConfirm,function(c){c?a.changeMentorSetup(b):$(b.target).val(a.feedbackSetupPreviousValue)}):a.changeMentorSetup(b)})})};d.prototype.changeMentorSetup=function(a){var b=this,c=$(a.target),
d=c.attr(this.context.Settings.LearnerIdAttribute),e=$("."+d),f=c.val();this.toggleLogLink(!1,d);if(f===this.context.Settings.DefaultMentorFeedbackSelectorValue)a=c.attr(this.context.Settings.MentorFeedbackIdAttribute),this.ajaxHandler(this.context.WebMethods.RemoveFeedbackSetup,{mentorFeedbackId:a,learnerId:d,organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId},function(){e.addClass(b.context.CssClasses.HiddenCss);$("."+b.context.CssClasses.CommentLabelCss,
e).text("");for(var a=$("."+b.context.CssClasses.HybridEditorItemCss,e),d=0;d<a.length;d++){var f=$(a[d]);f.hybridEditorItem().hybridEditorItem("resetValue");f.hybridEditorItem().hybridEditorItem("setToolTip","");var g=f.hybridEditorItem().hybridEditorItem("option","webMethodParams");g.mentorFeedbackId="";g.columnId="";f.hybridEditorItem().hybridEditorItem("option","webMethodParams",g)}$("."+b.context.CssClasses.CommentPanelCss,e).addClass(b.context.CssClasses.HiddenCss);c.attr(b.context.Settings.MentorFeedbackIdAttribute,
"")});else{var k=c.attr(this.context.Settings.LearnerNameAttribute);this.ajaxHandler(this.context.WebMethods.SetFeedbackSetup,{organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId,learnerId:d,termAssessmentId:f},function(a){c.attr(b.context.Settings.MentorFeedbackIdAttribute,a.mentorFeedbackId);e.removeClass(b.context.CssClasses.HiddenCss);var g=b.context.TermAssessmentCustomColumns[f],h=$("."+b.context.CssClasses.CommentLabelCss,e),l=$("."+b.context.CssClasses.HybridEditorItemCss,
e),m=$("."+b.context.CssClasses.CommentPanelCss,e);b.setUrlToLogLink(a.mentorFeedbackId,d);for(var q,t,u=0;u<g.length;u++)$(h[u]).text(g[u].Name),t=$(l[u]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",g[u].ToolTip+" "+k),q=t.hybridEditorItem().hybridEditorItem("option","webMethodParams"),q.mentorFeedbackId=a.mentorFeedbackId,q.columnId=String(g[u].CustomColumnId),t.hybridEditorItem().hybridEditorItem("option","webMethodParams",q),$(m[u]).removeClass(b.context.CssClasses.HiddenCss);
if(g.length<h.length)for(a=h.length,g=g.length;g<a;g++)$(h[g]).text(""),t=$(l[g]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",""),q=t.hybridEditorItem().hybridEditorItem("option","webMethodParams"),q.mentorFeedbackId="",q.columnId="",t.hybridEditorItem().hybridEditorItem("option","webMethodParams",q),$(m[g]).addClass(b.context.CssClasses.HiddenCss)})}};d.prototype.setUrlToLogLink=function(a,b){var c=window[this.context.Controls.PersonGrid].getRowById(b);
$("."+this.context.CssClasses.LogLinkCss,c).attr("href",this.context.Urls.LogLink+"?"+this.context.Settings.PersonIdAttribute+"="+b+"&"+this.context.Settings.SupervisorTypeRequestItem+"="+this.context.Settings.SupervisorType+"&"+this.context.Settings.MentorFeedbackIdRequestItem+"="+a)};d.prototype.toggleLogLink=function(a,b){var c=window[this.context.Controls.PersonGrid].getRowById(b);b=$("."+this.context.CssClasses.LogLinkCss,c);c=$("."+this.context.CssClasses.NoLogLabelCss,c);a?(b.removeClass(this.context.CssClasses.HiddenCss),
c.addClass(this.context.CssClasses.HiddenCss)):(b.addClass(this.context.CssClasses.HiddenCss),c.removeClass(this.context.CssClasses.HiddenCss))};return d}();e.MentorFeedbackOverview=f})(f.Mentor||(f.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(a){e.mentorFeedbackAssessMultipleInstance=this;this.context=a;this.window=$(window);this.setOkClickEvent()}d.prototype.setOkClickEvent=function(){var a=this;$("#"+this.context.Settings.OkClientId).click(function(){for(var b="",c=$('[id*="CustomColumnValue"]'),d=0;d<c.length;d++){var e=$(c[d]);e.val().trim()&&(e=e.attr("data-cc-id"),-1<a.context.Settings.FilledCustomColumns.indexOf(e)&&(b=a.context.Settings.TermCommentWarning))}""!==b?jConfirm(b,
a.context.Settings.TermPleaseConfirm,function(b){b&&a.context.Functions.OkPostbackScript()}):a.context.Functions.OkPostbackScript()})};return d}();e.MentorFeedbackAssessMultiple=f})(f.Mentor||(f.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(a){a[a.Expanded=1]="Expanded";a[a.Collapsed=2]="Collapsed";a[a.Loading=3]="Loading"})(e.FolderExpandState||(e.FolderExpandState={}));var k=e.FolderExpandState,d=function(){function a(a,c,d){var b=this;this.settings=c;this.controls=d;this.inputTypeCheckboxSelector="input:checkbox";this.stateChangedHandler=function(a,c){a=b.closestItem($(a.target));c=b.updateItemState(a,c.Checked);a.find(b.inputTypeCheckboxSelector).first().focus();b.controls.Container.trigger(b.settings.StateChangedEventName,
c)};window[a]=this;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler()}Object.defineProperty(a.prototype,"itemSelector",{get:function(){return CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"listItemFocusedAreaSelector",{get:function(){return"."+this.settings.CssClasses.ListItemFocusedArea},enumerable:!0,configurable:!0});a.prototype.init=function(a){this.initParameters=
a};a.prototype.expandFolder=function(a){var b=this,d=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=d.data(this.settings.DataAttributes.FolderActionExpand),f=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();e?this.setFolderState(f,d,k.Expanded):(this.setFolderState(f,d,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){f.append(a);b.setFolderState(f,d,k.Expanded);
b.onFolderContentLoaded()}))};a.prototype.onFolderContentLoaded=function(){var a=this;this.initParameters.itemStates.forEach(function(b,d){a.checkboxStateMachine.isElementChecked(b)&&(b=a.getCheckbox(d))&&b.toggleWithSuppressEvents(!0)});this.initParameters.disabledItemIds&&this.initParameters.disabledItemIds.forEach(function(b){(b=a.getCheckbox(b))&&b.enable(!1)})};a.prototype.countItemsChanged=function(){return f.MapUtils.reduce(this.initParameters.itemStates,function(a,c,d){return d===f.CheckboxStateMachine.State.AttachedByUser||
d===f.CheckboxStateMachine.State.DetachedByUser?a+1:a},0)};a.prototype.countCheckedItems=function(){var a=this;return f.MapUtils.reduce(this.initParameters.itemStates,function(b,d,e){return a.checkboxStateMachine.isElementChecked(e)?b+1:b},0)};a.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((c={},c[this.settings.EventNames.OptionCheckBoxChanged]=this.stateChangedHandler,c),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.listItemFocusedAreaSelector,
function(b){b=$(b.target);var c=a.closestItem(b);a.isClickTargetEnabled(b,c)&&(a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(c):a.isListItemFocusedArea(b)&&(b=a.getCheckbox(a.getItemId(c)),b.toggle(!b.getState().Checked)))});this.controls.Container.on("keyup",this.listItemFocusedAreaSelector,function(b){b.which===CCL.CommonConstants.keyCodes.space&&(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.closestItem(b)))});var c};a.prototype.isClickTargetEnabled=function(a,
c){return 0>=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length||this.initParameters.allowFolderSelection&&this.isCheckboxExistAndEnabled(c)};a.prototype.targetIsFolderActionExpand=function(a){return a.is(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand))||0<a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length};a.prototype.updateItemState=function(a,c){a=this.getItemId(a);
var b=this.initParameters.itemStates.get(a)||f.CheckboxStateMachine.State.Empty;c=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(c,b);this.initParameters.itemStates.set(a,c);return this.countCheckedItems()};a.prototype.expandOrCollapseFolder=function(a){var b=this,d=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=d.data(this.settings.DataAttributes.FolderActionExpand),f=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();
e?e===k.Expanded?this.setFolderState(f,d,k.Collapsed):e===k.Collapsed&&this.setFolderState(f,d,k.Expanded):(this.setFolderState(f,d,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){f.append(a);b.setFolderState(f,d,k.Expanded);b.onFolderContentLoaded()}))};a.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.getCheckbox(this.getItemId(a)))&&a.getState().Enabled};a.prototype.setFolderState=function(a,c,d){a.toggle(d===k.Expanded);this.closestListItemFocusedArea(c).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
d===k.Expanded);c.data(this.settings.DataAttributes.FolderActionExpand,d);a=c.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,d!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,d===k.Expanded)};a.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};a.prototype.getFolderContent=function(a){return $.ajax({type:"GET",url:this.settings.Urls.FolderContent,
data:a,dataType:"html"})};a.prototype.isListItemFocusedArea=function(a){return a.is(this.listItemFocusedAreaSelector)};a.prototype.closestListItemFocusedArea=function(a){return a.closest(this.listItemFocusedAreaSelector)};a.prototype.closestItem=function(a){return a.closest(this.itemSelector)};a.prototype.getItemId=function(a){return a.data(this.settings.DataAttributes.ItemId)};a.prototype.getCheckbox=function(a){return window[""+this.settings.ClientInstanceNames.ItemPrefix+a]};return a}();e.TreeViewSelector=
d})(f.TreeViewSelector||(f.TreeViewSelector={}))})(ItslearningWeb||(ItslearningWeb={}));(function(f){(function(e){e.getFormDataWithAttachedFilesAndFileSizes=function(e){e=e.files;var d=[];if(0<e.length&&FormData){for(var a=new FormData,b=0;b<e.length;b++)if(CCL.CommonFunctions.isIeBelow11||0<e[b].size)a.append("file"+b,e[b]),d.push(e[b].size);return{formData:a,fileSizes:d}}}})(f.UploadFileHelper||(f.UploadFileHelper={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){this.timeout=500}}();e.IframeLoadingIndicatorSettings=f;f=function(){function d(a){var b=this;this.settings=a;this.showAfterDelay=!0;this.loadingIndicator=$("#"+this.settings.loadingIndicatorClientId);$(window).load(function(){$("#"+b.settings.iframeClientId).ready(function(){b.hideIndicator()})});$(document).on("cssmodal:show",function(){b.hideIndicator()});setTimeout(function(){b.showAfterDelay&&b.loadingIndicator.show()},this.settings.timeout)}
d.prototype.hideIndicator=function(){if(null!=this.settings.onHideCallback)this.settings.onHideCallback();this.showAfterDelay=!1;this.loadingIndicator.hide()};return d}();e.IframeLoadingIndicator=f})(f.ViewLearningToolElement||(f.ViewLearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(){var a=this;this.featureDialogMap={};this.dispatch=function(b){switch(b.type){case CCL.Onboarding.Extensions.MessageType.CompleteFeature:a.completeFeatures(b.features);break;case CCL.Onboarding.Extensions.MessageType.TriggerOnboardingFeature:a.triggerFeature(b.featureId);break;case CCL.Onboarding.Extensions.MessageType.HideOverlay:a.hideOverlay();break;case CCL.Onboarding.Extensions.MessageType.ShowOverlay:a.showOverlay();break;case CCL.Onboarding.Extensions.MessageType.RequestFeatureState:a.requestFeatureState(b.featureId).done(function(c,
d,e){d=a.extensionIframe.get(0).contentWindow;e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionOnboarding);var f={featureId:b.featureId,type:CCL.Onboarding.Extensions.MessageType.ReceiveFeatureState};$.extend(f,c);CCL.CommonFunctions.makePostMessageCallWithData(d,e,f)})}};this.triggerFeature=function(b){b&&a.requestFeatureState(b).done(function(c,d,e){c.IsCompleted?a.triggerFeature(a.featureDialogMap[b].nextFeatureId):(c=window[a.featureDialogMap[b].dialogClientId],
c.blockHighlightZone=!0,c.openDialog(function(c){c?a.completeFeatures([a.featureDialogMap[b].featuresForComplete]):a.triggerFeature(a.featureDialogMap[b].nextFeatureId)}))})};this.completeFeatures=function(b){for(var c=0;c<b.length;c++){var d=b[c];d&&$.ajax({url:a.onboardingServiceUrl.replace("{featureId}",d),type:"PUT"})}}}a.prototype.init=function(a,c,d){this.pageOptions=d;this.onboardingServiceUrl=a;this.extensionIframe=c;this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentLearningToolOptions]=
{dialogClientId:d.optionsOnboradingClientId,nextFeatureId:CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders,featuresForComplete:[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]};this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]={dialogClientId:d.pageFunctionsClientId};CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.extensionOnboarding,this.dispatch)};a.prototype.showOverlay=function(){this.extensionIframe.css("position",
"relative");this.extensionIframe.css("z-index","1000");$("<div></div>").appendTo(document.body).addClass(this.pageOptions.cssClasses.onboardingDialogMask).css({opacity:"0",filter:"alpha(opacity=0)","z-index":997}).fadeTo(0,1)};a.prototype.hideOverlay=function(){this.extensionIframe.css("position","");this.extensionIframe.css("z-index","");$("."+this.pageOptions.cssClasses.onboardingDialogMask).remove()};a.prototype.requestFeatureState=function(a){return $.ajax({url:this.onboardingServiceUrl.replace("{featureId}",
a),type:"GET"})};return a}();e.PostMessageDispatcher=d})(e.ViewLearningToolElement||(e.ViewLearningToolElement={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e;(function(d){d[d.Stopped=0]="Stopped";d[d.RecordingStarted=1]="RecordingStarted";d[d.PreviewSeeked=2]="PreviewSeeked";d[d.PreviewStarted=3]="PreviewStarted";d[d.PreviewPaused=4]="PreviewPaused";d[d.Closing=5]="Closing"})(e||(e={}));var k=function(){function d(a,b){this.wasInterrupted=!1;this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=this.recordingChromeStartTimeMs=this.recordingVideoPreInterval=this.currentRecordDuration=
0;window[a]=this;this.settings=b;this.eventNames=b.EventNames;this.initialize()}d.prototype.initialize=function(){var a=this;this.settings.IsVideo?(this.video=document.getElementById(this.settings.VideoId),this.video.muted=!0,this.video.onended=function(){a.onPlaybackEnded()},window.isChrome&&(this.audio=document.getElementById(this.settings.AudioId),this.audio.muted=!0),this.constraints={audio:!0,video:{mandatory:{maxWidth:this.video.clientWidth,maxHeight:this.video.clientHeight,minWidth:this.video.clientWidth,
minHeight:this.video.clientHeight}}},this.settings.RequestMediaResourcesOnLoad&&this.showVideoFrame()):(this.audio=document.getElementById(this.settings.AudioId),this.audio.muted=!0,this.audio.onended=function(){a.onPlaybackEnded()},this.constraints={audio:!0,video:!1},this.settings.RequestMediaResourcesOnLoad&&!this.audioStream&&navigator.getUserMedia(this.constraints,function(b){window.isChrome&&(b=new window.MediaStream(b.getAudioTracks()));a.audioStream=b},function(){a.showAlert(a.settings.AccessDeniedErrorMessage)}));
this.currentState=e.Stopped};d.prototype.startRecording=function(){var a=this;this.settings.IsVideo?(this.video.onended=function(){a.onPlaybackEnded()},this.startRecordingVideo()):(this.audio.onended=function(){a.onPlaybackEnded()},this.startRecordingAudio());this.currentState=e.RecordingStarted};d.prototype.stopRecording=function(){this.settings.IsVideo?this.stopRecordingVideo():this.stopRecordingAudio()};d.prototype.getCurrentTime=function(){return this.currentState===e.Stopped?0:window.isChrome?
this.getChromeCurrentTime():this.settings.IsVideo?this.video.currentTime-this.recordingVideoPreInterval:this.audio.currentTime};d.prototype.getChromeCurrentTime=function(){return this.settings.IsVideo?this.video.currentTime-this.recordingVideoPreInterval:(this.currentState===e.RecordingStarted?(new Date).getTime()-this.recordingChromeStartTimeMs:this.currentState===e.PreviewPaused?this.previewChromeAudioPauseTimeMs-this.previewChromeAudioStartTimeMs-this.previewChromeAudioPauseIntervalMs:(new Date).getTime()-
this.previewChromeAudioStartTimeMs-this.previewChromeAudioPauseIntervalMs)/1E3};d.prototype.getDuration=function(){return this.currentRecordDuration};d.prototype.preparePreview=function(){this.settings.IsVideo?this.prepareVideoPreview():this.prepareAudioPreview()};d.prototype.prepareVideoPreview=function(){var a=this;window.isChrome&&this.audioUrl&&(this.audio.pause(),this.audio.currentTime=0,this.audio.src=this.audioUrl,this.audio.load());$(this.video).one("loadeddata",function(){a.video.duration&&
Infinity!==a.video.duration&&(a.currentRecordDuration=a.video.duration);a.recordingVideoPreInterval=0;$(document).trigger(a.eventNames.PreviewPreparedEventName)});$(this.video).one("error",function(){0===a.getCurrentTime()&&$(document).trigger(a.eventNames.PreviewPreparedFailedEventName)});this.video.src=this.videoUrl;this.video.load()};d.prototype.prepareAudioPreview=function(){var a=this;$(this.audio).one("loadeddata",function(){a.audio.duration&&Infinity!==a.audio.duration&&(a.currentRecordDuration=
a.audio.duration);$(document).trigger(a.eventNames.PreviewPreparedEventName)});this.audio.src=this.audioUrl;this.audio.load()};d.prototype.previewRecord=function(){this.currentState!==e.PreviewSeeked&&this.reloadPlayer();this.settings.IsVideo?(this.video.muted=!1,window.isChrome&&this.audioUrl&&(this.audio.muted=!1,this.audio.play()),this.video.play()):(this.audio.muted=!1,this.audio.play(),0===this.previewChromeAudioStartTimeMs&&(this.previewChromeAudioStartTimeMs=(new Date).getTime()));this.currentState=
e.PreviewStarted};d.prototype.reloadPlayer=function(){this.settings.IsVideo?this.supportsSeek()?this.seek(0):(this.video.load(),window.isChrome&&this.audioUrl&&this.audio.load()):this.supportsSeek()?this.seek(0):this.audio.load()};d.prototype.pauseResumePreview=function(a){this.settings.IsVideo?this.pauseResumeRecordingVideo(a):this.pauseResumePreviewAudio(a);this.currentState=a?e.PreviewPaused:e.PreviewStarted};d.prototype.pauseResumeRecordingVideo=function(a){a?(this.video.pause(),window.isChrome&&
this.audioUrl&&this.audio.pause()):(this.video.play(),window.isChrome&&this.audio.play())};d.prototype.pauseResumePreviewAudio=function(a){a?(this.audio.pause(),this.previewChromeAudioPauseTimeMs=(new Date).getTime()):(this.audio.play(),this.previewChromeAudioPauseIntervalMs+=(new Date).getTime()-this.previewChromeAudioPauseTimeMs)};d.prototype.deleteRecord=function(){this.settings.IsVideo?(window.isChrome&&this.audioUrl&&(this.audio.pause(),this.audio.src="",this.audio.muted=!0,this.audio.load()),
this.video.onended=null,this.video.pause(),this.video.muted=!0,this.video.src="",this.video.load(),this.showVideoFrame()):(this.audio.onended=null,this.audio.pause(),this.audio.muted=!0,this.audio.src="",this.audio.load());this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=this.recordingChromeStartTimeMs=this.recordingVideoPreInterval=this.currentRecordDuration=0;this.currentState=e.Stopped};d.prototype.closeRecordingSession=function(){var a=
this.currentState;this.currentState=e.Closing;a===e.RecordingStarted&&this.stopRecording();this.video&&this.video.pause();this.audio&&this.audio.pause();window.isChrome?(this.videoStream&&(0<this.videoStream.getVideoTracks().length&&this.videoStream.getVideoTracks()[0].stop(),0<this.videoStream.getAudioTracks().length&&this.videoStream.getAudioTracks()[0].stop()),this.audioStream&&0<this.audioStream.getAudioTracks().length&&this.audioStream.getAudioTracks()[0].stop()):(this.audioStream&&this.audioStream.stop(),
this.videoStream&&this.videoStream.stop());this.wasInterrupted&&(this.audioStream=this.videoStream=null,this.wasInterrupted=!1);this.currentState=e.Stopped};d.prototype.uploadRecord=function(a,b){try{b={Name:b};b.IsVideo=this.settings.IsVideo;var c=new FormData;if(window.isChrome&&this.settings.IsVideo&&this.audioUrl){var d=this.recorderAudio.getBlob(),e=this.recorderVideo.getBlob();c.append("file",d,"audio.wav");c.append("file",e,"video.webm");b.Type="WebRtcChrome";b.MimeType=d.type+","+e.type}else{var f=
this.settings.IsVideo?this.recorderVideo.getBlob():this.recorderAudio.getBlob();c.append("file",f,this.settings.IsVideo?"video.webm":window.isChrome?"audio.wav":"audio.ogg");b.Type="WebRtc";b.MimeType=f.type}a=0<a.indexOf("?")?a+"&"+$.param(b):a+"?"+$.param(b);var k=this;$.ajax(a,{type:"POST",contentType:!1,processData:!1,async:!0,data:c,dataType:"json",timeout:36E5,success:function(a){try{"none"===a.data.ErrorCode.toLowerCase()?$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,[a.data.FileName,
""]):$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",a.data.ErrorCode])}catch(p){$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",""])}},error:function(){$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",""])}})}catch(q){$(document).trigger(this.eventNames.RecordingUploadCompletedEventName,["",""])}};d.prototype.seek=function(a){this.settings.IsVideo?(this.video.currentTime=a,window.isChrome&&this.audioUrl&&(this.audio.currentTime=
a)):(this.audio.currentTime=a,window.isChrome&&(this.previewChromeAudioStartTimeMs=this.currentState===e.PreviewPaused?this.previewChromeAudioPauseTimeMs-1E3*a:(new Date).getTime()-1E3*a,this.previewChromeAudioPauseIntervalMs=0));this.currentState===e.Stopped&&(this.currentState=e.PreviewSeeked)};d.prototype.supportsSeek=function(){var a=this.settings.IsVideo?this.video:this.audio;return a&&0<a.seekable.length};d.prototype.showVideoFrame=function(a){var b=this;void 0===a&&(a=!1);if(this.videoStream){if(this.isVideoAvailable(this.videoStream)&&
(this.video.src=URL.createObjectURL(this.videoStream),this.video.load(),this.video.play(),a))this.onUserMediaVideo(this,this.videoStream)}else{var c=this;navigator.getUserMedia(this.constraints,function(c){if(b.isVideoAvailable(c)&&(b.videoStream=c,b.video.src=URL.createObjectURL(b.videoStream),b.video.load(),b.video.play(),a))b.onUserMediaVideo(b,b.videoStream)},function(){c.showAlert(c.settings.AccessDeniedErrorMessage)})}};d.prototype.isVideoAvailable=function(a){var b=this;return 0===a.getVideoTracks().length?
(this.showConfirmAudioSwitch(this.settings.ChangeToAudioRecorderMessage,function(c){c?(b.video.style.display="none",b.settings.IsVideo=!1,b.audioStream=window.isChrome?new window.MediaStream(a.getAudioTracks()):a,b.initialize(),$(document).trigger(b.eventNames.SwitchToAudioRecorderEventName)):(b.closeRecordingSession(),$(document).trigger(b.eventNames.SwitchToUploadTabEventName))}),!1):!0};d.prototype.showConfirmAudioSwitch=function(a,b){var c=this.settings.UploadFileButtonText.replace(/(["])/g,"&quot;");
window.top.jConfirm?(window.top.$.alerts.cancelButton=c,window.top.jConfirm(a,"",b)):($.alerts.cancelButton=c,jConfirm(a,"",b))};d.prototype.onPlaybackEnded=function(){this.isPreview()?this.currentState!==e.Closing&&(this.currentState=e.Stopped,this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=0,$(document).trigger(this.eventNames.RecordingPlaybackEndedEventName)):(this.wasInterrupted=!0,$(document).trigger(this.eventNames.RecordingInteruptedEventName))};
d.prototype.startRecordingVideo=function(){var a=this;if(this.videoStream)this.onUserMediaVideo(this,this.videoStream);else{var b=this;navigator.getUserMedia(this.constraints,function(a){b.videoStream=a;b.showVideoFrame(!0)},function(){a.showAlert(b.settings.AccessDeniedErrorMessage)})}};d.prototype.onUserMediaVideo=function(a,b){if(b.getAudioTracks()&&0!==b.getAudioTracks().length)this.onUserMediaVideoAndAudio(a,b);else this.onUserMediaVideoNoAudio(a,b)};d.prototype.onUserMediaVideoAndAudio=function(a,
b){a.video.muted=!0;var c={type:"video",video:a.video,width:a.video.clientWidth,height:a.video.clientHeight,canvas:{width:a.video.clientWidth,height:a.video.clientHeight},disableLogs:a.settings.DisableLogs,frameInterval:30,recorderType:null};window.isChrome?(a.recorderAudio=RecordRTC(b,{type:"audio",numberOfAudioChannels:1,disableLogs:a.settings.DisableLogs,onAudioProcessStarted:function(){a.recordingVideoPreInterval=a.video.currentTime;$(document).trigger(a.eventNames.HasUserMediaAccessEventName);
a.video.play();a.recorderVideo.startRecording()}}),a.recorderVideo=RecordRTC(b,c),a.recorderAudio.startRecording()):(a.recorderVideo=RecordRTC(b,c),a.recordingVideoPreInterval=a.video.currentTime,$(document).trigger(a.eventNames.HasUserMediaAccessEventName),a.video.play(),a.recorderVideo.startRecording());a.currentState=e.RecordingStarted};d.prototype.onUserMediaVideoNoAudio=function(a,b){a.video.muted=!0;a.recorderVideo=RecordRTC(b,{type:"video",video:a.video,width:a.video.clientWidth,height:a.video.clientHeight,
canvas:{width:a.video.clientWidth,height:a.video.clientHeight},disableLogs:a.settings.DisableLogs,frameInterval:30,recorderType:null});a.recordingVideoPreInterval=a.video.currentTime;$(document).trigger(a.eventNames.HasUserMediaAccessEventName);a.video.play();a.recorderVideo.startRecording();a.currentState=e.RecordingStarted};d.prototype.startRecordingAudio=function(){var a=this,b=this;if(b.audioStream)b.onUserMediaAudio(b,b.audioStream);else navigator.getUserMedia(b.constraints,function(a){window.isChrome&&
(a=new window.MediaStream(a.getAudioTracks()));b.audioStream=a;b.onUserMediaAudio(b,b.audioStream)},function(){a.showAlert(b.settings.AccessDeniedErrorMessage)});window.isAudio=!0};d.prototype.onUserMediaAudio=function(a,b){$(document).trigger(a.eventNames.HasUserMediaAccessEventName);a.recorderAudio=RecordRTC(b,{type:"audio",numberOfAudioChannels:1,disableLogs:a.settings.DisableLogs});a.audio.src=URL.createObjectURL(a.audioStream);a.audio.muted=!0;a.audio.play();a.recordingChromeStartTimeMs=(new Date).getTime();
a.recorderAudio.startRecording();a.currentState=e.RecordingStarted};d.prototype.stopRecordingAudio=function(){var a=this;a.recorderAudio&&(window.isChrome||a.recorderAudio.resumeRecording(),a.recorderAudio.stopRecording(function(b){a.audio.pause();a.currentRecordDuration=a.getCurrentTime();a.audioUrl=b;a.currentState=e.Stopped;a.triggerStoppedEvent()}))};d.prototype.stopRecordingVideo=function(){this.recorderAudio?this.stopVideoAndAudioRecorders():this.stopVideoNoAudioRecorders()};d.prototype.stopVideoAndAudioRecorders=
function(){var a=this;this.recorderAudio&&this.recorderVideo&&this.recorderVideo.stopRecording(function(b){a.video.pause();a.currentRecordDuration=a.getCurrentTime();a.recorderAudio.stopRecording(function(c){a.videoUrl=b;a.audioUrl=c;a.currentState=e.Stopped;a.triggerStoppedEvent()})})};d.prototype.stopVideoNoAudioRecorders=function(){if(this.recorderVideo){window.isChrome||this.recorderVideo.resumeRecording();var a=this;a.recorderVideo.stopRecording(function(b){a.video.pause();a.currentRecordDuration=
a.getCurrentTime();a.videoUrl=b;a.currentState=e.Stopped;a.triggerStoppedEvent()})}};d.prototype.triggerStoppedEvent=function(){this.currentState!==e.Closing&&$(document).trigger(this.eventNames.RecordingStoppedEventName)};d.prototype.isPreview=function(){return this.currentState===e.PreviewStarted||this.currentState===e.PreviewSeeked||this.currentState===e.PreviewPaused};d.prototype.showAlert=function(a){window.top.jAlert?window.top.jAlert(a,"",null):jAlert(a,"",null)};return d}();f.WebRtcRecorder=
k})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(a,b){var c=this;window[a]=this;this.settings=b;$(function(){CCL.CommonFunctions.attachPostMessageEventListener($(window),c.settings.SendElementIdToCourseFeature,function(a){c.elementList.addElement(a.elementId).done(function(){return c.refreshLeftMenu(a.folderId,a.elementId,a.notFocusingOnElement)})});c.elementList=window[c.settings.ClientInstanceNames.ElementListClient];c.feedback=window[c.settings.ClientInstanceNames.Feedback];c.$titleTextBox=
$("#"+c.settings.Controls.TitleTextBox);c.$saveButton=$("#"+c.settings.Controls.SaveButton);c.$learningObjectiveSelector=$("#"+c.settings.Controls.LearningObjectiveSelector);c.$saveButton.click(function(){var a=""!==c.$titleTextBox.val();a||(c.feedback.showMessage(CCL.FeedbackType.Error,c.settings.Terms.ValidationError),$("html, body").animate({scrollTop:0}));return a});$("."+c.settings.Css.AddLinkCss).click(function(a){return c.onAddLinkClick($(a.currentTarget))})})}d.prototype.addElement=function(a,
b,c,d){this.elementList.addElementItem(a,b,c,d)};d.prototype.removeElement=function(a){this.elementList.deleteElement(a)};d.prototype.refreshLeftMenu=function(a,b,c){var d=top;d&&d.reloadFolder&&(d.reloadFolder(),d.reloadFolder("item"+a,"item"+b),d.notFocusingOnElement=c)};d.prototype.onAddLinkClick=function(a){var b=this,c=parseInt(a.data(this.settings.DataAttributes.ElementType),10);if(parseInt(a.data(this.settings.DataAttributes.ElementExternalSource),10)===f.AddResourceMenu.ElementExternalSourceType.Course){a=
{locationId:this.settings.CourseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};var d=this.elementList.getElementIds(),e=new Map;$.each(d,function(a,b){e.set(b,f.CheckboxStateMachine.State.Saved)});d=c===f.ElementLinkDialog.ContentElementType.Resources?this.settings.Terms.AddResource:this.settings.Terms.AddActivity;c={elementStates:f.MapUtils.makeCopy(e),elementType:c,showAll:!1,header:d,learningObjectiveId:this.$learningObjectiveSelector.val(),allowFolderSelection:!1,openerPage:f.ElementLinkDialog.ElementsPopupOpener.WorkingPortfolioTask,
afterOkClickCallback:function(a){var c=[],d=[];a&&a.forEach(function(a,b){a===f.CheckboxStateMachine.State.AttachedByUser||a===f.CheckboxStateMachine.State.Saved?c.push(b):a===f.CheckboxStateMachine.State.DetachedByUser&&d.push(b)});b.elementList.deleteElements(d);b.elementList.addElements(c)}};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,a)}};return d}();e.AddEditTask=k})(f.WorkingPortfolio||(f.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));
